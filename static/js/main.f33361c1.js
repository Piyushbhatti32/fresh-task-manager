(()=>{var e={19812:(e,t,o)=>{"use strict";e.exports=o.p+"static/media/icon.c7e71da1f3b4de787cf9.png"},35358:(e,t,o)=>{var r={"./af":17582,"./af.js":17582,"./ar":93042,"./ar-dz":54265,"./ar-dz.js":54265,"./ar-kw":92553,"./ar-kw.js":92553,"./ar-ly":85352,"./ar-ly.js":85352,"./ar-ma":67097,"./ar-ma.js":67097,"./ar-ps":76150,"./ar-ps.js":76150,"./ar-sa":84427,"./ar-sa.js":84427,"./ar-tn":7221,"./ar-tn.js":7221,"./ar.js":93042,"./az":60458,"./az.js":60458,"./be":17596,"./be.js":17596,"./bg":93830,"./bg.js":93830,"./bm":27044,"./bm.js":27044,"./bn":58573,"./bn-bd":13296,"./bn-bd.js":13296,"./bn.js":58573,"./bo":25614,"./bo.js":25614,"./br":62041,"./br.js":62041,"./bs":91786,"./bs.js":91786,"./ca":75833,"./ca.js":75833,"./cs":52711,"./cs.js":52711,"./cv":71036,"./cv.js":71036,"./cy":84977,"./cy.js":84977,"./da":8770,"./da.js":8770,"./de":67342,"./de-at":81566,"./de-at.js":81566,"./de-ch":87544,"./de-ch.js":87544,"./de.js":67342,"./dv":82875,"./dv.js":82875,"./el":78536,"./el.js":78536,"./en-au":38617,"./en-au.js":38617,"./en-ca":79227,"./en-ca.js":79227,"./en-gb":59754,"./en-gb.js":59754,"./en-ie":37217,"./en-ie.js":37217,"./en-il":85418,"./en-il.js":85418,"./en-in":80800,"./en-in.js":80800,"./en-nz":67299,"./en-nz.js":67299,"./en-sg":76305,"./en-sg.js":76305,"./eo":8673,"./eo.js":8673,"./es":71301,"./es-do":3187,"./es-do.js":3187,"./es-mx":48223,"./es-mx.js":48223,"./es-us":37634,"./es-us.js":37634,"./es.js":71301,"./et":4976,"./et.js":4976,"./eu":11847,"./eu.js":11847,"./fa":74372,"./fa.js":74372,"./fi":41628,"./fi.js":41628,"./fil":56802,"./fil.js":56802,"./fo":42874,"./fo.js":42874,"./fr":9853,"./fr-ca":87170,"./fr-ca.js":87170,"./fr-ch":22825,"./fr-ch.js":22825,"./fr.js":9853,"./fy":68876,"./fy.js":68876,"./ga":93533,"./ga.js":93533,"./gd":82770,"./gd.js":82770,"./gl":98602,"./gl.js":98602,"./gom-deva":63059,"./gom-deva.js":63059,"./gom-latn":48212,"./gom-latn.js":48212,"./gu":23409,"./gu.js":23409,"./he":17210,"./he.js":17210,"./hi":4750,"./hi.js":4750,"./hr":51315,"./hr.js":51315,"./hu":47626,"./hu.js":47626,"./hy-am":91317,"./hy-am.js":91317,"./id":26892,"./id.js":26892,"./is":97577,"./is.js":97577,"./it":57628,"./it-ch":3046,"./it-ch.js":3046,"./it.js":57628,"./ja":92504,"./ja.js":92504,"./jv":25917,"./jv.js":25917,"./ka":64513,"./ka.js":64513,"./kk":94935,"./kk.js":94935,"./km":96661,"./km.js":96661,"./kn":89964,"./kn.js":89964,"./ko":98067,"./ko.js":98067,"./ku":61165,"./ku-kmr":85158,"./ku-kmr.js":85158,"./ku.js":61165,"./ky":11177,"./ky.js":11177,"./lb":2967,"./lb.js":2967,"./lo":81972,"./lo.js":81972,"./lt":58469,"./lt.js":58469,"./lv":33155,"./lv.js":33155,"./me":87935,"./me.js":87935,"./mi":74483,"./mi.js":74483,"./mk":32501,"./mk.js":32501,"./ml":73120,"./ml.js":73120,"./mn":20266,"./mn.js":20266,"./mr":19406,"./mr.js":19406,"./ms":80109,"./ms-my":90864,"./ms-my.js":90864,"./ms.js":80109,"./mt":22904,"./mt.js":22904,"./my":44067,"./my.js":44067,"./nb":21301,"./nb.js":21301,"./ne":81152,"./ne.js":81152,"./nl":76735,"./nl-be":97761,"./nl-be.js":97761,"./nl.js":76735,"./nn":37569,"./nn.js":37569,"./oc-lnc":20833,"./oc-lnc.js":20833,"./pa-in":3044,"./pa-in.js":3044,"./pl":34249,"./pl.js":34249,"./pt":87585,"./pt-br":26826,"./pt-br.js":26826,"./pt.js":87585,"./ro":62526,"./ro.js":62526,"./ru":62204,"./ru.js":62204,"./sd":43270,"./sd.js":43270,"./se":61541,"./se.js":61541,"./si":71921,"./si.js":71921,"./sk":49935,"./sk.js":49935,"./sl":46254,"./sl.js":46254,"./sq":59897,"./sq.js":59897,"./sr":42496,"./sr-cyrl":11135,"./sr-cyrl.js":11135,"./sr.js":42496,"./ss":32215,"./ss.js":32215,"./sv":84716,"./sv.js":84716,"./sw":50803,"./sw.js":50803,"./ta":31538,"./ta.js":31538,"./te":2302,"./te.js":2302,"./tet":25280,"./tet.js":25280,"./tg":14100,"./tg.js":14100,"./th":95385,"./th.js":95385,"./tk":736,"./tk.js":736,"./tl-ph":79726,"./tl-ph.js":79726,"./tlh":41873,"./tlh.js":41873,"./tr":36463,"./tr.js":36463,"./tzl":27491,"./tzl.js":27491,"./tzm":29500,"./tzm-latn":80196,"./tzm-latn.js":80196,"./tzm.js":29500,"./ug-cn":91287,"./ug-cn.js":91287,"./uk":35341,"./uk.js":35341,"./ur":36246,"./ur.js":36246,"./uz":55550,"./uz-latn":77254,"./uz-latn.js":77254,"./uz.js":55550,"./vi":78796,"./vi.js":78796,"./x-pseudo":22736,"./x-pseudo.js":22736,"./yo":28621,"./yo.js":28621,"./zh-cn":67601,"./zh-cn.js":67601,"./zh-hk":39053,"./zh-hk.js":39053,"./zh-mo":71248,"./zh-mo.js":71248,"./zh-tw":74725,"./zh-tw.js":74725};function a(e){var t=s(e);return o(t)}function s(e){if(!o.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=s,e.exports=a,a.id=35358},42634:()=>{},57752:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Br});var r=o(36665),a=o(94780),s=o(19884),n=o(8218),i=o(23049),l=o(78833),d=o(63406),c=o(54420),u=o(6313),f=o(31385),m=o(7908),g=o(65870),h=o(47640),y=o(23410),p=o(93715),x=o(79975);const b={apiKey:"AIzaSyBC1cpIK_tKqnylNgQSdrv7kxoEfzLGtDs",authDomain:"task-manager-8dad8.firebaseapp.com",projectId:"task-manager-8dad8",storageBucket:"task-manager-8dad8.firebasestorage.app",messagingSenderId:"865106052518",appId:"1:865106052518:web:a2c54ec13870d813617b67",measurementId:"G-5B3K05L5NZ"};let j,k,T,C;try{j=0===(0,m.getApps)().length?(0,m.initializeApp)(b):(0,m.getApp)()}catch(Pr){console.error("Firebase initialization error:",Pr),j=(0,m.getApp)()}try{k=(0,g.getAuth)()?(0,g.getAuth)(j):(0,g.initializeAuth)(j,{persistence:(0,g.getReactNativePersistence)(h.default)})}catch(Pr){console.error("Auth initialization error:",Pr),k=(0,g.getAuth)(j)}try{T=(0,p.getFirestore)()?(0,p.getFirestore)(j):(0,p.initializeFirestore)(j,{localCache:(0,p.memoryLocalCache)(),experimentalForceLongPolling:!0,useFetchStreams:!1})}catch(Pr){console.error("Firestore initialization error:",Pr),T=(0,p.getFirestore)(j)}try{C=x.default.addEventListener((e=>{e.isConnected?(console.log("Network connected"),(0,p.enableNetwork)(T).catch(console.error)):(console.log("Network disconnected"),(0,p.disableNetwork)(T).catch(console.error))}))}catch(Pr){console.error("Network monitoring error:",Pr)}let w=null;(0,y.isSupported)().then((e=>{if(e)try{w=(0,y.getAnalytics)(j)}catch(Pr){console.error("Analytics initialization error:",Pr)}}));var S=o(29698),D=o(22618),I=o(30336),v=o(69427),E=o(73929),B=o(73668),P=o(15648),R=o(51181),A=o(18885),z=o(802),L=o(71225),O=o(33680),N=o(98180),F=o(59793),M=o(42490),W=o(8615),V=o(27339),H=o(47514),U=o(70414),$=o(90673);const G={primary:"#3498db",secondary:"#2ecc71",background:"#f5f5f5",card:"#ffffff",text:"#333333",border:"#e1e1e1",notification:"#ff3b30",success:"#28a745",error:"#dc3545",warning:"#ffc107",info:"#17a2b8",inactive:"#a5a5a5",placeholder:"#a0a0a0",highlight:"#f0f0f0",cardBackground:"#ffffff",shadowColor:"#000000",surface:"#ffffff",surfaceVariant:"#f0f0f0",outline:"#e1e1e1"},X={primary:"#2980b9",secondary:"#27ae60",background:"#121212",card:"#1e1e1e",text:"#f5f5f5",border:"#2c2c2c",notification:"#ff453a",success:"#34c759",error:"#ff3b30",warning:"#ffcc00",info:"#5ac8fa",inactive:"#666666",placeholder:"#666666",highlight:"#2c2c2c",cardBackground:"#2a2a2a",shadowColor:"#000000",surface:"#1e1e1e",surfaceVariant:"#2c2c2c",outline:"#2c2c2c"},q={light:Object.assign({},G,{primary:"#1565c0",secondary:"#0288d1",highlight:"#e3f2fd"}),dark:Object.assign({},X,{primary:"#42a5f5",secondary:"#29b6f6",highlight:"#0d47a1"})},_={light:Object.assign({},G,{primary:"#2e7d32",secondary:"#388e3c",highlight:"#e8f5e9"}),dark:Object.assign({},X,{primary:"#66bb6a",secondary:"#81c784",highlight:"#1b5e20"})},Y={light:Object.assign({},G,{primary:"#7b1fa2",secondary:"#9c27b0",highlight:"#f3e5f5"}),dark:Object.assign({},X,{primary:"#ba68c8",secondary:"#ce93d8",highlight:"#4a148c"})};var K=o(60397);const Q={name:"default",mode:"system",colors:G},J=(0,r.createContext)({theme:Q,isDark:!1,toggleTheme:()=>{},setThemeMode:()=>{},setThemeName:()=>{},customizeTheme:()=>{}}),Z=()=>(0,r.useContext)(J),ee="@task_manager_theme_mode",te="@task_manager_theme_name",oe="@task_manager_custom_theme",re=({children:e})=>{const t=(0,$.default)(),[o,a]=(0,r.useState)("system"),[s,n]=(0,r.useState)("default"),[i,l]=(0,r.useState)({}),d="system"===o?"dark"===t:"dark"===o,c=r.useMemo((()=>{let e=((e,t)=>{switch(e){case"blue":return t?q.dark:q.light;case"green":return t?_.dark:_.light;case"purple":return t?Y.dark:Y.light;default:return t?X:G}})(s,d);return"custom"===s&&(e=Object.assign({},d?X:G,i)),e}),[s,d,i]),u={name:s,mode:o,colors:c};(0,r.useEffect)((()=>{(async()=>{try{const e=await h.default.getItem(ee),t=await h.default.getItem(te),o=await h.default.getItem(oe);e&&a(e),t&&n(t),o&&l(JSON.parse(o))}catch(Pr){console.error("Failed to load theme settings:",Pr)}})()}),[]),(0,r.useEffect)((()=>{const e=U.default.addChangeListener((({colorScheme:e})=>{"system"===o&&a("system")}));return()=>{e.remove()}}),[o]);const f={theme:u,isDark:d,toggleTheme:()=>{const e=d?"light":"dark";a(e),h.default.setItem(ee,e)},setThemeMode:e=>{a(e),h.default.setItem(ee,e)},setThemeName:e=>{n(e),h.default.setItem(te,e)},customizeTheme:e=>{l((t=>{const o=Object.assign({},t,e);return h.default.setItem(oe,JSON.stringify(o)),o})),"custom"!==s&&(n("custom"),h.default.setItem(te,"custom"))}};return(0,K.jsx)(J.Provider,{value:f,children:e})};function ae({mode:e,onToggle:t}){const{theme:o}=Z();return(0,K.jsxs)(E.default,{style:[se.container,{backgroundColor:o.colors.surface,borderColor:o.colors.outline}],children:[(0,K.jsx)(P.default,{style:[se.button,"list"===e&&{backgroundColor:o.colors.primaryContainer}],onPress:()=>t("list"),activeOpacity:.7,children:(0,K.jsx)(E.default,{style:[se.iconContainer,{opacity:"list"===e?1:.5}],children:[0,1,2].map((t=>(0,K.jsx)(E.default,{style:[se.listLine,{backgroundColor:"list"===e?o.colors.primary:o.colors.text}]},t)))})}),(0,K.jsx)(P.default,{style:[se.button,"grid"===e&&{backgroundColor:o.colors.primaryContainer}],onPress:()=>t("grid"),activeOpacity:.7,children:(0,K.jsx)(E.default,{style:[se.iconContainer,se.gridContainer,{opacity:"grid"===e?1:.5}],children:[0,1,2,3].map((t=>(0,K.jsx)(E.default,{style:[se.gridSquare,{backgroundColor:"grid"===e?o.colors.primary:o.colors.text}]},t)))})})]})}const se=B.default.create({container:{flexDirection:"row",borderRadius:12,overflow:"hidden",borderWidth:1},button:{paddingVertical:8,paddingHorizontal:12,alignItems:"center",justifyContent:"center"},iconContainer:{width:20,height:20,justifyContent:"space-between"},listLine:{height:4,width:"100%",borderRadius:2},gridContainer:{flexDirection:"row",flexWrap:"wrap"},gridSquare:{height:8,width:8,margin:1,borderRadius:1}});var ne=o(6283),ie=o(90932),le=o(20530),de=o(8412),ce=o(56134);const ue={1:["CREATE TABLE IF NOT EXISTS tasks (\n      id TEXT PRIMARY KEY,\n      title TEXT NOT NULL,\n      description TEXT,\n      dueDate TEXT,\n      priority TEXT NOT NULL DEFAULT 'medium',\n      completed INTEGER NOT NULL DEFAULT 0,\n      isMeeting INTEGER NOT NULL DEFAULT 0,\n      assignee TEXT,\n      createdAt TEXT NOT NULL,\n      updatedAt TEXT NOT NULL,\n      syncStatus TEXT NOT NULL DEFAULT 'pending',\n      categoryId TEXT,\n      reminder INTEGER\n    )","CREATE TABLE IF NOT EXISTS comments (\n      id TEXT PRIMARY KEY,\n      taskId TEXT,\n      content TEXT,\n      authorId TEXT,\n      createdAt TEXT NOT NULL,\n      updatedAt TEXT NOT NULL,\n      syncStatus TEXT NOT NULL DEFAULT 'pending',\n      FOREIGN KEY (taskId) REFERENCES tasks(id) ON DELETE CASCADE\n    )","CREATE TABLE IF NOT EXISTS attachments (\n      id TEXT PRIMARY KEY,\n      taskId TEXT,\n      fileName TEXT,\n      fileType TEXT,\n      fileSize INTEGER,\n      localPath TEXT,\n      cloudUrl TEXT,\n      createdAt TEXT NOT NULL,\n      syncStatus TEXT NOT NULL DEFAULT 'pending',\n      FOREIGN KEY (taskId) REFERENCES tasks(id) ON DELETE CASCADE\n    )","CREATE TABLE IF NOT EXISTS tags (\n      id TEXT PRIMARY KEY,\n      name TEXT NOT NULL,\n      color TEXT NOT NULL,\n      createdAt TEXT NOT NULL\n    )","CREATE TABLE IF NOT EXISTS task_tags (\n      taskId TEXT NOT NULL,\n      tagId TEXT NOT NULL,\n      PRIMARY KEY (taskId, tagId),\n      FOREIGN KEY (taskId) REFERENCES tasks(id) ON DELETE CASCADE,\n      FOREIGN KEY (tagId) REFERENCES tags(id) ON DELETE CASCADE\n    )","CREATE INDEX IF NOT EXISTS idx_tasks_dueDate ON tasks(dueDate)","CREATE INDEX IF NOT EXISTS idx_tasks_priority ON tasks(priority)","CREATE INDEX IF NOT EXISTS idx_tasks_completed ON tasks(completed)","CREATE INDEX IF NOT EXISTS idx_comments_taskId ON comments(taskId)","CREATE INDEX IF NOT EXISTS idx_attachments_taskId ON attachments(taskId)","CREATE INDEX IF NOT EXISTS idx_task_tags_taskId ON task_tags(taskId)","CREATE INDEX IF NOT EXISTS idx_task_tags_tagId ON task_tags(tagId)"]};const fe=new class{initialized=!1;constructor(){this.db=ce.openDatabaseSync("taskmanager.db")}async createAllTables(){try{console.log("Creating all database tables...");const e=["CREATE TABLE IF NOT EXISTS tasks (\n          id TEXT PRIMARY KEY,\n          title TEXT NOT NULL,\n          description TEXT,\n          dueDate TEXT,\n          priority TEXT NOT NULL DEFAULT 'medium',\n          completed INTEGER NOT NULL DEFAULT 0,\n          categoryId TEXT,\n          reminder INTEGER,\n          createdAt TEXT NOT NULL,\n          updatedAt TEXT NOT NULL,\n          syncStatus TEXT NOT NULL DEFAULT 'pending'\n        )","CREATE TABLE IF NOT EXISTS subtasks (\n          id TEXT PRIMARY KEY,\n          taskId TEXT NOT NULL,\n          title TEXT NOT NULL,\n          completed INTEGER NOT NULL DEFAULT 0,\n          createdAt TEXT NOT NULL,\n          updatedAt TEXT NOT NULL,\n          FOREIGN KEY (taskId) REFERENCES tasks(id) ON DELETE CASCADE\n        )","CREATE TABLE IF NOT EXISTS tags (\n          id TEXT PRIMARY KEY,\n          name TEXT NOT NULL,\n          color TEXT NOT NULL,\n          createdAt TEXT NOT NULL\n        )","CREATE TABLE IF NOT EXISTS task_tags (\n          taskId TEXT NOT NULL,\n          tagId TEXT NOT NULL,\n          PRIMARY KEY (taskId, tagId),\n          FOREIGN KEY (taskId) REFERENCES tasks(id) ON DELETE CASCADE,\n          FOREIGN KEY (tagId) REFERENCES tags(id) ON DELETE CASCADE\n        )","CREATE TABLE IF NOT EXISTS comments (\n          id TEXT PRIMARY KEY,\n          taskId TEXT,\n          text TEXT,\n          createdAt TEXT NOT NULL,\n          updatedAt TEXT NOT NULL,\n          FOREIGN KEY (taskId) REFERENCES tasks(id) ON DELETE CASCADE\n        )","CREATE TABLE IF NOT EXISTS attachments (\n          id TEXT PRIMARY KEY,\n          taskId TEXT,\n          fileName TEXT,\n          fileType TEXT,\n          fileUri TEXT,\n          createdAt TEXT NOT NULL,\n          FOREIGN KEY (taskId) REFERENCES tasks(id) ON DELETE CASCADE\n        )"];for(const o of e)try{await this.executeSql(o)}catch(Pr){throw console.error("Error creating table:",Pr),Pr}const t=["CREATE INDEX IF NOT EXISTS idx_tasks_dueDate ON tasks(dueDate)","CREATE INDEX IF NOT EXISTS idx_tasks_priority ON tasks(priority)","CREATE INDEX IF NOT EXISTS idx_tasks_completed ON tasks(completed)","CREATE INDEX IF NOT EXISTS idx_comments_taskId ON comments(taskId)","CREATE INDEX IF NOT EXISTS idx_attachments_taskId ON attachments(taskId)","CREATE INDEX IF NOT EXISTS idx_subtasks_taskId ON subtasks(taskId)"];for(const o of t)try{await this.executeSql(o)}catch(Pr){console.warn("Error creating index:",Pr)}console.log("All tables and indexes created successfully")}catch(Pr){throw console.error("Failed to create all tables:",Pr),Pr}}async initDatabase(){if(!this.initialized)try{console.log("Initializing database..."),await this.executeSql("PRAGMA foreign_keys = ON;"),await this.createAllTables();const e=await this.executeSql("PRAGMA user_version;"),t=e.rows[0]?.user_version||0;console.log(`Current schema version: ${t}, Target version: 1`),t<1&&(console.log("Running migrations to create tables..."),await this.runMigrations(t),await this.createDefaultTagsIfNeeded()),this.initialized=!0,console.log("Database initialization complete.")}catch(Pr){throw console.error("Database initialization failed:",Pr),Pr}}async executeSql(e,t=[]){try{const o=t.map((e=>null===e||void 0===e?null:"object"===typeof e?JSON.stringify(e):e));if(e.trim().toUpperCase().startsWith("SELECT")){const t=await this.db.getAllAsync(e,o);return{insertId:void 0,rowsAffected:0,rows:{length:t.length,_array:t,item:e=>t[e]}}}{const t=await this.db.runAsync(e,o);return{insertId:t.lastInsertRowId,rowsAffected:t.changes,rows:{length:0,_array:[],item:()=>{}}}}}catch(Pr){throw console.error("SQL Error:",Pr,"Query:",e,"Params:",t),Pr}}close(){0}async createDefaultTagsIfNeeded(){try{if(0===(await this.getTags()).length){const e=[{name:"Work",color:"#3B82F6"},{name:"Personal",color:"#10B981"},{name:"Urgent",color:"#EF4444"},{name:"Meeting",color:"#8B5CF6"},{name:"Ideas",color:"#F59E0B"}];for(const t of e)await this.createTag(t)}}catch(Pr){console.error("Failed to create default tags:",Pr)}}async runMigrations(e){console.log(`Running migrations from version ${e} to 1`);for(let t=e+1;t<=1;t++){const e=ue[t];if(e){console.log(`Applying migrations for version ${t} (${e.length} statements)`);try{for(const t of e)try{await this.executeSql(t)}catch(Pr){if(Pr.message?.includes("duplicate column name")){console.log(`Column already exists, skipping: ${t}`);continue}throw Pr}await this.executeSql(`PRAGMA user_version = ${t}`),console.log(`Successfully migrated to version ${t}`)}catch(Pr){throw console.error(`Migration to version ${t} failed:`,Pr),Pr}}else console.warn(`No migrations found for version ${t}`)}}async _createTaskInternal(e){if(console.log("DatabaseService - _createTaskInternal called with data:",e),!this.db)throw new Error("Database not initialized");const t=Math.random().toString(36).substring(2,11),o=(new Date).toISOString();try{return await this.db.runAsync("INSERT INTO tasks (\n          id, title, description, dueDate, priority, completed, \n          categoryId, reminder, createdAt, updatedAt\n        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",[t,e.title,e.description??null,e.dueDate??null,e.priority,e.completed?1:0,e.categoryId??null,e.reminder??null,o,o]),console.log("DatabaseService - Task created successfully with ID:",t),t}catch(Pr){throw console.error("DatabaseService - Failed to create task:",Pr),Pr}}async updateTask(e,t){if(!this.db)throw new Error("Database not initialized");const o=(new Date).toISOString(),r=[],a=[];Object.entries(t).forEach((([e,t])=>{"id"!==e&&"createdAt"!==e&&"updatedAt"!==e&&"syncStatus"!==e&&(r.push(`${e} = ?`),a.push(t))}));try{await this.db.runAsync(`UPDATE tasks SET ${r.join(", ")}, updatedAt = ?, syncStatus = 'pending' WHERE id = ?`,[...a,o,e])}catch(Pr){throw console.error("Failed to update task:",Pr),Pr}}async deleteTask(e){if(!this.db)throw new Error("Database not initialized");try{await this.db.runAsync("DELETE FROM tasks WHERE id = ?",[e])}catch(Pr){throw console.error("Failed to delete task:",Pr),Pr}}async getTasks(){if(!this.db)throw new Error("Database not initialized");try{return(await this.db.getAllAsync("SELECT * FROM tasks ORDER BY dueDate ASC")).map((e=>({id:e.id,title:e.title,description:e.description,priority:e.priority,dueDate:e.dueDate,completed:Boolean(e.completed),categoryId:e.categoryId,reminder:e.reminder,createdAt:e.createdAt,updatedAt:e.updatedAt})))}catch(Pr){throw console.error("Failed to get tasks:",Pr),Pr}}async addComment(e){if(!this.db)throw new Error("Database not initialized");const t=Math.random().toString(36).substr(2,9),o=(new Date).toISOString();try{return await this.db.runAsync("INSERT INTO comments (id, taskId, text, createdAt, updatedAt)\n         VALUES (?, ?, ?, ?, ?)",[t,e.taskId,e.text,o,o]),t}catch(Pr){throw console.error("Failed to add comment:",Pr),Pr}}async getComments(e){if(!this.db)throw new Error("Database not initialized");try{return await this.db.getAllAsync("SELECT * FROM comments WHERE taskId = ? ORDER BY createdAt ASC",[e])}catch(Pr){throw console.error("Failed to get comments:",Pr),Pr}}async createTag(e){if(!this.db)throw new Error("Database not initialized");const t=Math.random().toString(36).substr(2,9),o=(new Date).toISOString();try{return await this.db.runAsync("INSERT INTO tags (id, name, color, createdAt) VALUES (?, ?, ?, ?)",[t,e.name,e.color,o]),t}catch(Pr){throw console.error("Failed to create tag:",Pr),Pr}}async getTags(){if(!this.db)throw new Error("Database not initialized");try{return await this.db.getAllAsync("SELECT * FROM tags ORDER BY name ASC")}catch(Pr){throw console.error("Failed to get tags:",Pr),Pr}}async addTagToTask(e,t){if(!this.db)throw new Error("Database not initialized");try{await this.db.runAsync("INSERT OR IGNORE INTO task_tags (taskId, tagId) VALUES (?, ?)",[e,t])}catch(Pr){throw console.error("Failed to add tag to task:",Pr),Pr}}async removeTagFromTask(e,t){if(!this.db)throw new Error("Database not initialized");try{await this.db.runAsync("DELETE FROM task_tags WHERE taskId = ? AND tagId = ?",[e,t])}catch(Pr){throw console.error("Failed to remove tag from task:",Pr),Pr}}async addAttachment(e){if(!this.db)throw new Error("Database not initialized");const t=Math.random().toString(36).substr(2,9),o=(new Date).toISOString();try{return await this.db.runAsync("INSERT INTO attachments (\n          id, taskId, fileName, fileType, fileUri, createdAt\n        ) VALUES (?, ?, ?, ?, ?, ?)",[t,e.taskId,e.fileName,e.fileType,e.fileUri,o]),t}catch(Pr){throw console.error("Failed to add attachment:",Pr),Pr}}async getAttachments(e){if(!this.db)throw new Error("Database not initialized");try{return await this.db.getAllAsync("SELECT * FROM attachments WHERE taskId = ? ORDER BY createdAt DESC",[e])}catch(Pr){throw console.error("Failed to get attachments:",Pr),Pr}}async getPendingSyncItems(){if(!this.db)throw new Error("Database not initialized");try{const e=await this.db.getAllAsync("SELECT * FROM tasks WHERE syncStatus = 'pending'"),t=await this.db.getAllAsync("SELECT * FROM comments WHERE syncStatus = 'pending'");return{tasks:e,comments:t,attachments:await this.db.getAllAsync("SELECT * FROM attachments WHERE syncStatus = 'pending'")}}catch(Pr){throw console.error("Failed to get pending sync items:",Pr),Pr}}async markAsSynced(e,t){if(!this.db)throw new Error("Database not initialized");const o=`${e}s`,r=(new Date).toISOString();try{await this.db.runAsync(`UPDATE ${o} SET syncStatus = 'synced', lastSyncedAt = ? WHERE id = ?`,[r,t])}catch(Pr){throw console.error(`Failed to mark ${e} as synced:`,Pr),Pr}}async transaction(e){try{await this.executeSql("BEGIN TRANSACTION;");const t={executeSql:async(e,t)=>await this.executeSql(e,t||[])},o=await e(t);return await this.executeSql("COMMIT;"),o}catch(Pr){throw await this.executeSql("ROLLBACK;"),Pr}}};var me=o(72813);const ge=new class{async createTask(e){const t=(0,me.formatISO)(new Date),o="task-"+Date.now()+"-"+Math.random().toString(36).substr(2,9);try{console.log(`TaskRepository - Starting task creation for "${e.title}"`),console.log("TaskRepository - Using repository implementation");await fe.executeSql("INSERT INTO tasks (\n          id, title, description, dueDate, priority, completed, categoryId, createdAt, updatedAt\n        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)",[o,e.title,e.description||null,e.dueDate||null,e.priority||"medium",e.completed?1:0,e.categoryId||null,t,t]);return console.log(`TaskRepository - Created task with ID: ${o}`),o}catch(Pr){throw console.error("Error creating task:",Pr),Pr}}async getTaskById(e){const t=await fe.executeSql("SELECT * FROM tasks WHERE id = ?",[e]);if(0===t.rows.length)return null;const o=t.rows.item(0);return this.mapTaskFromDatabase(o)}async getTasks(e={}){let t="SELECT * FROM tasks";const o=[],r=[];void 0!==e.completed&&(r.push("completed = ?"),o.push(e.completed?1:0)),e.category&&(r.push("categoryId = ?"),o.push(e.category)),e.priority&&(r.push("priority = ?"),o.push(e.priority)),r.length>0&&(t+=" WHERE "+r.join(" AND ")),t+=" ORDER BY dueDate ASC, priority DESC, createdAt DESC",console.log(`TaskRepository - Executing query: ${t}`),console.log("TaskRepository - With parameters:",o);const a=await fe.executeSql(t,o),s=[];for(let n=0;n<a.rows.length;n++)s.push(this.mapTaskFromDatabase(a.rows.item(n)));return console.log(`TaskRepository - Found ${s.length} tasks`),s}async updateTask(e,t){const o=[],r=[];void 0!==t.title&&(o.push("title = ?"),r.push(t.title)),void 0!==t.description&&(o.push("description = ?"),r.push(t.description)),void 0!==t.dueDate&&(o.push("dueDate = ?"),r.push(t.dueDate)),void 0!==t.priority&&(o.push("priority = ?"),r.push(t.priority)),void 0!==t.completed&&(o.push("completed = ?"),r.push(t.completed?1:0)),void 0!==t.categoryId&&(o.push("categoryId = ?"),r.push(t.categoryId)),o.push("updatedAt = ?"),r.push((0,me.formatISO)(new Date)),r.push(e.toString());const a=`UPDATE tasks SET ${o.join(", ")} WHERE id = ?`;console.log("Executing update query:",a),console.log("With parameters:",r);return(await fe.executeSql(a,r)).rowsAffected>0}async deleteTask(e){return(await fe.executeSql("DELETE FROM tasks WHERE id = ?",[e])).rowsAffected>0}mapTaskFromDatabase(e){return{id:e.id,title:e.title,description:e.description,dueDate:e.dueDate,priority:e.priority,completed:Boolean(e.completed),categoryId:e.categoryId,createdAt:e.createdAt,updatedAt:e.updatedAt}}},he=(0,de.create)(((e,t)=>({tasks:[],isLoading:!1,error:null,templates:[],categories:[],isInitialized:!1,currentPomodoro:{active:!1,isBreak:!1,timeRemaining:0,sessionId:null,currentSessionCount:0},pomodoroSettings:{workDuration:25,shortBreakDuration:5,longBreakDuration:15,sessionsUntilLongBreak:4,autoStartNextSession:!1,autoStartBreaks:!1},fetchTasks:async t=>{try{e({isLoading:!0});const o={completed:"completed"===t?.status||"pending"!==t?.status&&void 0,priority:"all"===t?.priority?void 0:t?.priority,category:"all"===t?.category?void 0:t?.category},r=await ge.getTasks(o);console.log(`TaskStore - Fetched ${r.length} tasks from the database`);const a=r.map((e=>{if(!e.id){const t=`fixed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;return console.log(`Fixing task with null ID: "${e.title}" -> new ID: ${t}`),Object.assign({},e,{id:t})}return e}));e({tasks:a,isLoading:!1})}catch(Pr){console.error("TaskStore - Error fetching tasks:",Pr),e({error:Pr instanceof Error?Pr.message:"Failed to fetch tasks",isLoading:!1})}},getTaskById:e=>t().tasks.find((t=>t.id===e)),addTask:async t=>{try{if(!t.title)throw console.error("Cannot create task without a title"),new Error("Task title is required");e({isLoading:!0});const o=await ge.createTask(t);if(!o)throw console.error("Failed to get valid ID from repository when creating task:",t.title),new Error("Failed to generate task ID");const r=Object.assign({},t,{id:o,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});return console.log(`Created new task with ID: ${r.id}, Title: ${r.title}`),e((e=>({tasks:[...e.tasks,r],isLoading:!1}))),r}catch(Pr){throw e({isLoading:!1}),console.error("Error creating task:",Pr),Pr}},updateTask:async t=>{try{return await ge.updateTask(t.id,t)?(e((e=>({tasks:e.tasks.map((e=>e.id===t.id?t:e))}))),t):void 0}catch(Pr){throw Pr}},deleteTask:async t=>{try{await ge.deleteTask(t)&&e((e=>({tasks:e.tasks.filter((e=>e.id!==t))})))}catch(Pr){throw Pr}},markTaskAsCompleted:async e=>{try{const o=t().getTaskById(e);if(o){return!!await t().updateTask(Object.assign({},o,{completed:!0}))}return!1}catch(Pr){return!1}},markTaskAsInProgress:async e=>{try{const o=t().getTaskById(e);if(o){return!!await t().updateTask(Object.assign({},o,{completed:!1}))}return!1}catch(Pr){return!1}},toggleTaskCompletion:async o=>{try{const r=t().getTaskById(o);if(r){if(await ge.updateTask(o,{completed:!r.completed}))return e((e=>({tasks:e.tasks.map((e=>e.id===o?Object.assign({},e,{completed:!e.completed}):e))}))),!0}return!1}catch(Pr){return console.error("Error toggling task completion:",Pr),!1}},addSubtask:async(e,o)=>{try{const r=t().getTaskById(e);if(r){const e={id:Date.now().toString(),title:o,completed:!1,createdAt:new Date},a=Object.assign({},r,{subtasks:[...r.subtasks||[],e]});return await t().updateTask(a)||null}return null}catch(Pr){return null}},toggleSubtask:async(e,o)=>{try{const r=t().getTaskById(e);if(r&&r.subtasks){const e=r.subtasks.map((e=>e.id===o?Object.assign({},e,{completed:!e.completed}):e)),a=Object.assign({},r,{subtasks:e});return await t().updateTask(a)||null}return null}catch(Pr){return null}},deleteSubtask:async(e,o)=>{try{const r=t().getTaskById(e);if(r&&r.subtasks){const e=r.subtasks.filter((e=>e.id!==o)),a=Object.assign({},r,{subtasks:e});return await t().updateTask(a)||null}return null}catch(Pr){return null}},startPomodoro:t=>{e((e=>({currentPomodoro:Object.assign({},e.currentPomodoro,{active:!0,sessionId:t,timeRemaining:60*e.pomodoroSettings.workDuration})})))},pausePomodoro:()=>{e((e=>({currentPomodoro:Object.assign({},e.currentPomodoro,{active:!1})})))},resumePomodoro:()=>{e((e=>({currentPomodoro:Object.assign({},e.currentPomodoro,{active:!0})})))},stopPomodoro:(t,o)=>{e((e=>({currentPomodoro:Object.assign({},e.currentPomodoro,{active:!1,sessionId:null,timeRemaining:0})})))},completePomodoro:()=>{e((e=>({currentPomodoro:Object.assign({},e.currentPomodoro,{active:!1,sessionId:null,timeRemaining:0,currentSessionCount:e.currentPomodoro.currentSessionCount+1})})))},skipBreak:()=>{e((e=>({currentPomodoro:Object.assign({},e.currentPomodoro,{isBreak:!1,timeRemaining:60*e.pomodoroSettings.workDuration})})))},updatePomodoroSettings:t=>{e({pomodoroSettings:t})},fetchTemplates:async()=>{try{e({isLoading:!0});const t=[{id:"1",name:"Daily Standup",title:"Daily Team Meeting",description:"Template for daily team standup meetings",priority:"medium",subtasks:[{title:"Review yesterday's progress"},{title:"Discuss blockers"},{title:"Plan today's work"}],createdAt:new Date},{id:"2",name:"Bug Fix Process",title:"Fix Software Bug",description:"Standard process for addressing software bugs",priority:"high",subtasks:[{title:"Reproduce the issue"},{title:"Check logs and identify cause"},{title:"Implement fix"},{title:"Write tests"},{title:"Create PR"}],createdAt:new Date(Date.now()-864e5)},{id:"3",name:"Weekly Report",title:"Prepare Weekly Report",description:"Template for preparing weekly status reports",priority:"medium",subtasks:[{title:"Gather metrics and data"},{title:"Create summary"},{title:"Add visualizations"},{title:"Review with team"}],createdAt:new Date(Date.now()-1728e5)}];e({templates:t,isLoading:!1})}catch(Pr){console.error("Error fetching templates:",Pr),e({isLoading:!1,error:Pr instanceof Error?Pr.message:"Failed to fetch templates"})}},addTemplate:async t=>{try{const o=Object.assign({},t,{id:Date.now().toString(),createdAt:new Date});return e((e=>({templates:[...e.templates,o]}))),o}catch(Pr){throw console.error("Error adding template:",Pr),Pr}},updateTemplate:async(t,o)=>{try{e((e=>({templates:e.templates.map((e=>e.id===t?Object.assign({},e,o):e))})))}catch(Pr){throw console.error("Error updating template:",Pr),Pr}},deleteTemplate:async t=>{try{e((e=>({templates:e.templates.filter((e=>e.id!==t))})))}catch(Pr){throw console.error("Error deleting template:",Pr),Pr}},createTaskFromTemplate:async e=>{try{const{addTask:o}=t(),r=(e.subtasks||[]).map((e=>Object.assign({},e,{id:Date.now().toString()+Math.random().toString(36).substr(2,9),completed:!1,createdAt:new Date}))),a={title:e.title,description:e.description||"",priority:e.priority||"medium",dueDate:e.dueTimeOffset?new Date(Date.now()+864e5*e.dueTimeOffset).toISOString():new Date(Date.now()+864e5).toISOString(),completed:!1,subtasks:r,categoryId:e.categoryId};return await o(a)}catch(Pr){throw console.error("Error creating task from template:",Pr),Pr}},initialize:async()=>{if(!t().isInitialized)try{e({isLoading:!0}),await t().fetchTasks(),await t().fetchTemplates(),0===t().tasks.length&&await t().createDefaultTasks(),e({isInitialized:!0,isLoading:!1})}catch(Pr){e({error:Pr instanceof Error?Pr.message:"Failed to initialize store",isLoading:!1})}},getCategories:()=>t().categories,createDefaultTasks:async()=>{try{const e=[{title:"Welcome to Task Manager!",description:"This is your first task. Try completing it!",priority:"medium",completed:!1},{title:"Create a new task",description:"Click the + button to create a new task",priority:"low",completed:!1}];for(const o of e)await t().addTask(o)}catch(Pr){console.error("Error creating default tasks:",Pr)}}})));var ye=o(6667),pe=o(53172),xe=o(33248),be=o(19149);function je({task:e,onPress:t,onStartPomodoro:o,onToggle:r,onDelete:a}){const{theme:s,isDark:n}=Z(),i=e=>{switch(e.toLowerCase()){case"high":return n?"#CF6679":"#D32F2F";case"medium":return n?"#FFDF5D":"#FFC107";default:return n?"#78939D":"#78909C"}};return(0,K.jsx)(P.default,{onPress:t,children:(0,K.jsx)(ye.default,{style:[ke.container,{backgroundColor:s.colors.surface,borderLeftColor:i(e.priority||"")}],children:(0,K.jsxs)(E.default,{style:ke.content,children:[(0,K.jsxs)(E.default,{style:ke.header,children:[(0,K.jsxs)(E.default,{style:ke.titleContainer,children:[(0,K.jsx)(be.default,{name:(e=>{switch(e.toLowerCase()){case"high":return"arrow-upward";case"medium":default:return"remove";case"low":return"arrow-downward"}})(e.priority||""),size:16,color:i(e.priority||""),style:ke.priorityIcon}),(0,K.jsx)(A.default,{style:[ke.title,e.completed&&ke.completedTitle],numberOfLines:1,children:e.title})]}),(0,K.jsxs)(E.default,{style:ke.actions,children:[(0,K.jsx)(z.default,{icon:e.completed?"check-circle":"clock-outline",compact:!0,style:[ke.statusChip,{backgroundColor:e.completed?n?"#4CAF5060":"#4CAF5040":n?"#FFC10760":"#FFC10740",marginRight:8,marginTop:8,height:28,paddingHorizontal:8}],children:e.completed?"Completed":"Pending"}),o&&(0,K.jsx)(O.default,{icon:"timer-outline",size:20,onPress:t=>{t.stopPropagation(),o(e.id)},style:ke.pomodoroButton}),r&&(0,K.jsx)(O.default,{icon:e.completed?"check-circle":"circle-outline",size:20,iconColor:e.completed?s.colors.success:s.colors.text,style:ke.toggleButton,onPress:t=>{t.stopPropagation(),console.log("TaskItem - Checkbox clicked for task:",e.id),r()}}),a&&(0,K.jsx)(O.default,{icon:"delete",size:20,onPress:()=>a(e.id)})]})]}),e.description&&(0,K.jsx)(A.default,{style:ke.description,numberOfLines:2,children:e.description}),e.dueDate&&(0,K.jsxs)(E.default,{style:ke.metadataRow,children:[(0,K.jsx)(be.default,{name:"event",size:14,color:s.colors.text,style:ke.metadataIcon}),(0,K.jsx)(A.default,{style:ke.metadataText,children:(0,xe.format)(new Date(e.dueDate),"PPP")})]}),e.subtasks&&e.subtasks.length>0&&(0,K.jsxs)(E.default,{style:ke.progressContainer,children:[(0,K.jsx)(pe.default,{progress:(()=>{if(!e.subtasks||0===e.subtasks.length)return 0;return e.subtasks.filter((e=>e.completed)).length/e.subtasks.length})(),color:s.colors.primary,style:ke.progressBar}),(0,K.jsxs)(A.default,{style:ke.progressText,children:[e.subtasks.filter((e=>e.completed)).length," / ",e.subtasks.length," subtasks"]})]}),(0,K.jsx)(E.default,{style:ke.footer,children:(0,K.jsx)(E.default,{style:ke.tags,children:e.tags&&e.tags.length>0&&e.tags.map(((e,t)=>{const o=e.color||s.colors.primary;return(0,K.jsx)(z.default,{style:[ke.tag,{backgroundColor:(r=o,a="20",r||(r=s.colors.primary),r+a)}],compact:!0,children:(0,K.jsx)(A.default,{style:{color:o,fontSize:12},children:e.name})},t);var r,a}))})})]})})})}const ke=B.default.create({container:{marginBottom:12,borderRadius:12,overflow:"hidden",elevation:2,borderLeftWidth:4,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4},content:{padding:12,paddingBottom:16},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},actions:{flexDirection:"row",alignItems:"center"},titleContainer:{flex:1,flexDirection:"row",alignItems:"center",marginRight:8},priorityIcon:{marginRight:8},title:{fontSize:16,fontWeight:"600",flex:1},completedTitle:{textDecorationLine:"line-through",opacity:.7},description:{fontSize:14,opacity:.8,marginBottom:12},metadataRow:{flexDirection:"row",alignItems:"center",marginBottom:12},metadataItem:{flexDirection:"row",alignItems:"center",marginRight:16},metadataIcon:{marginRight:4},metadataText:{fontSize:13,opacity:.7},progressContainer:{marginBottom:12},progressBar:{height:4,borderRadius:2,marginBottom:4},progressText:{fontSize:12,opacity:.7},footer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},tags:{flexDirection:"row",flexWrap:"wrap",flex:1},tag:{marginRight:4,marginBottom:4,height:24},statusChip:{borderRadius:14,alignItems:"center",justifyContent:"center"},pomodoroButton:{margin:0},toggleButton:{margin:0,marginLeft:4}});var Te=o(15009);function Ce({message:e,icon:t="clipboard-outline",description:o}){const{theme:a,isDark:s}=Z(),n=new Te.default.Value(0),i=new Te.default.Value(.8);return(0,r.useEffect)((()=>{Te.default.parallel([Te.default.timing(n,{toValue:1,duration:500,useNativeDriver:!0}),Te.default.spring(i,{toValue:1,friction:8,tension:40,useNativeDriver:!0})]).start()}),[]),(0,K.jsxs)(Te.default.View,{style:[we.container,{opacity:n,transform:[{scale:i}]}],children:[(0,K.jsx)(f.default,{name:t,size:64,color:a.colors.primary}),(0,K.jsx)(ne.default,{style:[we.message,{color:a.colors.onBackground}],children:e}),o&&(0,K.jsx)(ne.default,{style:[we.description,{color:a.colors.onSurfaceVariant}],children:o})]})}const we=B.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",padding:32},message:{fontSize:18,fontWeight:"bold",marginTop:16,textAlign:"center"},description:{fontSize:14,textAlign:"center",marginTop:8,maxWidth:"80%"}});function Se({onTaskPress:e,onStartPomodoro:t,onToggle:o,onDelete:a,filter:s,sortBy:n="dueDate",sortOrder:i="asc",tasks:l}){const{theme:d,isDark:c}=Z(),{tasks:u,isLoading:f,error:m,fetchTasks:g,markTaskAsCompleted:h}=he(),[y,p]=(0,r.useState)([]),[x,b]=(0,r.useState)(!0),[j,k]=(0,r.useState)(null);(0,r.useEffect)((()=>{l?(console.log(`TaskList received ${l.length} tasks from props`),l.forEach(((e,t)=>{console.log(`Task ${t+1}: ID=${e.id}, Title=${e.title}, Completed=${e.completed}`)}))):console.log("TaskList: No tasks provided through props, will load from database")}),[l]),(0,r.useEffect)((()=>{T()}),[s,n,i]);const T=async()=>{try{b(!0);let e="\n        SELECT t.*, GROUP_CONCAT(tag.name) as tagNames, GROUP_CONCAT(tag.color) as tagColors\n        FROM tasks t\n        LEFT JOIN task_tags tt ON t.id = tt.taskId\n        LEFT JOIN tags tag ON tt.tagId = tag.id\n      ";const t=[],o=[];if(s?.status&&(t.push("t.completed = ?"),o.push("completed"===s.status?1:0)),s?.priority&&(t.push("t.priority = ?"),o.push(s.priority)),s?.tag&&(t.push("tag.name = ?"),o.push(s.tag)),t.length>0&&(e+=" WHERE "+t.join(" AND ")),e+=" GROUP BY t.id",n){e+=` ORDER BY ${"createdAt"===n?"t.createdAt":"priority"===n?"t.priority":"t.dueDate"} ${"desc"===i?"DESC":"ASC"}`}const r=(await fe.executeSql(e,o)).rows._array.map((e=>Object.assign({},e,{tags:e.tagNames?e.tagNames.split(",").map(((t,o)=>({name:t,color:e.tagColors.split(",")[o]}))):[]})));p(r),k(null)}catch(e){console.error("Error loading tasks:",e),k("Failed to load tasks")}finally{b(!1)}};return x?(0,K.jsx)(E.default,{style:De.centered,children:(0,K.jsx)(le.default,{size:"large",color:d.colors.primary})}):j?(0,K.jsx)(E.default,{style:De.centered,children:(0,K.jsx)(ne.default,{style:[De.error,{color:d.colors.error}],children:j})}):0===y.length?(0,K.jsx)(Ce,{message:"No tasks found",icon:"clipboard-outline"}):(0,K.jsx)(ie.default,{data:l||y,keyExtractor:e=>e?.id||`task-${Math.random().toString(36)}`,renderItem:({item:r})=>(0,K.jsx)(je,{task:r,onPress:()=>e(r.id),onStartPomodoro:t?e=>t(e):void 0,onToggle:o?()=>{console.log("Toggling task completion from TaskList:",r.id),o(r.id)}:void 0,onDelete:a?e=>a(e):void 0}),initialNumToRender:20,maxToRenderPerBatch:20,windowSize:21,onEndReachedThreshold:.5,onEndReached:()=>console.log("Reached end of list"),style:De.list,contentContainerStyle:De.content})}const De=B.default.create({list:{flex:1},content:{paddingHorizontal:16,paddingVertical:8},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:16},error:{color:"red",textAlign:"center"}});var Ie=o(40558),ve=o(78264),Ee=o(7869),Be=o(26318);function Pe({tasks:e,onTaskPress:t,onEditTask:o,onToggleCompletion:a,onToggleSubtaskCompletion:s,EmptyComponent:n,isMultiSelectMode:i=!1,selectedTasks:l=[],onTaskSelect:d,onLongPress:c,onStartPomodoro:u,onDelete:m}){const{theme:g,isDark:h}=Z(),y=(0,Ie.default)(),[p,x]=(0,r.useState)(null),[b,j]=(0,r.useState)(!1),[k,T]=(0,r.useState)(null),C=(y.width-4-4-8)/2,w=e=>{switch(e){case"high":return g.colors.error;case"medium":return g.colors.warning;case"low":return g.colors.success;default:return g.colors.outline}},S=(e,t)=>{s&&s(e,t)},D=e=>{switch(e?.toLowerCase()){case"high":return"arrow-upward";case"medium":default:return"remove";case"low":return"arrow-downward"}};return(0,K.jsxs)(E.default,{style:Re.container,children:[(0,K.jsx)(ie.default,{data:e,renderItem:({item:e,index:o})=>{const r=l.includes(e.id),s=(e.subtasks&&e.subtasks.length,(e=>{if(!e.subtasks||0===e.subtasks.length)return null;const t=e.subtasks.filter((e=>e.completed)).length,o=e.subtasks.length;return{completed:t,total:o,percentage:t/o*100}})(e));return(0,K.jsx)(P.default,{onPress:()=>t(e.id),onLongPress:()=>c&&c(e.id),style:[Re.itemContainer,{width:C}],children:(0,K.jsx)(Be.default,{style:[Re.card,r&&Re.selectedCard,{backgroundColor:h?g.colors.surface:g.colors.background}],children:(0,K.jsxs)(Be.default.Content,{style:Re.cardContent,children:[(0,K.jsxs)(E.default,{style:Re.header,children:[(0,K.jsx)(E.default,{style:Re.statusContainer,children:(0,K.jsx)(z.default,{icon:e.completed?"check-circle":"clock-outline",compact:!0,style:[Re.statusChip,{backgroundColor:e.completed?h?"#4CAF5060":"#4CAF5040":h?"#FFC10760":"#FFC10740",height:28,paddingHorizontal:8}],children:e.completed?"Completed":"Pending"})}),(0,K.jsxs)(N.default,{visible:k===e.id,onDismiss:()=>T(null),anchor:(0,K.jsx)(O.default,{icon:"dots-vertical",size:20,onPress:()=>T(e.id),style:Re.menuButton}),contentStyle:{backgroundColor:g.colors.surface},children:[u&&(0,K.jsx)(N.default.Item,{onPress:()=>{T(null),u(e.id)},title:"Start Pomodoro",leadingIcon:"timer-outline"}),a&&(0,K.jsx)(N.default.Item,{onPress:()=>{T(null),a(e.id)},title:e.completed?"Mark Incomplete":"Mark Complete",leadingIcon:e.completed?"check-circle":"circle-outline"}),m&&(0,K.jsx)(N.default.Item,{onPress:()=>{T(null),m(e.id)},title:"Delete",leadingIcon:"delete"})]})]}),(0,K.jsxs)(E.default,{style:Re.titleContainer,children:[(0,K.jsx)(be.default,{name:D(e.priority),size:16,color:w(e.priority),style:Re.priorityIcon}),(0,K.jsx)(ne.default,{style:[Re.title,{color:g.colors.text},e.completed&&Re.completedText],numberOfLines:1,ellipsizeMode:"tail",children:e.title})]}),e.description&&(0,K.jsx)(ne.default,{style:[Re.description,{color:g.colors.inactive},e.completed&&Re.completedText],numberOfLines:2,children:e.description}),s&&(0,K.jsxs)(E.default,{style:Re.progressContainer,children:[(0,K.jsx)(E.default,{style:Re.progressWrapper,children:(0,K.jsx)(E.default,{style:[Re.progressBar,{width:`${s.percentage}%`,backgroundColor:g.colors.primary}]})}),(0,K.jsxs)(ne.default,{style:[Re.progressText,{color:g.colors.secondary}],children:[s.completed,"/",s.total]})]}),(0,K.jsx)(E.default,{style:Re.cardFooter,children:e.dueDate&&(0,K.jsxs)(E.default,{style:Re.metaItem,children:[(0,K.jsx)(Ee.default,{name:"clock-outline",size:14,color:g.colors.primary}),(0,K.jsx)(ne.default,{style:[Re.metaText,{color:g.colors.primary}],children:(n=e.dueDate,n?(0,xe.format)(new Date(n),"MMM d"):"")})]})})]})})});var n},keyExtractor:e=>e.id,numColumns:2,contentContainerStyle:[Re.listContainer,{paddingHorizontal:4,paddingVertical:8}],columnWrapperStyle:{justifyContent:"flex-start"},ListEmptyComponent:n||(0,K.jsxs)(E.default,{style:Re.emptyContainer,children:[(0,K.jsx)(Ee.default,{name:"clipboard-text-outline",size:48,color:g.colors.secondary}),(0,K.jsx)(ne.default,{style:[Re.emptyText,{color:g.colors.text}],children:"No tasks to display"})]})}),p?(0,K.jsx)(ve.default,{visible:b,transparent:!0,animationType:"slide",onRequestClose:()=>j(!1),children:(0,K.jsx)(E.default,{style:[Re.modalContainer,{backgroundColor:"rgba(0,0,0,0.5)"}],children:(0,K.jsxs)(ye.default,{style:[Re.modalContent,{backgroundColor:g.colors.surface}],elevation:4,children:[(0,K.jsxs)(E.default,{style:Re.modalHeader,children:[(0,K.jsx)(ne.default,{style:[Re.modalTitle,{color:g.colors.text}],children:p.title}),(0,K.jsx)(O.default,{icon:"close",size:20,onPress:()=>j(!1)})]}),(0,K.jsx)(E.default,{style:Re.modalBody,children:p.subtasks?.length?p.subtasks.map((e=>((e,t)=>(0,K.jsx)(P.default,{style:[Re.subtaskItem,{backgroundColor:h?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.04)",borderRadius:8}],onPress:()=>S(t,e.id),children:(0,K.jsxs)(E.default,{style:Re.subtaskContent,children:[(0,K.jsx)(P.default,{style:[Re.subtaskCheckbox,{borderColor:g.colors.primary},e.completed&&{backgroundColor:g.colors.success}],onPress:()=>S(t,e.id),children:e.completed&&(0,K.jsx)(f.default,{name:"checkmark",size:14,color:"#fff"})}),(0,K.jsx)(ne.default,{style:[Re.subtaskTitle,{color:g.colors.text},e.completed&&Re.completedSubtask],numberOfLines:1,children:e.title})]})},e.id))(e,p.id))):(0,K.jsx)(ne.default,{style:[Re.emptyText,{color:g.colors.secondary}],children:"No subtasks available"})}),(0,K.jsx)(E.default,{style:Re.modalFooter,children:(0,K.jsx)(P.default,{style:[Re.modalButton,{backgroundColor:g.colors.primary}],onPress:()=>j(!1),children:(0,K.jsx)(ne.default,{style:Re.modalButtonText,children:"Close"})})})]})})}):null]})}const Re=B.default.create({container:{flex:1},listContainer:{flexGrow:1},itemContainer:{padding:4},card:{margin:0,elevation:2},cardContent:{padding:8},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},statusContainer:{flex:1,flexDirection:"row",alignItems:"center"},statusChip:{alignSelf:"flex-start"},menuButton:{margin:0,padding:0,height:28,width:28,justifyContent:"center",alignItems:"center"},titleContainer:{flexDirection:"row",alignItems:"center",marginBottom:8},title:{fontSize:16,fontWeight:"600",flex:1,flexShrink:1},priorityIcon:{marginRight:4},description:{fontSize:14,marginBottom:8},progressContainer:{marginBottom:8},progressWrapper:{height:4,backgroundColor:"rgba(0,0,0,0.1)",borderRadius:2,marginBottom:4},progressBar:{height:"100%",borderRadius:2},progressText:{fontSize:12},cardFooter:{flexDirection:"row",alignItems:"center",marginTop:"auto"},metaItem:{flexDirection:"row",alignItems:"center"},metaText:{fontSize:12,marginLeft:4},completedText:{textDecorationLine:"line-through",opacity:.7},selectedCard:{borderWidth:2,borderColor:"#007AFF"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},modalContent:{width:"90%",borderRadius:12,overflow:"hidden",maxHeight:"80%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingTop:16,paddingBottom:8},modalTitle:{fontSize:18,fontWeight:"600",flex:1},closeButton:{padding:4},modalBody:{padding:16,maxHeight:400},modalFooter:{padding:16,alignItems:"flex-end"},modalButton:{paddingVertical:8,paddingHorizontal:16,borderRadius:8},modalButtonText:{color:"#fff",fontWeight:"500"},subtaskItem:{marginBottom:8,padding:10},subtaskContent:{flexDirection:"row",alignItems:"center"},subtaskCheckbox:{width:20,height:20,borderWidth:2,borderRadius:4,marginRight:10,justifyContent:"center",alignItems:"center"},subtaskTitle:{fontSize:14,flex:1},completedSubtask:{textDecorationLine:"line-through",opacity:.7},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyText:{fontSize:16,marginTop:12}});var Ae=o(2772),ze=o(61009),Le=o(58132),Oe=o(52414),Ne=o(10748),Fe=o(4266),Me=o(38175);const We=({task:e,onPress:t,onStartPomodoro:o})=>{const{theme:r}=Z(),a={high:r.colors.error,medium:r.colors.warning,low:r.colors.success},s=e.dueDate?(0,xe.format)(new Date(e.dueDate),"MMM d, yyyy"):"No due date";return(0,K.jsx)(Be.default,{style:[Ve.card,{borderLeftColor:e.priority?a[e.priority]:r.colors.outline,backgroundColor:r.colors.surface}],onPress:t,children:(0,K.jsxs)(Be.default.Content,{style:Ve.content,children:[(0,K.jsxs)(E.default,{style:Ve.taskInfo,children:[(0,K.jsx)(A.default,{style:[Ve.title,e.completed&&Ve.completedText,{color:r.colors.text}],numberOfLines:1,children:e.title}),e.description?(0,K.jsx)(A.default,{style:[Ve.description,e.completed&&Ve.completedText,{color:r.colors.secondary}],numberOfLines:1,children:e.description}):null,(0,K.jsxs)(E.default,{style:Ve.metaContainer,children:[(0,K.jsx)(A.default,{style:[Ve.date,{color:r.colors.secondary}],children:s}),e.priority&&(0,K.jsx)(Me.default,{style:[Ve.priority,{backgroundColor:a[e.priority]}],children:e.priority})]})]}),o&&(0,K.jsx)(O.default,{icon:"timer",size:20,onPress:e=>{e.stopPropagation(),o&&o()},style:Ve.actionButton})]})})},Ve=B.default.create({card:{marginBottom:8,borderLeftWidth:4},content:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:8},taskInfo:{flex:1},title:{fontSize:16,fontWeight:"500",marginBottom:4},description:{fontSize:14,marginBottom:4},completedText:{textDecorationLine:"line-through",opacity:.7},metaContainer:{flexDirection:"row",alignItems:"center"},date:{fontSize:12,marginRight:8},priority:{fontSize:10,height:20},actionButton:{margin:0}});function He({onTaskPress:e,onToggleCompletion:t,days:o=14,tasks:a,onStartPomodoro:s}){const{theme:n,isDark:i}=Z(),[l,d]=(0,r.useState)({}),[c,u]=(0,r.useState)([]),[f,m]=(0,r.useState)([]),g=(0,r.useState)(new Te.default.Value(0))[0],h=(0,r.useMemo)((()=>{const e={};return a.forEach((t=>{if(t.dueDate)try{const o=new Date(t.dueDate);if(isNaN(o.getTime()))return;const r=(0,xe.format)(o,"yyyy-MM-dd");e[r]||(e[r]=[]),e[r].push(t)}catch(Pr){return void console.error("Error processing task date:",Pr)}})),Object.keys(e).sort(((e,t)=>{try{const o=new Date(e),r=new Date(t);return isNaN(o.getTime())||isNaN(r.getTime())?0:o.getTime()-r.getTime()}catch(Pr){return console.error("Error sorting dates:",Pr),0}})).reduce(((t,o)=>{const r=[...e[o]].sort(((e,t)=>{if(e.completed&&!t.completed)return 1;if(!e.completed&&t.completed)return-1;const o={high:0,medium:1,low:2},r=o[e.priority||"low"]-o[t.priority||"low"];return 0!==r?r:e.title.localeCompare(t.title)}));return t[o]=r,t}),{})}),[a]);(0,r.useEffect)((()=>{const e=[],t=new Date,r=Math.floor(o/3),a=o-r-1;for(let o=-r;o<0;o++)e.push((0,ze.addDays)(t,o));e.push(t);for(let o=1;o<=a;o++)e.push((0,ze.addDays)(t,o));u(e);const s=(0,xe.format)(t,"yyyy-MM-dd");m([s]),d(h),Te.default.timing(g,{toValue:1,duration:500,useNativeDriver:!0}).start()}),[o,h]);const y=e=>(0,Le.isToday)(e)?"Today":(0,Oe.isTomorrow)(e)?"Tomorrow":(0,Ne.isYesterday)(e)?"Yesterday":(0,xe.format)(e,"EEE, MMM d"),p=t=>{const o=(0,xe.format)(t,"yyyy-MM-dd"),r=l[o]||[],a=f.includes(o),d=(e=>{const t=new Date;return(0,Le.isToday)(e)?n.colors.primary:(0,Fe.isBefore)(e,t)?n.colors.error:n.colors.success})(t);return 0!==r.length||(0,Le.isToday)(t)?(0,K.jsxs)(E.default,{style:[Ue.dayContainer,{borderBottomColor:n.colors.border}],children:[(0,K.jsx)(P.default,{style:[Ue.dateHeader,{borderLeftColor:d,backgroundColor:i?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.02)"}],onPress:()=>(e=>{m((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(o),children:(0,K.jsxs)(E.default,{style:Ue.dateHeaderContent,children:[(0,K.jsx)(ne.default,{style:[Ue.dateText,{color:n.colors.text}],children:y(t)}),(0,K.jsxs)(E.default,{style:Ue.dateHeaderRight,children:[(0,K.jsxs)(ne.default,{style:[Ue.taskCount,{color:n.colors.text,opacity:.7}],children:[r.length," ",1===r.length?"task":"tasks"]}),(0,K.jsx)(be.default,{name:a?"expand-less":"expand-more",size:24,color:n.colors.text})]})]})}),a&&(0,K.jsx)(Te.default.View,{style:[Ue.tasksContainer,{opacity:g}],children:r.length>0?r.map((t=>(t=>(n.colors.error,n.colors.warning,n.colors.success,(0,K.jsx)(We,{task:t,onPress:()=>e&&e(t.id),onStartPomodoro:()=>s(t.id)},t.id)))(t))):(0,K.jsx)(E.default,{style:[Ue.emptyDayContainer,{backgroundColor:n.colors.card}],children:(0,K.jsx)(ne.default,{style:[Ue.emptyDayText,{color:n.colors.text}],children:"No tasks scheduled"})})})]},o):null};return(0,K.jsx)(Te.default.View,{style:[Ue.container,{opacity:g}],children:(0,K.jsx)(Ae.default,{style:Ue.scrollView,contentContainerStyle:Ue.scrollContent,showsVerticalScrollIndicator:!1,children:c.map((e=>p(e)))})})}const Ue=B.default.create({container:{flex:1},scrollView:{flex:1},scrollContent:{paddingBottom:20},dayContainer:{marginBottom:8,borderBottomWidth:1},dateHeader:{padding:12,borderLeftWidth:4,borderRadius:4},dateHeaderContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dateHeaderRight:{flexDirection:"row",alignItems:"center"},dateText:{fontSize:16,fontWeight:"bold"},taskCount:{fontSize:14,marginRight:8},tasksContainer:{paddingHorizontal:12,paddingVertical:8},taskItem:{flexDirection:"row",borderRadius:8,marginBottom:8,padding:12,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1},taskStatusContainer:{marginRight:12,justifyContent:"center"},checkbox:{width:22,height:22,borderRadius:4,borderWidth:2,justifyContent:"center",alignItems:"center"},taskContent:{flex:1},taskTitle:{fontSize:16,fontWeight:"bold",marginBottom:4},taskDescription:{fontSize:14,marginBottom:4},priorityIndicator:{width:24,height:24,borderRadius:12,justifyContent:"center",alignItems:"center",alignSelf:"center",marginLeft:8},priorityText:{color:"white",fontSize:12,fontWeight:"bold"},subtasksIndicator:{marginTop:4},subtasksText:{fontSize:12},progressBarContainer:{marginTop:4},progressBar:{height:4,borderRadius:2,overflow:"hidden"},progressFill:{height:4,borderRadius:2},emptyDayContainer:{padding:16,borderRadius:8,alignItems:"center"},emptyDayText:{fontSize:14,fontStyle:"italic"}});var $e=o(34081);const Ge=B.default.create({container:{padding:20,borderRadius:16,marginBottom:16},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:16},title:{fontSize:24,fontWeight:"bold"},closeButton:{padding:8},taskButton:{padding:16,borderRadius:8,marginBottom:16},taskButtonLabel:{fontSize:12,marginBottom:4},taskButtonText:{fontSize:16,fontWeight:"bold"},timerDisplay:{alignItems:"center",justifyContent:"center",padding:24,borderRadius:12,marginBottom:24,borderWidth:2},timerType:{fontSize:18,fontWeight:"500",marginBottom:8},timer:{fontSize:64,fontWeight:"bold",fontVariant:["tabular-nums"]},sessionCount:{fontSize:14,marginTop:8},controls:{flexDirection:"row",justifyContent:"space-around",marginBottom:24},controlButton:{paddingVertical:12,paddingHorizontal:24,borderRadius:8,minWidth:120,alignItems:"center"},primaryButton:{paddingVertical:16,minWidth:180},controlButtonText:{color:"white",fontSize:16,fontWeight:"bold"},statsSection:{borderTopWidth:1,borderTopColor:"#eee",paddingTop:16},statsTitle:{fontSize:18,fontWeight:"bold",marginBottom:12,textAlign:"center"},statsGrid:{flexDirection:"row",justifyContent:"space-around"},statItem:{alignItems:"center"},statValue:{fontSize:24,fontWeight:"bold",marginBottom:4},statLabel:{fontSize:14}}),Xe=({initialTaskId:e,onMinimize:t})=>{const{theme:o,isDark:a}=Z(),{tasks:s,currentPomodoro:n,pomodoroSettings:i,startPomodoro:l,pausePomodoro:d,resumePomodoro:c,stopPomodoro:u,completePomodoro:f,skipBreak:m}=he(),[g,h]=(0,r.useState)(e||null),y=(0,r.useRef)(null),p=g?s.find((e=>e.id===g)):null,x=function(e){const t=Math.floor(e/60),o=e%60;return`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}(n.timeRemaining),b=n.active,j=n.isBreak,k=j?n.timeRemaining>60*i.shortBreakDuration?"Long Break":"Short Break":"Work Session";(0,r.useEffect)((()=>(b?y.current=setInterval((()=>{n.timeRemaining<=1?j?C():T():he.setState((e=>({currentPomodoro:Object.assign({},e.currentPomodoro||{},{timeRemaining:e.currentPomodoro?.timeRemaining-1})})))}),1e3):y.current&&(clearInterval(y.current),y.current=null),()=>{y.current&&clearInterval(y.current)})),[b,n.timeRemaining,j]),(0,r.useEffect)((()=>{e&&h(e)}),[e]);const T=()=>{f()},C=()=>{m(),i.autoStartNextSession&&g&&l(g)};return(0,K.jsxs)(E.default,{style:[Ge.container,{backgroundColor:a?"#222":"#f5f5f5"}],children:[(0,K.jsxs)(E.default,{style:Ge.header,children:[(0,K.jsx)(ne.default,{style:[Ge.title,{color:o.colors.text}],children:"Pomodoro Timer"}),t&&(0,K.jsx)(P.default,{style:Ge.closeButton,onPress:t,activeOpacity:.7,children:(0,K.jsx)($e.default,{name:"close",size:24,color:o.colors.text})})]}),(0,K.jsxs)(P.default,{style:[Ge.taskButton,{backgroundColor:a?"#333":"#fff"}],onPress:()=>{if(0===s.length)return;if(!g)return void h(s[0].id);const e=(s.findIndex((e=>e.id===g))+1)%s.length;h(s[e].id)},children:[(0,K.jsx)(ne.default,{style:[Ge.taskButtonLabel,{color:o.colors.secondary}],children:"Current Task:"}),(0,K.jsx)(ne.default,{style:[Ge.taskButtonText,{color:o.colors.text}],children:p?p.title:"Select a task"})]}),(0,K.jsxs)(E.default,{style:[Ge.timerDisplay,{backgroundColor:a?"#333":"#fff",borderColor:j?o.colors.success:o.colors.primary}],children:[(0,K.jsx)(ne.default,{style:[Ge.timerType,{color:o.colors.text}],children:k}),(0,K.jsx)(ne.default,{style:[Ge.timer,{color:j?o.colors.success:o.colors.primary}],children:x}),(0,K.jsxs)(ne.default,{style:[Ge.sessionCount,{color:o.colors.secondary}],children:["Session ",n?.currentSessionCount," of ",i?.sessionsUntilLongBreak]})]}),(0,K.jsx)(E.default,{style:Ge.controls,children:b?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(P.default,{style:[Ge.controlButton,{backgroundColor:o.colors.warning}],onPress:()=>{d()},children:(0,K.jsx)(ne.default,{style:[Ge.controlButtonText,{color:"#fff"}],children:"Pause"})}),j?(0,K.jsx)(P.default,{style:[Ge.controlButton,{backgroundColor:o.colors.secondary}],onPress:()=>{m()},children:(0,K.jsx)(ne.default,{style:[Ge.controlButtonText,{color:"#fff"}],children:"Skip Break"})}):(0,K.jsx)(P.default,{style:[Ge.controlButton,{backgroundColor:o.colors.error}],onPress:()=>{u(!0,"Manually stopped")},children:(0,K.jsx)(ne.default,{style:[Ge.controlButtonText,{color:"#fff"}],children:"Stop"})})]}):(0,K.jsx)(P.default,{style:[Ge.controlButton,Ge.primaryButton,{backgroundColor:o.colors.primary}],onPress:n.sessionId?()=>{c()}:()=>{!g&&s.length>0?(h(s[0].id),l(s[0].id)):g&&l(g)},children:(0,K.jsx)(ne.default,{style:[Ge.controlButtonText,{color:"#fff"}],children:n.sessionId?"Resume":"Start"})})}),p&&p.completedPomodoros?(0,K.jsxs)(E.default,{style:Ge.statsSection,children:[(0,K.jsx)(ne.default,{style:[Ge.statsTitle,{color:o.colors.text}],children:"Task Statistics"}),(0,K.jsxs)(E.default,{style:Ge.statsGrid,children:[(0,K.jsxs)(E.default,{style:Ge.statItem,children:[(0,K.jsx)(ne.default,{style:[Ge.statValue,{color:o.colors.primary}],children:p.completedPomodoros}),(0,K.jsx)(ne.default,{style:[Ge.statLabel,{color:o.colors.secondary}],children:"Completed"})]}),(0,K.jsxs)(E.default,{style:Ge.statItem,children:[(0,K.jsx)(ne.default,{style:[Ge.statValue,{color:o.colors.primary}],children:p.totalPomodoroTime||0}),(0,K.jsx)(ne.default,{style:[Ge.statLabel,{color:o.colors.secondary}],children:"Minutes"})]})]})]}):null]})};var qe=o(16773),_e=o(51690),Ye=o(74037),Ke=o(44767),Qe=o(51950),Je=o(92365),Ze=o(49162),et=o(46817),tt=o(1561),ot=(o(36786),o(12208),o(17366));const rt=(0,r.createContext)({showNotification:()=>{},hideNotification:()=>{}}),at=(B.default.create({container:{position:"absolute",top:30,left:16,right:16,borderRadius:12,overflow:"hidden",elevation:6,shadowOffset:{width:0,height:3},shadowOpacity:.3,shadowRadius:4,zIndex:1e3},content:{flexDirection:"row",padding:16,alignItems:"center"},iconContainer:{width:30,height:30,borderRadius:15,backgroundColor:"rgba(255, 255, 255, 0.25)",justifyContent:"center",alignItems:"center"},iconText:{color:"white",fontSize:16,fontWeight:"bold"},textContainer:{flex:1,marginLeft:16},title:{color:"white",fontWeight:"bold",fontSize:16,marginBottom:4},message:{color:"white",fontSize:14},closeButton:{paddingHorizontal:8,marginLeft:8},closeButtonText:{color:"#fff",fontWeight:"bold",fontSize:20},actionButton:{marginTop:8,alignSelf:"flex-start",backgroundColor:"rgba(255, 255, 255, 0.35)",paddingHorizontal:12,paddingVertical:5,borderRadius:4,borderWidth:1,borderColor:"rgba(255, 255, 255, 0.5)"},actionButtonText:{color:"#fff",fontWeight:"bold",fontSize:12}}),B.default.create({container:{marginTop:20},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},sectionTitle:{fontSize:18,fontWeight:"bold"},progressContainer:{flexDirection:"row",alignItems:"center"},progressText:{marginRight:8,fontSize:14},progressBar:{height:6,width:100,borderRadius:3},progressFill:{height:6,borderRadius:3},subtaskList:{marginBottom:10},subtaskItem:{flexDirection:"row",alignItems:"center",paddingVertical:12,borderBottomWidth:1},checkbox:{marginRight:10},subtaskTitle:{flex:1,fontSize:16},completedSubtask:{textDecorationLine:"line-through",opacity:.7},deleteButton:{paddingHorizontal:5},emptyText:{textAlign:"center",marginVertical:15,fontStyle:"italic"},addSubtaskContainer:{flexDirection:"row",alignItems:"center",borderTopWidth:1,paddingTop:15},input:{flex:1,height:40,paddingHorizontal:10,borderWidth:1,borderRadius:5,marginRight:10},addButton:{width:40,height:40,borderRadius:20,justifyContent:"center",alignItems:"center",elevation:3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:2}})),st=({taskId:e,subtasks:t=[],progress:o=0,onChange:a,isNewTask:s=!1})=>{const{addSubtask:n,toggleSubtask:i,deleteSubtask:l}=he(),{theme:d}=Z(),{showNotification:c}=(0,r.useContext)(rt),[u,m]=(0,r.useState)(""),[g,h]=(0,r.useState)(t);(0,r.useEffect)((()=>{h(t)}),[t]);const y=()=>{if(console.log("Add subtask button pressed"),console.log("Title:",u),console.log("Is new task:",s||"new"===e),u.trim()){if(s||"new"===e){console.log("Adding subtask locally");const e={id:`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,15)}`,title:u.trim(),completed:!1,createdAt:new Date},t=[...g,e];console.log("Updated subtasks:",t),h(t),a&&(console.log("Notifying parent of change"),a(t)),c({type:"success",title:"Subtask Added",message:`"${u.trim()}" has been added to the checklist.`})}else console.log("Adding subtask to store"),n(e,u.trim()).then((e=>{e&&c({type:"success",title:"Subtask Added",message:`"${u.trim()}" has been added to the checklist.`})}));m("")}else console.log("Empty title, not adding subtask")},p=s||"new"===e?g:t,x=s||"new"===e?(e=>{if(0===e.length)return 0;const t=e.filter((e=>e.completed)).length;return Math.round(t/e.length*100)})(g):o;return(0,K.jsxs)(E.default,{style:at.container,children:[(0,K.jsxs)(E.default,{style:at.headerContainer,children:[(0,K.jsx)(ne.default,{style:[at.sectionTitle,{color:d.colors.text}],children:"Checklist"}),p.length>0&&(0,K.jsxs)(E.default,{style:at.progressContainer,children:[(0,K.jsxs)(ne.default,{style:[at.progressText,{color:d.colors.text}],children:[x,"%"]}),(0,K.jsx)(E.default,{style:[at.progressBar,{backgroundColor:d.colors.outline||d.colors.text+"40"}],children:(0,K.jsx)(E.default,{style:[at.progressFill,{backgroundColor:d.colors.primary,width:`${x}%`}]})})]})]}),p.length>0?(0,K.jsx)(E.default,{style:at.subtaskList,children:p.map((t=>(0,K.jsxs)(E.default,{style:[at.subtaskItem,{borderBottomColor:d.colors.outline||d.colors.text+"40"}],children:[(0,K.jsx)(P.default,{style:at.checkbox,onPress:()=>(t=>{const o=s||"new"===e?g.find((e=>e.id===t)):p.find((e=>e.id===t));if(!o)return;const r=!o.completed;if(s||"new"===e){const e=g.map((e=>e.id===t?Object.assign({},e,{completed:!e.completed,updatedAt:new Date}):e));h(e),a&&a(e),c({type:r?"success":"info",title:r?"Subtask Completed":"Subtask Pending",message:`"${o.title}" has been marked as ${r?"completed":"pending"}.`})}else i(e,t).then((e=>{e&&c({type:r?"success":"info",title:r?"Subtask Completed":"Subtask Pending",message:`"${o.title}" has been marked as ${r?"completed":"pending"}.`})}))})(t.id),children:t.completed?(0,K.jsx)(f.default,{name:"checkmark-circle",size:20,color:d.colors.primary}):(0,K.jsx)(f.default,{name:"ellipse-outline",size:20,color:d.colors.text})}),(0,K.jsx)(ne.default,{style:[at.subtaskTitle,{color:d.colors.text},t.completed&&at.completedSubtask],children:t.title}),(0,K.jsx)(P.default,{style:at.deleteButton,onPress:()=>(t=>{const o=s||"new"===e?g.find((e=>e.id===t)):p.find((e=>e.id===t));if(!o)return;const r=o.title;s||"new"===e?_e.default.alert("Delete Subtask",`Are you sure you want to delete "${r}"?`,[{text:"Cancel",style:"cancel"},{text:"Delete",onPress:()=>{const e=g.filter((e=>e.id!==t));h(e),a&&a(e),c({type:"success",title:"Subtask Deleted",message:`"${r}" has been removed from the checklist.`})},style:"destructive"}]):_e.default.alert("Delete Subtask",`Are you sure you want to delete "${r}"?`,[{text:"Cancel",style:"cancel"},{text:"Delete",onPress:()=>{l(e,t).then((e=>{e&&c({type:"success",title:"Subtask Deleted",message:`"${r}" has been removed from the checklist.`})}))},style:"destructive"}])})(t.id),children:(0,K.jsx)(f.default,{name:"close-circle-outline",size:20,color:d.colors.error})})]},t.id)))}):(0,K.jsx)(ne.default,{style:[at.emptyText,{color:d.colors.text+"60"}],children:"No subtasks yet. Add one below."}),(0,K.jsxs)(E.default,{style:[at.addSubtaskContainer,{borderColor:d.colors.outline||d.colors.text+"40"}],children:[(0,K.jsx)(qe.default,{style:[at.input,{color:d.colors.text,borderColor:d.colors.outline||d.colors.text+"40"}],placeholder:"Add a subtask...",placeholderTextColor:d.colors.text+"60",value:u,onChangeText:m,onSubmitEditing:y}),(0,K.jsx)(P.default,{style:[at.addButton,{backgroundColor:d.colors.primary}],onPress:y,activeOpacity:.7,children:(0,K.jsx)(f.default,{name:"add",size:24,color:"white"})})]})]})};var nt=o(18359),it=o(61023),lt=o(92791),dt=o(3185);const ct=[{value:0,label:"At time of event"},{value:5,label:"5 minutes before"},{value:15,label:"15 minutes before"},{value:30,label:"30 minutes before"},{value:60,label:"1 hour before"},{value:120,label:"2 hours before"},{value:1440,label:"1 day before"}],ut=["daily","weekly","monthly","yearly"],ft=[{id:"work",name:"Work",color:"#FF5733"},{id:"personal",name:"Personal",color:"#33A1FF"},{id:"shopping",name:"Shopping",color:"#33FF57"},{id:"health",name:"Health",color:"#F033FF"},{id:"education",name:"Education",color:"#FFD433"},{id:"finance",name:"Finance",color:"#33FFC1"}],mt=[{title:"Meeting",icon:"users",color:"#4CAF50"},{title:"Email",icon:"envelope",color:"#2196F3"},{title:"Call",icon:"phone",color:"#FF9800"},{title:"Document",icon:"file-alt",color:"#9C27B0"},{title:"Exercise",icon:"running",color:"#E91E63"}],gt=[{value:"low",label:"Low",color:"#4CAF50",icon:"arrow-downward",description:"Not urgent"},{value:"medium",label:"Medium",color:"#FF9800",icon:"remove",description:"Moderate priority"},{value:"high",label:"High",color:"#F44336",icon:"arrow-upward",description:"Urgent"}];function ht({task:e,isVisible:t,onClose:o,onSave:a}){const{theme:s,isDark:n}=Z(),{addTask:i,updateTask:l,templates:d=[]}=he(),[c,u]=(0,r.useState)(!1),[f,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)(null),[y,p]=(0,r.useState)({}),[x,b]=(0,r.useState)(e?.title||""),[j,k]=(0,r.useState)(e?.description||""),[T,C]=(0,r.useState)(e?.priority||"medium"),[w,S]=(0,r.useState)(e?.dueDate?new Date(e.dueDate):void 0),[D,I]=(0,r.useState)(e?.dueDate?new Date(e.dueDate):void 0),[v,B]=(0,r.useState)(e?.categoryId||void 0),[R,A]=(0,r.useState)(""),[L,O]=(0,r.useState)(!1),[N,F]=(0,r.useState)(!1),[M,W]=(0,r.useState)(void 0!==e?.reminder),[V,H]=(0,r.useState)(e?.reminder||30),[U,$]=(0,r.useState)(void 0!==e?.recurrence),[G,X]=(0,r.useState)(e?.recurrence?.type||"daily"),[q,_]=(0,r.useState)(e?.recurrence?.interval||1),[Y,Q]=(0,r.useState)(e?.recurrence?.endDate),[J,ee]=(0,r.useState)(!1),[te,oe]=(0,r.useState)(!1),[re,ae]=(0,r.useState)(!1),[se,ie]=(0,r.useState)(!1),[de,ce]=(0,r.useState)("date"),[ue,ge]=(0,r.useState)("dueDate"),[pe,je]=(0,r.useState)(e?.subtasks||[]),[ke,Te]=(0,r.useState)(e?.progress||0),[Ce,we]=(0,r.useState)(!1),[Se,De]=(0,r.useState)("basic"),[Ie,Be]=(0,r.useState)(""),[Pe,Re]=(0,r.useState)(!1),[ze,Le]=(0,r.useState)(!1),[Oe,Ne]=(0,r.useState)(null);(0,r.useEffect)((()=>{if(e){if(b(e.title),k(e.description||""),C(e.priority),S(e.dueDate?new Date(e.dueDate):void 0),B(e.categoryId),e.dueDate&&I(e.dueDate?new Date(e.dueDate):void 0),void 0!==e.reminder&&(W(!0),H(e.reminder)),e.recurrence&&($(!0),X(e.recurrence.type),_(e.recurrence.interval),Q(e.recurrence.endDate)),(void 0!==e.reminder||e.recurrence)&&ee(!0),e.subtasks)if(je(e.subtasks),void 0!==e.progress)Te(e.progress);else if(e.subtasks.length>0){const t=e.subtasks.filter((e=>e.completed)).length;Te(Math.round(t/e.subtasks.length*100))}}else Fe()}),[e,t]);const Fe=()=>{b(""),k(""),C("medium"),S(void 0),I(void 0),B(void 0),W(!1),H(30),$(!1),X("daily"),_(1),Q(void 0),ee(!1),je([]),Te(0)},Me=(e,t)=>{ce(e),ge(t),"date"===e?oe(!0):ae(!0)},We=async e=>{try{switch(e){case"light":await lt.impactAsync(dt.ImpactFeedbackStyle.Light);break;case"medium":await lt.impactAsync(dt.ImpactFeedbackStyle.Medium);break;case"heavy":await lt.impactAsync(dt.ImpactFeedbackStyle.Heavy)}}catch(g){console.error("Haptics error:",g)}},Ve=async()=>{if(console.log("TaskForm - handleSubmit called"),console.log("TaskForm - Current title:",x),console.log("TaskForm - Trimmed title:",x?.trim()),!He())return console.log("TaskForm - Form validation failed"),void await We("medium");h(null),m(!0);try{const t={title:x||"",description:j||"",priority:T||"low",dueDate:w?(0,me.formatISO)(w):void 0,dueTime:D?(0,xe.format)(D,"HH:mm"):void 0,recurrence:U?{type:G,interval:q,endDate:Y}:void 0,reminder:M?V:void 0,completed:e?.completed||!1,subtasks:pe.length>0?pe:void 0,progress:pe.length>0?ke:void 0,tags:Ge,categoryId:v||void 0};let r;console.log("TaskForm - Submitting task data:",t),r=e?await l(Object.assign({id:e.id},t)):await i(t),await We("heavy"),a&&a(r),o()}catch(g){await We("medium"),console.error("TaskForm - Error saving task:",g),g instanceof Error&&"Title is required"===g.message&&x||(h(g instanceof Error?g.message:"Failed to save task. Please try again."),_e.default.alert("Error","Failed to save task. Please try again."))}finally{m(!1)}},He=()=>{console.log("TaskForm - Validating form..."),console.log("TaskForm - Title:",x),console.log("TaskForm - Trimmed title:",x.trim());const e={};return w&&w<new Date&&(console.log("TaskForm - Due date validation failed"),e.dueDate="Due date cannot be in the past"),j&&j.length>1e3&&(console.log("TaskForm - Description validation failed"),e.description="Description is too long (max 1000 characters)"),console.log("TaskForm - Validation errors:",e),p(e),0===Object.keys(e).length};(0,r.useEffect)((()=>{const e=setTimeout((()=>{x.trim()&&!f&&Ve()}),3e4);return()=>clearTimeout(e)}),[x,j,T,w,D,U,G,q,Y,M,V,pe,ke,Ge,v]);const[Ue,$e]=(0,r.useState)([]),[Ge,Xe]=(0,r.useState)(e?.tags?.map((e=>e.id))||[]),[Ze,et]=(0,r.useState)(e?.tags||[]),[tt,rt]=(0,r.useState)("");(0,r.useEffect)((()=>{at()}),[]);const at=async()=>{try{const e=await fe.executeSql("SELECT * FROM tags ORDER BY name");$e(e.rows._array)}catch(g){console.error("Error loading tags:",g)}},ht=async()=>{if(tt.trim())try{const e=await fe.executeSql("INSERT INTO tags (name, color) VALUES (?, ?)",[tt.trim(),s.colors.primary]),t=e.insertId?.toString();t&&(Xe((e=>[...e,t])),rt(""),at())}catch(g){console.error("Error adding tag:",g)}},pt=(e="medium")=>{switch(e.toLowerCase()){case"high":return"#FF5252";case"medium":return"#FFB300";case"low":return"#69F0AE";default:return"#BDBDBD"}},xt=e=>{Ne(e),Le(!0),We("medium"),setTimeout((()=>{const t={title:["Schedule team meeting for project review","Complete budget report for Q3","Research new project management tools","Follow up with client about feedback"],description:["Need to discuss timeline changes and resource allocation with the team. Prepare slides beforehand.","Include sales projections and expense breakdown. Send to finance department when complete.","Focus on tools that integrate with our current stack and have good collaboration features.","Address their concerns about the latest deliverable and provide timeline for revisions."]}[e],o=t[Math.floor(Math.random()*t.length)];"title"===e?b(o):k(o),Le(!1),Ne(null),We("heavy")}),2e3)};return(0,K.jsx)(ve.default,{visible:t,animationType:"slide",transparent:!1,onRequestClose:o,accessibilityLabel:e?"Edit Task Form":"Add Task Form",children:(0,K.jsx)(Ke.default,{behavior:"height",style:[yt.container,{backgroundColor:s.colors.background}],children:(0,K.jsx)(Qe.default,{onPress:()=>{Je.default.dismiss()},children:(0,K.jsxs)(E.default,{style:yt.container,children:[(0,K.jsxs)(E.default,{style:[yt.header,{borderBottomColor:s.colors.outline}],children:[(0,K.jsx)(ne.default,{style:[yt.headerTitle,{color:s.colors.text}],accessibilityRole:"header",children:e?"Edit Task":"New Task"}),(0,K.jsxs)(E.default,{style:yt.headerActions,children:[(0,K.jsx)(P.default,{style:yt.quickAddButton,onPress:()=>we(!Ce),accessibilityLabel:"Quick Add Templates",accessibilityHint:"Shows quick add task templates",children:(0,K.jsx)(be.default,{name:"bolt",size:24,color:s.colors.primary})}),(0,K.jsx)(P.default,{style:yt.closeButton,onPress:o,accessibilityLabel:"Close",children:(0,K.jsx)(be.default,{name:"close",size:24,color:s.colors.text})})]})]}),(0,K.jsxs)(E.default,{style:yt.sectionNav,children:[(0,K.jsx)(P.default,{style:[yt.sectionTab,"basic"===Se&&[yt.activeTab,{borderBottomColor:s.colors.primary}]],onPress:()=>De("basic"),children:(0,K.jsx)(ne.default,{style:[yt.sectionTabText,{color:"basic"===Se?s.colors.primary:s.colors.text}],children:"Basic"})}),(0,K.jsx)(P.default,{style:[yt.sectionTab,"details"===Se&&[yt.activeTab,{borderBottomColor:s.colors.primary}]],onPress:()=>De("details"),children:(0,K.jsx)(ne.default,{style:[yt.sectionTabText,{color:"details"===Se?s.colors.primary:s.colors.text}],children:"Details"})}),(0,K.jsx)(P.default,{style:[yt.sectionTab,"subtasks"===Se&&[yt.activeTab,{borderBottomColor:s.colors.primary}]],onPress:()=>De("subtasks"),children:(0,K.jsx)(ne.default,{style:[yt.sectionTabText,{color:"subtasks"===Se?s.colors.primary:s.colors.text}],children:"Subtasks"})})]}),Ce&&(0,K.jsxs)(E.default,{style:[yt.quickAddContainer,{backgroundColor:s.colors.background}],accessibilityLabel:"Quick Add Templates",children:[(0,K.jsx)(ne.default,{style:[yt.sectionLabel,{color:s.colors.text,fontWeight:"bold",marginBottom:8}],children:"Quick Templates"}),(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,accessibilityRole:"list",children:mt.map((e=>(0,K.jsxs)(P.default,{style:[yt.quickAddItem,{backgroundColor:e.color+"20"}],onPress:()=>(async e=>{await We("light"),b(e.title),B(e.color),we(!1)})(e),accessibilityLabel:`Quick add ${e.title} task`,accessibilityRole:"button",children:[(0,K.jsx)(nt.default,{name:e.icon,size:24,color:e.color}),(0,K.jsx)(ne.default,{style:[yt.quickAddText,{color:e.color}],children:e.title})]},e.title)))}),d.length>0&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ne.default,{style:[yt.sectionLabel,{color:s.colors.text,fontWeight:"bold",marginTop:16,marginBottom:8}],children:"Your Templates"}),(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,accessibilityRole:"list",children:d.map((e=>(0,K.jsxs)(P.default,{style:[yt.quickAddItem,{backgroundColor:pt(e.priority)+"20",borderLeftWidth:3,borderLeftColor:pt(e.priority)}],onPress:()=>(async e=>{if(await We("medium"),b(e.title),k(e.description||""),C(e.priority||"medium"),e.dueTimeOffset){const t=new Date;t.setDate(t.getDate()+e.dueTimeOffset),S(t)}else{const e=new Date;e.setDate(e.getDate()+1),S(e)}if(e.subtasks&&Array.isArray(e.subtasks)){const t=e.subtasks.map((e=>({id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:e.title,completed:!1,createdAt:new Date})));je(t)}e.categoryId&&B(e.categoryId),we(!1)})(e),accessibilityLabel:`Use template ${e.name}`,accessibilityRole:"button",children:[(0,K.jsx)(Ee.default,{name:"file-document-outline",size:24,color:pt(e.priority)}),(0,K.jsx)(ne.default,{style:[yt.quickAddText,{color:s.colors.text}],children:e.name})]},e.id)))})]})]}),(0,K.jsxs)(Ae.default,{style:yt.formContainer,keyboardShouldPersistTaps:"handled",showsVerticalScrollIndicator:!1,accessibilityRole:"none",children:["basic"===Se&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)(ye.default,{style:[yt.inputSurface,{backgroundColor:s.colors.surface}],children:[(0,K.jsxs)(E.default,{style:yt.titleInputContainer,children:[(0,K.jsx)(qe.default,{style:[yt.input,{color:s.colors.text,flex:1},y.title&&yt.inputError],placeholder:"What do you need to do?",placeholderTextColor:s.colors.text+"80",value:x,onChangeText:e=>{console.log("TaskForm - Title changed:",e),b(e),y.title&&p((e=>Object.assign({},e,{title:void 0})))},accessibilityLabel:"Task Title",accessibilityHint:"Enter the title of your task",accessibilityRole:"none"}),(0,K.jsx)(P.default,{style:yt.voiceButton,onPress:()=>xt("title"),disabled:ze,children:(0,K.jsx)(Ee.default,{name:"microphone-outline",size:24,color:ze&&"title"===Oe?"red":s.colors.primary})})]}),L&&(0,K.jsxs)(E.default,{style:yt.suggestionContainer,children:[(0,K.jsxs)(ne.default,{style:yt.suggestionText,children:["Suggestion: ",R]}),(0,K.jsx)(P.default,{style:yt.acceptButton,onPress:()=>{b(R),O(!1)},children:(0,K.jsx)(ne.default,{style:yt.acceptButtonText,children:"Use this"})})]}),N&&(0,K.jsxs)(E.default,{style:yt.loadingContainer,children:[(0,K.jsx)(le.default,{size:"small",color:s.colors.primary}),(0,K.jsx)(ne.default,{style:{marginLeft:8,color:s.colors.text},children:"Generating suggestion..."})]}),y.title&&(0,K.jsx)(it.default,{type:"error",visible:!0,children:y.title})]}),(0,K.jsx)(ye.default,{style:[yt.inputSurface,{backgroundColor:s.colors.surface}],children:(0,K.jsxs)(E.default,{style:yt.descriptionContainer,children:[(0,K.jsx)(qe.default,{style:[yt.input,yt.textArea,{color:s.colors.text,flex:1}],placeholder:"Add details (optional)",placeholderTextColor:s.colors.text+"80",value:j,onChangeText:k,multiline:!0,numberOfLines:3,accessibilityLabel:"Task Description",accessibilityHint:"Enter the description of your task",accessibilityRole:"none"}),(0,K.jsx)(P.default,{style:yt.voiceButton,onPress:()=>xt("description"),disabled:ze,children:(0,K.jsx)(Ee.default,{name:"microphone-outline",size:24,color:ze&&"description"===Oe?"red":s.colors.primary})})]})}),(0,K.jsxs)(E.default,{style:yt.prioritySection,children:[(0,K.jsx)(ne.default,{style:[yt.label,{color:s.colors.text}],children:"Priority"}),(0,K.jsx)(E.default,{style:yt.priorityContainer,children:gt.map((e=>(0,K.jsxs)(P.default,{style:[yt.priorityButton,{borderColor:T===e.value?e.color:s.colors.outline,backgroundColor:T===e.value?e.color+"20":"transparent"}],onPress:()=>{We("light"),C(e.value)},accessibilityLabel:`Set priority to ${e.label} - ${e.description}`,accessibilityRole:"button",children:[(0,K.jsx)(be.default,{name:e.icon,size:24,color:T===e.value?e.color:s.colors.text}),(0,K.jsx)(ne.default,{style:[yt.priorityText,{color:T===e.value?e.color:s.colors.text}],children:e.label})]},e.value)))})]})]}),"details"===Se&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ne.default,{style:[yt.label,{color:s.colors.text}],children:"Due Date & Time"}),(0,K.jsxs)(E.default,{style:yt.dateTimeContainer,children:[(0,K.jsxs)(P.default,{style:[yt.dateTimeButton,{borderColor:s.colors.outline}],onPress:()=>Me("date","dueDate"),children:[(0,K.jsx)(be.default,{name:"event",size:20,color:s.colors.text}),(0,K.jsx)(ne.default,{style:[yt.dateTimeButtonText,{color:s.colors.text}],children:w?(0,xe.format)(w,"EEE, MMM d"):"Add date"})]}),(0,K.jsxs)(P.default,{style:[yt.dateTimeButton,{borderColor:s.colors.outline},!w&&yt.dateTimeButtonDisabled],onPress:()=>w&&Me("time","dueTime"),disabled:!w,children:[(0,K.jsx)(be.default,{name:"schedule",size:20,color:s.colors.text}),(0,K.jsx)(ne.default,{style:[yt.dateTimeButtonText,{color:s.colors.text}],children:D?(e=>{if(!e)return"Set time";try{return(0,xe.format)(e,"h:mm a")}catch(g){return console.error("Error formatting time:",g),"Invalid time"}})(D):"Add time"})]})]}),(0,K.jsx)(ne.default,{style:[yt.label,{color:s.colors.text}],children:"Category"}),(0,K.jsx)(E.default,{style:yt.categoryContainer,children:ft.map((e=>(0,K.jsxs)(P.default,{style:[yt.categoryButton,{borderColor:e.color,backgroundColor:v===e.id?e.color+"30":"transparent"}],onPress:()=>B(e.id),children:[(0,K.jsx)(E.default,{style:[yt.colorIndicator,{backgroundColor:e.color}]}),(0,K.jsx)(ne.default,{style:[yt.categoryText,{color:v===e.id?e.color:s.colors.text}],children:e.name})]},e.id)))}),(0,K.jsx)(ne.default,{style:[yt.label,{color:s.colors.text}],children:"Tags"}),(0,K.jsxs)(E.default,{style:yt.tagsContainer,children:[(0,K.jsx)(E.default,{style:yt.tagsList,children:Ue.map((e=>(0,K.jsx)(z.default,{selected:Ge.includes(e.id),onPress:()=>{return t=e.id,void Xe((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t},style:[yt.tag,{backgroundColor:Ge.includes(e.id)?e.color+"20":s.colors.surface,borderColor:e.color,marginRight:8}],children:e.name},e.id)))}),(0,K.jsxs)(E.default,{style:yt.tagInputContainer,children:[(0,K.jsx)(qe.default,{style:[yt.tagInput,{color:s.colors.text,backgroundColor:s.colors.surface,borderColor:s.colors.outline}],value:tt,onChangeText:rt,placeholder:"Add new tag",placeholderTextColor:s.colors.text+"80",onSubmitEditing:ht}),(0,K.jsx)(P.default,{style:[yt.addTagButton,{backgroundColor:s.colors.primary}],onPress:ht,children:(0,K.jsx)(be.default,{name:"add",size:24,color:"#fff"})})]})]}),(0,K.jsxs)(E.default,{style:yt.optionRow,children:[(0,K.jsx)(ne.default,{style:[yt.optionLabel,{color:s.colors.text}],children:"Set Reminder"}),(0,K.jsx)(Ye.default,{value:M,onValueChange:W,trackColor:{false:s.colors.text+"40",true:s.colors.primary+"80"},thumbColor:M?s.colors.primary:s.colors.surface})]}),M&&(0,K.jsx)(E.default,{style:[yt.pickerContainer,{borderColor:s.colors.outline,backgroundColor:s.colors.surface,marginBottom:16}],children:(0,K.jsx)(ot.Picker,{selectedValue:V,onValueChange:e=>H(e),style:{color:s.colors.text},children:ct.map((e=>(0,K.jsx)(ot.Picker.Item,{label:e.label,value:e.value},e.value)))})}),(0,K.jsxs)(E.default,{style:yt.optionRow,children:[(0,K.jsx)(ne.default,{style:[yt.optionLabel,{color:s.colors.text}],children:"Recurring Task"}),(0,K.jsx)(Ye.default,{value:U,onValueChange:$,trackColor:{false:s.colors.text+"40",true:s.colors.primary+"80"},thumbColor:U?s.colors.primary:s.colors.surface})]}),U&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ne.default,{style:[yt.recurDescription,{color:s.colors.text}],children:(()=>{if(!U)return"";let e="Every ";switch(q>1&&(e+=`${q} `),G){case"daily":e+=q>1?"days":"day";break;case"weekly":e+=q>1?"weeks":"week";break;case"monthly":e+=q>1?"months":"month";break;case"yearly":e+=q>1?"years":"year"}return Y&&(e+=` until ${(0,xe.format)(Y,"MMM d, yyyy")}`),e})()}),(0,K.jsxs)(E.default,{style:yt.recurrenceRow,children:[(0,K.jsx)(ne.default,{style:[yt.recurrenceLabel,{color:s.colors.text}],children:"Repeat every"}),(0,K.jsx)(qe.default,{style:[yt.recurrenceInput,{borderColor:s.colors.outline,backgroundColor:s.colors.surface,color:s.colors.text}],value:q.toString(),onChangeText:e=>{const t=parseInt(e);!isNaN(t)&&t>0?_(t):""===e&&_(1)},keyboardType:"number-pad"}),(0,K.jsx)(E.default,{style:[yt.typePickerContainer,{borderColor:s.colors.outline,backgroundColor:s.colors.surface}],children:(0,K.jsx)(ot.Picker,{selectedValue:G,onValueChange:e=>X(e),style:{color:s.colors.text,flex:1},children:ut.map((e=>(0,K.jsx)(ot.Picker.Item,{label:e+(q>1?"s":""),value:e},e)))})})]}),(0,K.jsx)(P.default,{style:[yt.endDateButton,{borderColor:s.colors.outline,backgroundColor:s.colors.surface}],onPress:()=>Me("date","recurrenceEndDate"),children:(0,K.jsx)(ne.default,{style:[yt.endDateButtonText,{color:s.colors.text}],children:Y?`End on ${(0,xe.format)(Y,"MMM d, yyyy")}`:"Set end date (optional)"})})]})]}),"subtasks"===Se&&(0,K.jsx)(st,{taskId:e?.id||"new",subtasks:pe,progress:ke,onChange:e=>{if(console.log("Subtasks changed:",e),je(e),e.length>0){const t=e.filter((e=>e.completed)).length,o=Math.round(t/e.length*100);console.log("New progress:",o),Te(o)}else Te(0)},isNewTask:!e}),g&&(0,K.jsx)(E.default,{style:[yt.errorContainer,{backgroundColor:s.colors.error+"20"}],children:(0,K.jsx)(ne.default,{style:[yt.errorText,{color:s.colors.error}],children:g})}),(0,K.jsx)(P.default,{style:[yt.saveButton,{backgroundColor:s.colors.primary},(f||c)&&yt.saveButtonDisabled],onPress:Ve,disabled:f||c,accessibilityLabel:e?"Update Task":"Add Task",accessibilityRole:"button",accessibilityState:{disabled:f||c},children:f?(0,K.jsx)(le.default,{color:"#fff"}):(0,K.jsx)(ne.default,{style:yt.saveButtonText,children:e?"Update Task":"Add Task"})})]}),!1,!1,!1,ze&&(0,K.jsxs)(E.default,{style:yt.listeningIndicator,children:[(0,K.jsx)(le.default,{size:"small",color:"red"}),(0,K.jsx)(ne.default,{style:yt.listeningText,children:"Listening..."}),(0,K.jsx)(P.default,{style:yt.cancelVoiceButton,onPress:()=>{Le(!1),Ne(null),We("light")},children:(0,K.jsx)(ne.default,{style:yt.cancelVoiceText,children:"Cancel"})})]})]})})})})}const yt=B.default.create({container:{flex:1,backgroundColor:"#fff"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:"#eee",backgroundColor:"#fff",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2},headerTitle:{fontSize:24,fontWeight:"bold",color:"#333"},headerActions:{flexDirection:"row",alignItems:"center"},quickAddButton:{marginRight:16,padding:8,borderRadius:20,backgroundColor:"#f0f0f0"},closeButton:{padding:8,borderRadius:20,backgroundColor:"#f0f0f0"},quickAddContainer:{padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#eee"},sectionLabel:{fontSize:16,fontWeight:"bold",marginBottom:8},quickAddItem:{flexDirection:"row",alignItems:"center",padding:12,borderRadius:12,marginRight:12,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2},quickAddText:{marginLeft:8,fontSize:16,fontWeight:"600"},formContainer:{flex:1,padding:16},inputGroup:{marginBottom:24},label:{fontSize:16,fontWeight:"600",color:"#333",marginBottom:8},input:{backgroundColor:"#f8f8f8",padding:16,borderRadius:12,fontSize:16,borderWidth:1,borderColor:"#eee"},textArea:{height:100,textAlignVertical:"top"},prioritySection:{marginBottom:16},priorityContainer:{flexDirection:"row",justifyContent:"space-between",gap:12,marginTop:8},priorityButton:{flex:1,padding:12,borderRadius:12,alignItems:"center",borderWidth:1,borderColor:"#eee"},priorityText:{fontSize:14,fontWeight:"600",marginTop:4},priorityIcon:{marginBottom:8},dateTimeContainer:{flexDirection:"row",justifyContent:"space-between",gap:12},dateTimeButton:{flex:1,padding:16,borderRadius:12,backgroundColor:"#f8f8f8",borderWidth:1,borderColor:"#eee",flexDirection:"row",alignItems:"center",justifyContent:"center"},dateTimeButtonDisabled:{opacity:.5},dateTimeButtonText:{fontSize:16,color:"#333",marginLeft:8},dateTimeButtonTextDisabled:{color:"#999"},tagsContainer:{marginTop:8},tagsList:{flexDirection:"row",flexWrap:"wrap",marginBottom:12},tag:{marginBottom:8},tagInputContainer:{flexDirection:"row",alignItems:"center",gap:8},tagInput:{flex:1,height:40,paddingHorizontal:12,borderRadius:20,borderWidth:1,fontSize:16},addTagButton:{width:40,height:40,borderRadius:20,justifyContent:"center",alignItems:"center",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.2,shadowRadius:2},pickerContainer:{backgroundColor:"#fff",borderRadius:8,borderWidth:1,borderColor:"#eee",marginBottom:16},pickerLabel:{fontSize:14,color:"#666",marginBottom:4},picker:{height:50},actionsContainer:{flexDirection:"row",justifyContent:"space-between",padding:16,backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#eee",elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:-1},shadowOpacity:.1,shadowRadius:2},cancelButton:{flex:1,marginRight:8,backgroundColor:"#f0f0f0",borderRadius:12,padding:16},cancelButtonText:{color:"#666",fontSize:16,fontWeight:"600",textAlign:"center"},createButton:{flex:1,marginLeft:8,backgroundColor:"#007AFF",borderRadius:12,padding:16},createButtonText:{color:"#fff",fontSize:16,fontWeight:"600",textAlign:"center"},errorText:{color:"#FF3B30",fontSize:14,marginTop:4},subtasksContainer:{backgroundColor:"#f8f8f8",borderRadius:12,padding:16,marginTop:8},subtaskItem:{flexDirection:"row",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderBottomColor:"#eee"},subtaskItemLast:{borderBottomWidth:0},subtaskCheckbox:{marginRight:12},subtaskInput:{flex:1,fontSize:16,color:"#333"},addSubtaskButton:{flexDirection:"row",alignItems:"center",marginTop:12,padding:8},addSubtaskText:{color:"#007AFF",fontSize:16,marginLeft:8},addSubtaskIcon:{color:"#007AFF"},categoryContainer:{flexDirection:"row",flexWrap:"wrap",gap:8,marginTop:8,marginBottom:24},categoryButton:{flexDirection:"row",alignItems:"center",padding:12,borderRadius:12,backgroundColor:"#f8f8f8",borderWidth:1,borderColor:"#eee"},categoryButtonActive:{backgroundColor:"#007AFF10",borderColor:"#007AFF"},categoryIcon:{marginRight:8,fontSize:18},categoryText:{fontSize:16,color:"#333"},categoryTextActive:{color:"#007AFF"},inputSurface:{elevation:2,borderRadius:8,marginBottom:16},inputError:{borderColor:"#B00020"},advancedButton:{borderWidth:1,borderRadius:8,padding:12,alignItems:"center",marginBottom:16,borderStyle:"dashed"},advancedButtonText:{fontWeight:"500"},advancedSection:{marginBottom:16},optionRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},optionLabel:{fontSize:16,fontWeight:"500"},recurDescription:{fontSize:14,marginBottom:16,fontStyle:"italic"},recurrenceRow:{flexDirection:"row",alignItems:"center",marginBottom:16},recurrenceLabel:{fontSize:16,marginRight:8},recurrenceInput:{borderWidth:1,borderRadius:8,padding:8,width:50,textAlign:"center",marginRight:8},typePickerContainer:{flex:1,borderWidth:1,borderRadius:8,height:40,justifyContent:"center"},endDateButton:{borderWidth:1,borderRadius:8,padding:12,marginBottom:16},endDateButtonText:{fontSize:16},saveButton:{padding:16,borderRadius:8,alignItems:"center",marginVertical:8},saveButtonText:{color:"#fff",fontSize:18,fontWeight:"bold"},datePickerContainer:{position:"absolute",bottom:0,left:0,right:0,padding:16},datePickerHeader:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},datePickerCancel:{fontSize:16},datePickerDone:{fontSize:16,fontWeight:"500"},errorContainer:{padding:12,borderRadius:8,marginBottom:16},saveButtonDisabled:{opacity:.7},advancedOptionsButton:{flexDirection:"row",alignItems:"center",padding:16,borderRadius:12,marginTop:8,marginBottom:16,borderWidth:1,borderColor:"#eee"},sectionNav:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#eee"},sectionTab:{flex:1,paddingVertical:12,alignItems:"center"},activeTab:{borderBottomWidth:2},sectionTabText:{fontSize:16,fontWeight:"500"},titleInputContainer:{flexDirection:"row",alignItems:"center"},aiSuggestButton:{padding:8},suggestionContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:16,paddingVertical:8,backgroundColor:"#f0f8ff",borderRadius:8,marginTop:8},suggestionText:{flex:1,fontSize:14,color:"#333"},acceptButton:{backgroundColor:"#007AFF",paddingHorizontal:12,paddingVertical:6,borderRadius:16},acceptButtonText:{color:"#fff",fontSize:12,fontWeight:"bold"},loadingContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:8},smartDateContainer:{marginBottom:16},smartDateButton:{flexDirection:"row",alignItems:"center",padding:8},smartDateText:{marginLeft:8,fontSize:14},smartDateInputContainer:{flexDirection:"row",alignItems:"center",marginTop:8},smartDateInput:{flex:1,height:40,borderWidth:1,borderRadius:8,paddingHorizontal:12,marginRight:8},smartDateSubmit:{width:40,height:40,borderRadius:20,justifyContent:"center",alignItems:"center"},voiceButton:{padding:8},descriptionContainer:{flexDirection:"row",alignItems:"flex-start"},listeningIndicator:{flexDirection:"row",alignItems:"center",padding:8,backgroundColor:"rgba(255,0,0,0.1)",borderRadius:16,marginVertical:8},listeningText:{color:"red",marginLeft:8,flex:1},cancelVoiceButton:{backgroundColor:"rgba(255,0,0,0.2)",paddingHorizontal:12,paddingVertical:4,borderRadius:12},cancelVoiceText:{color:"red",fontSize:12}});var pt=o(95620),xt=o(34595);const bt=B.default.create({container:{flex:1,width:"100%"},scrollContainer:{flexGrow:1,paddingBottom:30},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},pomodoroContainer:{width:"100%",borderRadius:16,padding:16,shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:8,elevation:4},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},headerTitle:{fontSize:22,fontWeight:"bold"},headerControls:{flexDirection:"row",alignItems:"center"},iconButton:{padding:8,marginLeft:8},taskSelector:{flexDirection:"row",alignItems:"center",padding:12,borderRadius:8,marginBottom:20},taskSelectorIcon:{marginRight:8},taskSelectorText:{flex:1,fontSize:16},timerContainer:{alignItems:"center",justifyContent:"center",marginVertical:16},circularProgress:{width:250,height:250,alignItems:"center",justifyContent:"center",position:"relative"},circleBackground:{width:240,height:240,borderRadius:120,borderWidth:10,position:"absolute"},circleProgress:{position:"absolute"},timerTextContainer:{alignItems:"center",justifyContent:"center"},timerTypeText:{fontSize:18,marginBottom:4},timerText:{fontSize:48,fontWeight:"bold",fontVariant:["tabular-nums"],letterSpacing:2},sessionCountText:{fontSize:14,marginTop:4},controlsContainer:{marginTop:24,marginBottom:16},activeControls:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingHorizontal:16},controlButton:{width:50,height:50,borderRadius:25,justifyContent:"center",alignItems:"center",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:2,elevation:2},mainControlButton:{width:64,height:64,borderRadius:32},startButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:12,paddingHorizontal:24,borderRadius:30,shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:2,elevation:2},startButtonText:{color:"#fff",fontSize:18,fontWeight:"bold",marginLeft:8},statsContainer:{marginTop:16,paddingTop:16,borderTopWidth:1,borderTopColor:"rgba(0,0,0,0.1)"},statsTitle:{fontSize:18,fontWeight:"bold",marginBottom:12},statsRow:{flexDirection:"row",justifyContent:"space-around"},statCard:{padding:16,borderRadius:8,alignItems:"center",width:"45%"},statValue:{fontSize:24,fontWeight:"bold",marginVertical:4},statLabel:{fontSize:14},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",padding:16},taskSelectorModal:{width:"100%",maxWidth:400,borderRadius:16,padding:16,maxHeight:"80%",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:8,elevation:4},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},modalTitle:{fontSize:20,fontWeight:"bold"},closeButton:{position:"absolute",top:16,right:16,width:36,height:36,borderRadius:18,justifyContent:"center",alignItems:"center",zIndex:10,elevation:5},taskOptionsContainer:{maxHeight:400},taskOption:{flexDirection:"row",padding:12,borderRadius:8,marginBottom:8},priorityIndicator:{width:4,height:"100%",borderRadius:2,marginRight:8},taskOptionContent:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},taskTitle:{fontSize:16,flex:1},selectedIndicator:{marginLeft:8},emptyTasksContainer:{padding:16,alignItems:"center"},emptyTasksText:{fontSize:16,textAlign:"center"},interruptionDialog:{width:"100%",maxWidth:400,borderRadius:16,padding:16,shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:8,elevation:4},dialogTitle:{fontSize:20,fontWeight:"bold",marginBottom:8},dialogMessage:{fontSize:16,marginBottom:16},interruptionInput:{borderWidth:1,borderRadius:8,padding:12,marginBottom:16,height:100,textAlignVertical:"top"},dialogActions:{flexDirection:"row",justifyContent:"flex-end"},dialogButton:{paddingVertical:8,paddingHorizontal:16,borderRadius:8,marginLeft:8},dialogButtonText:{fontSize:16,fontWeight:"500"},infoContainer:{marginTop:20,padding:16,borderTopWidth:1,borderTopColor:"rgba(0,0,0,0.1)"},infoTitle:{fontSize:18,fontWeight:"bold",marginBottom:8},infoSubtitle:{fontSize:16,fontWeight:"bold",marginTop:16,marginBottom:8},infoText:{fontSize:14,lineHeight:20},benefitsList:{marginLeft:8},benefitItem:{flexDirection:"row",alignItems:"center",marginBottom:8},benefitIcon:{marginRight:8},benefitText:{fontSize:14,lineHeight:20}}),jt=({onClose:e,initialTaskId:t,showCloseButton:o=!0})=>{const{theme:a,isDark:s}=Z(),{tasks:n,currentPomodoro:i,pomodoroSettings:l,startPomodoro:d,pausePomodoro:c,resumePomodoro:u,stopPomodoro:f,completePomodoro:m,skipBreak:g}=he(),[h,y]=(0,r.useState)(t||null),[p,x]=(0,r.useState)(""),[b,j]=(0,r.useState)(!1),[k,T]=(0,r.useState)(!1),[C,w]=(0,r.useState)(!0),[S,D]=(0,r.useState)(!1),I=(0,r.useRef)(null),v=(0,r.useRef)(new Te.default.Value(0)).current,B=(0,r.useRef)(new Te.default.Value(1)).current,R=h?n.find((e=>e.id===h)):null,A=function(e){const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}(i.timeRemaining),z=i.active,L=i.isBreak,O=L?i.timeRemaining>60*l.shortBreakDuration?"Long Break":"Short Break":"Work Session",N=L?a.colors.success:a.colors.primary,F=L?i.timeRemaining>60*l.shortBreakDuration?60*l.longBreakDuration:60*l.shortBreakDuration:60*l.workDuration,M=(F-i.timeRemaining)/F,W=2*Math.PI*120,V=W*(1-M);v.interpolate({inputRange:[0,1],outputRange:[W,0]});(0,r.useEffect)((()=>{Te.default.timing(v,{toValue:M,duration:300,useNativeDriver:!1,easing:pt.default.linear}).start(),i.timeRemaining<=60&&z&&Te.default.sequence([Te.default.timing(B,{toValue:1.05,duration:500,useNativeDriver:!0,easing:pt.default.out(pt.default.ease)}),Te.default.timing(B,{toValue:1,duration:500,useNativeDriver:!0,easing:pt.default.in(pt.default.ease)})]).start((()=>{i.timeRemaining<=60&&z&&B.setValue(1)}))}),[i.timeRemaining,z]),(0,r.useEffect)((()=>(z?I.current=setInterval((()=>{i.timeRemaining<=1?L?U():H():he.setState((e=>({currentPomodoro:Object.assign({},e.currentPomodoro,{timeRemaining:e.currentPomodoro.timeRemaining-1})})))}),1e3):I.current&&(clearInterval(I.current),I.current=null),()=>{I.current&&clearInterval(I.current)})),[z,i.timeRemaining,L]),(0,r.useEffect)((()=>{t&&y(t)}),[t]),(0,r.useEffect)((()=>()=>{i.active||f(!1,"")}),[]);const H=()=>{m()},U=()=>{f(!1,""),l.autoStartNextSession&&h&&d(h)},$=()=>{h?d(h):j(!0)},G=()=>{g(),!l.autoStartNextSession&&h&&d(h)},X=()=>{i.active&&f(!1,""),e&&e()};return(0,r.useEffect)((()=>{const e=e=>{"Escape"===e.key&&X()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e),i.active&&f(!1,"")}}),[i.active,f]),(0,K.jsxs)(E.default,{style:[bt.container,{backgroundColor:a.colors.background}],children:[(0,K.jsx)(Ae.default,{contentContainerStyle:bt.scrollContainer,children:(0,K.jsxs)(E.default,{style:[bt.pomodoroContainer,{backgroundColor:s?"#222":"#fff",shadowColor:s?"#000":"#888"}],children:[(0,K.jsxs)(E.default,{style:bt.header,children:[(0,K.jsx)(ne.default,{style:[bt.headerTitle,{color:a.colors.text}],children:"Pomodoro Timer"}),(0,K.jsxs)(E.default,{style:bt.headerControls,children:[(0,K.jsx)(P.default,{style:bt.iconButton,onPress:()=>w(!C),accessibilityLabel:C?"Disable sound":"Enable sound",children:(0,K.jsx)(be.default,{name:C?"volume-up":"volume-off",size:24,color:a.colors.text})}),o&&(0,K.jsx)(P.default,{style:[bt.iconButton,{marginLeft:8}],onPress:X,children:(0,K.jsx)(be.default,{name:"close",size:24,color:a.colors.text})})]})]}),(0,K.jsxs)(P.default,{style:[bt.taskSelector,{backgroundColor:s?"#333":"#f5f5f5"}],onPress:()=>j(!0),children:[(0,K.jsx)(be.default,{name:"assignment",size:20,color:a.colors.primary,style:bt.taskSelectorIcon}),(0,K.jsx)(ne.default,{style:[bt.taskSelectorText,{color:a.colors.text},!R&&{color:a.colors.placeholder||"#999"}],numberOfLines:1,children:R?R.title:"Select a task to focus on"}),(0,K.jsx)(be.default,{name:"keyboard-arrow-down",size:20,color:a.colors.text})]}),(0,K.jsx)(Te.default.View,{style:[bt.timerContainer,{transform:[{scale:B}]}],children:(0,K.jsxs)(E.default,{style:bt.circularProgress,children:[(0,K.jsx)(E.default,{style:[bt.circleBackground,{borderColor:s?"#444":"#eee"}]}),(0,K.jsx)(xt.default,{width:250,height:250,style:bt.circleProgress,children:(0,K.jsx)(xt.Circle,{cx:125,cy:125,r:120,stroke:N,strokeWidth:10,fill:"transparent",strokeDasharray:W,strokeDashoffset:V,strokeLinecap:"round",transform:"rotate(-90, 125, 125)"})}),(0,K.jsxs)(E.default,{style:bt.timerTextContainer,children:[(0,K.jsx)(ne.default,{style:[bt.timerTypeText,{color:a.colors.text}],children:O}),(0,K.jsx)(ne.default,{style:[bt.timerText,{color:N}],children:A}),(0,K.jsxs)(ne.default,{style:[bt.sessionCountText,{color:a.colors.secondary||"#999"}],children:["Session ",i.currentSessionCount," of ",l.sessionsUntilLongBreak]})]})]})}),(0,K.jsx)(E.default,{style:bt.controlsContainer,children:z?(0,K.jsxs)(E.default,{style:bt.activeControls,children:[(0,K.jsx)(P.default,{style:[bt.controlButton,{backgroundColor:a.colors.error}],onPress:()=>{T(!0)},children:(0,K.jsx)(be.default,{name:"stop",size:24,color:"#fff"})}),(0,K.jsx)(P.default,{style:[bt.controlButton,bt.mainControlButton,{backgroundColor:z?a.colors.warning:a.colors.primary}],onPress:z?()=>{c()}:L?G:$,children:(0,K.jsx)(be.default,{name:z?"pause":"play-arrow",size:32,color:"#fff"})}),L&&(0,K.jsx)(P.default,{style:[bt.controlButton,{backgroundColor:a.colors.primary}],onPress:G,children:(0,K.jsx)(be.default,{name:"skip-next",size:24,color:"#fff"})}),!L&&!z&&(0,K.jsx)(P.default,{style:[bt.controlButton,{backgroundColor:a.colors.secondary||"#666"}],onPress:()=>D(!0),children:(0,K.jsx)(be.default,{name:"settings",size:24,color:"#fff"})})]}):(0,K.jsxs)(P.default,{style:[bt.startButton,{backgroundColor:a.colors.primary}],onPress:i.sessionId?()=>{u()}:$,children:[(0,K.jsx)(be.default,{name:i.sessionId?"play-arrow":"play-circle-filled",size:24,color:"#fff"}),(0,K.jsx)(ne.default,{style:bt.startButtonText,children:i.sessionId?"Resume Session":"Start Session"})]})}),R&&void 0!==R.completedPomodoros&&R.completedPomodoros>0&&(0,K.jsxs)(E.default,{style:bt.statsContainer,children:[(0,K.jsx)(ne.default,{style:[bt.statsTitle,{color:a.colors.text}],children:"Task Progress"}),(0,K.jsxs)(E.default,{style:bt.statsRow,children:[(0,K.jsxs)(E.default,{style:[bt.statCard,{backgroundColor:s?"#333":"#f5f5f5"}],children:[(0,K.jsx)(nt.default,{name:"hourglass-half",size:18,color:a.colors.primary}),(0,K.jsx)(ne.default,{style:[bt.statValue,{color:a.colors.primary}],children:R.completedPomodoros}),(0,K.jsx)(ne.default,{style:[bt.statLabel,{color:a.colors.text}],children:"Pomodoros"})]}),(0,K.jsxs)(E.default,{style:[bt.statCard,{backgroundColor:s?"#333":"#f5f5f5"}],children:[(0,K.jsx)(nt.default,{name:"stopwatch",size:18,color:a.colors.success}),(0,K.jsx)(ne.default,{style:[bt.statValue,{color:a.colors.success}],children:R.totalPomodoroTime||0}),(0,K.jsx)(ne.default,{style:[bt.statLabel,{color:a.colors.text}],children:"Minutes"})]})]})]}),(0,K.jsxs)(E.default,{style:bt.infoContainer,children:[(0,K.jsx)(ne.default,{style:[bt.infoTitle,{color:a.colors.text}],children:"What is the Pomodoro Technique?"}),(0,K.jsx)(ne.default,{style:[bt.infoText,{color:a.colors.text}],children:"The Pomodoro Technique is a time management method developed by Francesco Cirillo in the late 1980s. It uses a timer to break work into intervals, traditionally 25 minutes in length, separated by short breaks."}),(0,K.jsx)(ne.default,{style:[bt.infoSubtitle,{color:a.colors.text}],children:"Benefits:"}),(0,K.jsxs)(E.default,{style:bt.benefitsList,children:[(0,K.jsxs)(E.default,{style:bt.benefitItem,children:[(0,K.jsx)(be.default,{name:"check-circle",size:18,color:a.colors.primary,style:bt.benefitIcon}),(0,K.jsx)(ne.default,{style:[bt.benefitText,{color:a.colors.text}],children:"Improved focus and concentration"})]}),(0,K.jsxs)(E.default,{style:bt.benefitItem,children:[(0,K.jsx)(be.default,{name:"check-circle",size:18,color:a.colors.primary,style:bt.benefitIcon}),(0,K.jsx)(ne.default,{style:[bt.benefitText,{color:a.colors.text}],children:"Reduced mental fatigue"})]}),(0,K.jsxs)(E.default,{style:bt.benefitItem,children:[(0,K.jsx)(be.default,{name:"check-circle",size:18,color:a.colors.primary,style:bt.benefitIcon}),(0,K.jsx)(ne.default,{style:[bt.benefitText,{color:a.colors.text}],children:"Increased productivity and work quality"})]}),(0,K.jsxs)(E.default,{style:bt.benefitItem,children:[(0,K.jsx)(be.default,{name:"check-circle",size:18,color:a.colors.primary,style:bt.benefitIcon}),(0,K.jsx)(ne.default,{style:[bt.benefitText,{color:a.colors.text}],children:"Better planning and time estimation"})]}),(0,K.jsxs)(E.default,{style:bt.benefitItem,children:[(0,K.jsx)(be.default,{name:"check-circle",size:18,color:a.colors.primary,style:bt.benefitIcon}),(0,K.jsx)(ne.default,{style:[bt.benefitText,{color:a.colors.text}],children:"Reduced procrastination"})]})]}),(0,K.jsx)(ne.default,{style:[bt.infoSubtitle,{color:a.colors.text}],children:"Why use it?"}),(0,K.jsx)(ne.default,{style:[bt.infoText,{color:a.colors.text}],children:"The technique works with your brain's natural rhythms, leveraging focused work periods and regular breaks to maintain high productivity. By breaking work into manageable chunks, you can avoid burnout and maintain a sustainable pace throughout the day."})]})]})}),(0,K.jsx)(ve.default,{visible:b,transparent:!0,animationType:"slide",onRequestClose:()=>j(!1),children:(0,K.jsx)(E.default,{style:[bt.modalOverlay,{backgroundColor:s?"rgba(0,0,0,0.9)":"rgba(255,255,255,0.9)"}],children:(0,K.jsxs)(E.default,{style:[bt.taskSelectorModal,{backgroundColor:s?"#222":"#fff",shadowColor:s?"#000":"#888"}],children:[(0,K.jsxs)(E.default,{style:bt.modalHeader,children:[(0,K.jsx)(ne.default,{style:[bt.modalTitle,{color:a.colors.text}],children:"Select a Task"}),(0,K.jsx)(P.default,{style:bt.closeButton,onPress:()=>j(!1),children:(0,K.jsx)(be.default,{name:"close",size:24,color:a.colors.text})})]}),(0,K.jsx)(Ae.default,{style:bt.taskOptionsContainer,children:(()=>{const e=n.filter((e=>!e.completed));return 0===e.length?(0,K.jsx)(E.default,{style:bt.emptyTasksContainer,children:(0,K.jsx)(ne.default,{style:[bt.emptyTasksText,{color:a.colors.text}],children:"No active tasks available. Create a task first."})}):e.map((e=>(0,K.jsxs)(P.default,{style:[bt.taskOption,{backgroundColor:s?"#333":"#f5f5f5"},h===e.id&&{backgroundColor:s?"#2c3e50":"#e1f5fe",borderColor:a.colors.primary,borderWidth:1}],onPress:()=>{return t=e.id,y(t),j(!1),void(i.active||d(t));var t},children:[(0,K.jsx)(E.default,{style:[bt.priorityIndicator,{backgroundColor:"high"===e.priority?a.colors.error:"medium"===e.priority?a.colors.warning:a.colors.success}]}),(0,K.jsxs)(E.default,{style:bt.taskOptionContent,children:[(0,K.jsx)(ne.default,{style:[bt.taskTitle,{color:a.colors.text}],numberOfLines:1,children:e.title}),h===e.id&&(0,K.jsx)(E.default,{style:bt.selectedIndicator,children:(0,K.jsx)(be.default,{name:"check-circle",size:20,color:a.colors.primary})})]})]},e.id)))})()})]})})}),(0,K.jsx)(ve.default,{visible:k,transparent:!0,animationType:"fade",onRequestClose:()=>T(!1),children:(0,K.jsx)(E.default,{style:[bt.modalOverlay,{backgroundColor:s?"rgba(0,0,0,0.9)":"rgba(255,255,255,0.9)"}],children:(0,K.jsxs)(E.default,{style:[bt.interruptionDialog,{backgroundColor:s?"#222":"#fff",shadowColor:s?"#000":"#888"}],children:[(0,K.jsx)(ne.default,{style:[bt.dialogTitle,{color:a.colors.text}],children:"Stop Pomodoro Session?"}),(0,K.jsx)(ne.default,{style:[bt.dialogMessage,{color:a.colors.secondary||"#666"}],children:z?"Your focus session is still running. Why are you stopping?":"Do you want to close the timer?"}),z&&(0,K.jsx)(qe.default,{style:[bt.interruptionInput,{backgroundColor:s?"#333":"#f5f5f5",color:a.colors.text,borderColor:s?"#444":"#ddd"}],placeholder:"Note (optional)",placeholderTextColor:a.colors.placeholder||"#999",value:p,onChangeText:x,multiline:!0}),(0,K.jsxs)(E.default,{style:bt.dialogActions,children:[(0,K.jsx)(P.default,{style:[bt.dialogButton,{backgroundColor:s?"#333":"#f5f5f5"}],onPress:()=>T(!1),children:(0,K.jsx)(ne.default,{style:[bt.dialogButtonText,{color:a.colors.text}],children:"Cancel"})}),(0,K.jsx)(P.default,{style:[bt.dialogButton,{backgroundColor:a.colors.error}],onPress:z?()=>{f(!0,p),x(""),T(!1)}:X,children:(0,K.jsx)(ne.default,{style:[bt.dialogButtonText,{color:"#fff"}],children:z?"Stop":"Close"})})]})]})})})]})};var kt=o(97052);function Tt({task:e,onEdit:t,onDelete:o,onToggleCompletion:a,onToggleSubtask:s,onUpdate:n,onBack:i,onPomodoro:l,onAddComment:d,onShare:c}){const[u,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)(!1),[h,y]=(0,r.useState)(!1),{theme:p,isDark:x}=Z();return(0,K.jsxs)(E.default,{style:[Ct.container,{backgroundColor:p.colors.background}],children:[(0,K.jsxs)(E.default,{style:Ct.header,children:[(0,K.jsxs)(E.default,{style:Ct.headerLeft,children:[(0,K.jsx)(O.default,{icon:"arrow-left",size:24,onPress:i}),(0,K.jsx)(A.default,{style:[Ct.headerTitle,{color:p.colors.text}],children:"Task Details"})]}),(0,K.jsx)(E.default,{style:Ct.actionsContainer,children:(0,K.jsx)(O.default,{icon:"pencil",size:24,onPress:t})})]}),(0,K.jsxs)(Ae.default,{style:Ct.content,children:[(0,K.jsxs)(E.default,{style:Ct.titleContainer,children:[(0,K.jsx)(A.default,{style:[Ct.title,{color:p.colors.text}],children:e.title}),e.priority&&(0,K.jsxs)(ye.default,{style:[Ct.priorityBadge,{backgroundColor:(e=>{switch(e.toLowerCase()){case"high":return x?"#CF6679":"#D32F2F";case"medium":return x?"#FFDF5D":"#FFC107";default:return x?"#78939D":"#78909C"}})(e.priority)}],children:[(0,K.jsx)(be.default,{name:(e=>{switch(e.toLowerCase()){case"high":return"priority-high";case"medium":default:return"drag-handle";case"low":return"arrow-downward"}})(e.priority),size:16,color:"#fff",style:Ct.priorityIcon}),(0,K.jsx)(A.default,{style:Ct.priorityText,children:e.priority.toUpperCase()})]})]}),(0,K.jsxs)(E.default,{style:Ct.statusContainer,children:[(0,K.jsx)(z.default,{icon:e.completed?"check":"clock-outline",onPress:()=>a(e.id),style:[Ct.statusChip,{backgroundColor:e.completed?p.colors.success:p.colors.surfaceVariant}],textStyle:{color:e.completed?"#fff":p.colors.text},children:e.completed?"Completed":"Pending"}),e.completed&&e.updatedAt&&(0,K.jsxs)(A.default,{style:[Ct.completionDate,{color:p.colors.text}],children:["Completed ",(0,kt.formatDistanceToNow)(new Date(e.updatedAt),{addSuffix:!0})]})]}),(0,K.jsxs)(E.default,{style:Ct.quickActions,children:[(0,K.jsxs)(P.default,{style:Ct.quickAction,onPress:()=>a(e.id),children:[(0,K.jsx)(be.default,{name:e.completed?"check-box":"check-box-outline-blank",size:24,color:p.colors.primary}),(0,K.jsx)(A.default,{style:[Ct.quickActionText,{color:p.colors.text}],children:e.completed?"Mark Incomplete":"Mark Complete"})]}),l&&(0,K.jsxs)(P.default,{style:Ct.quickAction,onPress:()=>{f(!u),g(!1),l&&l()},children:[(0,K.jsx)(be.default,{name:"timer",size:24,color:p.colors.primary}),(0,K.jsx)(A.default,{style:[Ct.quickActionText,{color:p.colors.text}],children:"Start Focus"})]}),(0,K.jsxs)(P.default,{style:Ct.quickAction,onPress:t,children:[(0,K.jsx)(be.default,{name:"edit",size:24,color:p.colors.primary}),(0,K.jsx)(A.default,{style:[Ct.quickActionText,{color:p.colors.text}],children:"Edit Task"})]}),(0,K.jsxs)(P.default,{style:Ct.quickAction,onPress:()=>y(!0),children:[(0,K.jsx)(be.default,{name:"delete",size:24,color:p.colors.error}),(0,K.jsx)(A.default,{style:[Ct.quickActionText,{color:p.colors.error}],children:"Delete"})]})]}),e.description&&(0,K.jsxs)(E.default,{style:Ct.section,children:[(0,K.jsx)(A.default,{style:[Ct.sectionTitle,{color:p.colors.text}],children:"Description"}),(0,K.jsx)(A.default,{style:[Ct.description,{color:p.colors.text}],children:e.description})]}),u&&(0,K.jsx)(E.default,{style:Ct.pomodoroContainer,children:(0,K.jsx)(Xe,{initialTaskId:e.id,onMinimize:()=>f(!1)})}),(0,K.jsxs)(E.default,{style:Ct.section,children:[(0,K.jsx)(A.default,{style:[Ct.sectionTitle,{color:p.colors.text}],children:"Details"}),(0,K.jsxs)(E.default,{style:Ct.detailRow,children:[(0,K.jsx)(A.default,{style:[Ct.detailLabel,{color:p.colors.text}],children:"Created:"}),(0,K.jsx)(A.default,{style:[Ct.detailValue,{color:p.colors.text}],children:(0,xe.format)(new Date(e.createdAt),"PPP")})]}),e.dueDate&&(0,K.jsxs)(E.default,{style:Ct.detailRow,children:[(0,K.jsx)(A.default,{style:[Ct.detailLabel,{color:p.colors.text}],children:"Deadline:"}),(0,K.jsxs)(A.default,{style:[Ct.detailValue,{color:p.colors.text}],children:[(0,xe.format)(new Date(e.dueDate),"PPP")," ","(",(0,kt.formatDistanceToNow)(new Date(e.dueDate),{addSuffix:!0}),")"]})]}),e.dueTime&&(0,K.jsxs)(E.default,{style:Ct.detailRow,children:[(0,K.jsx)(A.default,{style:[Ct.detailLabel,{color:p.colors.text}],children:"Time:"}),(0,K.jsx)(A.default,{style:[Ct.detailValue,{color:p.colors.text}],children:(0,xe.format)(new Date(`2000-01-01T${e.dueTime}`),"h:mm a")})]}),e.location&&(0,K.jsxs)(E.default,{style:Ct.detailRow,children:[(0,K.jsx)(A.default,{style:[Ct.detailLabel,{color:p.colors.text}],children:"Location:"}),(0,K.jsx)(A.default,{style:[Ct.detailValue,{color:p.colors.text}],children:e.location})]}),e.tags&&e.tags.length>0&&(0,K.jsxs)(E.default,{style:Ct.detailRow,children:[(0,K.jsx)(A.default,{style:[Ct.detailLabel,{color:p.colors.text}],children:"Tags:"}),(0,K.jsx)(E.default,{style:Ct.tagsContainer,children:e.tags.map(((e,t)=>(0,K.jsx)(z.default,{style:[Ct.tagChip,{backgroundColor:p.colors.surfaceVariant}],textStyle:{color:p.colors.text},children:e},t)))})]})]}),e.subtasks&&e.subtasks.length>0&&(0,K.jsxs)(E.default,{style:Ct.section,children:[(0,K.jsxs)(E.default,{style:Ct.subtaskHeader,children:[(0,K.jsx)(A.default,{style:[Ct.sectionTitle,{color:p.colors.text}],children:"Sub-tasks"}),(0,K.jsxs)(A.default,{style:[Ct.subtaskProgress,{color:p.colors.text}],children:[e.subtasks.filter((e=>e.completed)).length," of ",e.subtasks.length," completed"]})]}),(0,K.jsx)(pe.default,{progress:(()=>{if(!e.subtasks||0===e.subtasks.length)return 0;return e.subtasks.filter((e=>e.completed)).length/e.subtasks.length})(),color:p.colors.primary,style:Ct.progressBar}),(0,K.jsx)(st,{taskId:e.id,subtasks:e.subtasks,onChange:t=>{n(Object.assign({},e,{subtasks:t}))}})]}),e.pomodoroSessions&&e.pomodoroSessions.length>0&&(0,K.jsxs)(E.default,{style:Ct.section,children:[(0,K.jsx)(A.default,{style:[Ct.sectionTitle,{color:p.colors.text}],children:"Pomodoro Sessions"}),(0,K.jsxs)(E.default,{style:Ct.pomodoroStats,children:[(0,K.jsxs)(E.default,{style:Ct.statItem,children:[(0,K.jsx)(A.default,{style:[Ct.statValue,{color:p.colors.primary}],children:e.completedPomodoros||0}),(0,K.jsx)(A.default,{style:[Ct.statLabel,{color:p.colors.text}],children:"Completed"})]}),(0,K.jsxs)(E.default,{style:Ct.statItem,children:[(0,K.jsxs)(A.default,{style:[Ct.statValue,{color:p.colors.text}],children:[Math.round((e.totalPomodoroTime||0)/60),"h"]}),(0,K.jsx)(A.default,{style:[Ct.statLabel,{color:p.colors.text}],children:"Total Time"})]})]})]}),e.notes&&e.notes.length>0&&(0,K.jsxs)(E.default,{style:Ct.section,children:[(0,K.jsx)(A.default,{style:[Ct.sectionTitle,{color:p.colors.text}],children:"Notes"}),e.notes.map(((e,t)=>(0,K.jsxs)(ye.default,{style:[Ct.noteCard,{backgroundColor:p.colors.surfaceVariant}],children:[(0,K.jsx)(A.default,{style:[Ct.noteText,{color:p.colors.text}],children:e.content}),(0,K.jsx)(A.default,{style:[Ct.noteDate,{color:p.colors.text}],children:(0,xe.format)(new Date(e.createdAt.toString()),"PPP")})]},t)))]})]}),(0,K.jsx)(M.default,{children:(0,K.jsxs)(W.default,{visible:h,onDismiss:()=>y(!1),contentContainerStyle:[Ct.deleteModal,{backgroundColor:p.colors.surface}],children:[(0,K.jsx)(A.default,{style:[Ct.deleteTitle,{color:p.colors.text}],children:"Delete Task"}),(0,K.jsx)(A.default,{style:[Ct.deleteMessage,{color:p.colors.text}],children:"Are you sure you want to delete this task? This action cannot be undone."}),(0,K.jsxs)(E.default,{style:Ct.deleteActions,children:[(0,K.jsx)(H.default,{mode:"outlined",onPress:()=>y(!1),style:Ct.deleteButton,children:"Cancel"}),(0,K.jsx)(H.default,{mode:"contained",onPress:()=>{y(!1),g(!1),y(!0),o()},style:[Ct.deleteButton,{backgroundColor:p.colors.error}],children:"Delete"})]})]})})]})}const Ct=B.default.create({container:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:"rgba(0,0,0,0.1)"},headerLeft:{flexDirection:"row",alignItems:"center"},headerTitle:{fontSize:20,fontWeight:"bold",marginLeft:8},actionsContainer:{flexDirection:"row",alignItems:"center"},content:{flex:1,padding:16},titleContainer:{flexDirection:"row",alignItems:"center",marginBottom:16},title:{fontSize:24,fontWeight:"bold",flex:1},priorityBadge:{flexDirection:"row",alignItems:"center",paddingHorizontal:8,paddingVertical:4,borderRadius:4,marginLeft:8},priorityIcon:{marginRight:4},priorityText:{color:"#fff",fontWeight:"bold",fontSize:12},statusContainer:{flexDirection:"row",alignItems:"center",marginBottom:24},statusChip:{marginRight:8},completionDate:{fontSize:14,opacity:.7},quickActions:{flexDirection:"row",justifyContent:"space-around",marginBottom:24,paddingVertical:16,borderBottomWidth:1,borderBottomColor:"rgba(0,0,0,0.1)"},quickAction:{alignItems:"center"},quickActionText:{marginTop:4,fontSize:12},section:{marginBottom:24},sectionTitle:{fontSize:16,fontWeight:"bold",marginBottom:8},description:{fontSize:16,lineHeight:24},pomodoroContainer:{marginBottom:16},detailRow:{flexDirection:"row",alignItems:"center",marginBottom:8},detailLabel:{fontSize:16,fontWeight:"bold",width:100},detailValue:{fontSize:16,flex:1},tagsContainer:{flexDirection:"row",flexWrap:"wrap",flex:1},tagChip:{marginRight:8,marginBottom:8},subtaskHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},subtaskProgress:{fontSize:14,opacity:.7},progressBar:{height:4,borderRadius:2,marginBottom:16},pomodoroStats:{flexDirection:"row",justifyContent:"space-around",marginTop:16},statItem:{alignItems:"center"},statValue:{fontSize:24,fontWeight:"bold"},statLabel:{fontSize:14,opacity:.7},noteCard:{padding:16,borderRadius:8,marginBottom:8},noteText:{fontSize:16,marginBottom:8},noteDate:{fontSize:12,opacity:.7},deleteModal:{margin:20,padding:20,borderRadius:8},deleteTitle:{fontSize:20,fontWeight:"bold",marginBottom:16},deleteMessage:{fontSize:16,marginBottom:24},deleteActions:{flexDirection:"row",justifyContent:"flex-end"},deleteButton:{marginLeft:8}}),wt=B.default.create({container:{flex:1},content:{flex:1,padding:4},searchContainer:{marginBottom:12},searchBar:{elevation:2,borderRadius:12},controlsContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},filterContainer:{flexDirection:"row",alignItems:"center"},filterButton:{padding:8,marginLeft:4},filterButtonContent:{position:"relative"},filterBadge:{position:"absolute",top:-6,right:-6,backgroundColor:"red",borderRadius:10,width:20,height:20,justifyContent:"center",alignItems:"center"},filterBadgeText:{color:"white",fontSize:12,fontWeight:"bold"},filterMenu:{marginTop:50,marginRight:10},filterChipsContainer:{marginBottom:12},chipScrollContainer:{flexDirection:"row",flexWrap:"wrap",alignItems:"center"},filterChip:{marginRight:8,marginBottom:8},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyText:{fontSize:20,fontWeight:"600",marginTop:16,marginBottom:8},emptySubtext:{fontSize:16,opacity:.7,marginBottom:24,textAlign:"center"},createButton:{marginTop:8},modalContent:{flex:1,margin:0},datePickerRow:{flexDirection:"row",alignItems:"center",marginBottom:8},dateButton:{flex:1,marginLeft:8},gridList:{padding:4},gridItem:{flex:1,padding:4},gridCard:{margin:0,height:160},gridCardContent:{padding:12},gridHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},gridTitleContainer:{flex:1,marginRight:8},gridTitle:{fontSize:14,fontWeight:"600",marginBottom:4},gridDescription:{fontSize:12,opacity:.7,marginBottom:8},gridFooter:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginTop:"auto"},gridDateContainer:{flexDirection:"row",alignItems:"center"},gridDate:{fontSize:12,marginLeft:4},gridTagsContainer:{flexDirection:"row",alignItems:"center"},gridTags:{fontSize:12,marginLeft:4},priorityBadge:{paddingHorizontal:6,paddingVertical:2,borderRadius:4,alignSelf:"flex-start"},priorityText:{fontSize:10,color:"#fff",textTransform:"capitalize"},gridCheckButton:{margin:0,padding:0},pomodoroContainer:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:100}}),St=()=>{const e=(0,d.useNavigation)(),t=(0,R.useTheme)(),{colors:o}=(t.dark,t),{tasks:a,isLoading:s,fetchTasks:n,addTask:i,updateTask:l,deleteTask:c,toggleTaskCompletion:u,toggleSubtask:f}=he(),[m,g]=(0,r.useState)("list"),[h,y]=(0,r.useState)(""),[p,x]=(0,r.useState)({status:[],priority:[],dueDateRange:{},tags:[]}),[b,j]=(0,r.useState)("dueDate"),[k,T]=(0,r.useState)("asc"),[C,w]=(0,r.useState)(!1),[S,D]=(0,r.useState)(!1),[I,v]=(0,r.useState)(void 0),[B,U]=(0,r.useState)(!1),[$,G]=(0,r.useState)(!1),[X,q]=(0,r.useState)(!1),[_,Y]=(0,r.useState)(!1),[Q,J]=(0,r.useState)(!1),[Z,ee]=(0,r.useState)(!1),[te,oe]=(0,r.useState)(null),[re,se]=(0,r.useState)(null),[ne,ie]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{console.log("Loading tasks on component mount (single useEffect)..."),x({status:[],priority:[],dueDateRange:{},tags:[]}),y(""),g("list"),await n(),console.log(`Total number of tasks in database: ${a.length}`),a.forEach(((e,t)=>{console.log(`Task ${t+1}: ID=${e.id}, Title=${e.title}, Completed=${e.completed}`)}))}catch(Pr){console.error("Error loading tasks:",Pr)}})()}),[]),(0,r.useEffect)((()=>{console.log("Filter menu state updated:",B)}),[B]);const le=e=>{const t=a.find((t=>t.id===e));t&&(se(t),ie(!0))},de=e=>{v(e),D(!0)},ce=async e=>{console.log("TasksScreen - handleToggleCompletion called with taskId:",e);try{const t=a.find((t=>t.id===e));if(t){console.log("Found task:",t.id,t.title,"Current completed status:",t.completed);const e=Object.assign({},t,{completed:!t.completed});await l(e),console.log("Task completion toggled successfully"),await n()}else console.error("Task not found with ID:",e)}catch(Pr){console.error("Error toggling task completion:",Pr)}},ue=async e=>{try{console.log("Creating new task with data:",e);const t=Object.assign({},e,{title:e.title||"Untitled Task",priority:e.priority||"medium",completed:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});console.log("Creating task with complete data:",t);const o=await i(t);if(!o)throw new Error("Failed to create task");return console.log("New task created successfully:",o.id),w(!1),console.log(`Current task count after creation: ${a.length+1}`),o}catch(Pr){throw console.error("Error creating task:",Pr),Pr}},fe=(e,t)=>{x((o=>{const r=[...o[e]||[]],a=r.indexOf(t);return a>=0?r.splice(a,1):r.push(t),Object.assign({},o,{[e]:r})}))},me=(e,t)=>p[e]?.includes(t)||!1,ge=()=>{x({status:[],priority:[],dueDateRange:{},tags:[]}),y("")},ye=(0,r.useMemo)((()=>{console.log(`Starting filtering with ${a.length} total tasks`);let e=[...a];console.log(`Initial task count: ${e.length}`);const t=e.length;if(e=e.filter((e=>null!==e&&void 0!==e)),e.forEach(((e,t)=>{e.id||(console.log(`Assigning temporary ID to task: ${e.title}`),e.id=`temp-${Date.now()}-${t}`)})),console.log(`After null check: ${e.length} tasks (removed ${t-e.length})`),h.trim()){const t=e.length,o=h.toLowerCase();console.log(`Searching for: "${o}"`),e.forEach((e=>{const t=e.title.toLowerCase().includes(o),r=e.description&&e.description.toLowerCase().includes(o);console.log(`Task ${e.id}: "${e.title}" - Title match: ${t}, Desc match: ${r}`)})),e=e.filter((e=>e.title.toLowerCase().includes(o)||e.description&&e.description.toLowerCase().includes(o))),console.log(`After search filter: ${e.length} tasks (removed ${t-e.length})`)}if(p.status&&p.status.length>0){const t=e.length;e=e.filter((e=>!(!p.status?.includes("completed")||!e.completed)||!(!p.status?.includes("pending")||e.completed))),console.log(`After status filter: ${e.length} tasks (removed ${t-e.length})`)}if(p.priority&&p.priority.length>0){const t=e.length;e=e.filter((e=>p.priority?.includes(e.priority||"medium"))),console.log(`After priority filter: ${e.length} tasks (removed ${t-e.length})`)}if(p.dueDateRange?.start||p.dueDateRange?.end){const t=e.length;e=e.filter((e=>{if(!e.dueDate)return!1;const t=new Date(e.dueDate),o=!p.dueDateRange?.start||t>=new Date(p.dueDateRange.start),r=!p.dueDateRange?.end||t<=new Date(p.dueDateRange.end);return o&&r})),console.log(`After date range filter: ${e.length} tasks (removed ${t-e.length})`)}if(p.tags&&p.tags.length>0){const t=e.length;e=e.filter((e=>{const t=e.tags;return t&&Array.isArray(t)&&t.some((e=>p.tags?.includes(e)))})),console.log(`After tag filter: ${e.length} tasks (removed ${t-e.length})`)}e.length;return e.sort(((e,t)=>{if("priority"===b){const o={high:3,medium:2,low:1},r=e.priority&&o[e.priority]||0,a=t.priority&&o[t.priority]||0;return"asc"===k?r-a:a-r}if("dueDate"===b){const o=e.dueDate?new Date(e.dueDate).getTime():0,r=t.dueDate?new Date(t.dueDate).getTime():0;return"asc"===k?o-r:r-o}{const o=e.createdAt?new Date(e.createdAt).getTime():0,r=t.createdAt?new Date(t.createdAt).getTime():0;return"asc"===k?o-r:r-o}})),console.log(`After sorting: ${e.length} tasks (should be same as before)`),console.log(`Final filtered task count: ${e.length}`),e}),[a,b,k,p,h]),pe=()=>{let e=0;return p.status?.length&&(e+=p.status.length),p.priority?.length&&(e+=p.priority.length),(p.dueDateRange?.start||p.dueDateRange?.end)&&e++,p.tags?.length&&(e+=p.tags.length),e},xe=async e=>{oe(e),ee(!0)},be=e=>e?e.toLocaleDateString():"Select Date",je=async()=>{try{console.log("Force displaying all tasks (manual refresh)..."),x({status:[],priority:[],dueDateRange:{},tags:[]}),y(""),g("list"),await n(),console.log(`Database has ${a.length} tasks total`),console.log(`Filtered tasks count: ${ye.length}`),console.log(`Difference: ${a.length-ye.length} tasks are being filtered out`),console.log(`Current search query: "${h}"`),console.log("Current filters:",JSON.stringify(p))}catch(Pr){console.error("Error displaying all tasks:",Pr)}};(0,r.useEffect)((()=>{je()}),[]);const ke=()=>{console.log("=== DEBUG TASK FILTERING ==="),console.log(`Database has ${a.length} total tasks`),console.log(`${ye.length} tasks after filtering`),console.log(`Current search query: "${h}"`),console.log("Current filters:",p);const e=a.map((e=>e.id)),t=ye.map((e=>e.id)),o=e.filter((e=>!t.includes(e)));console.log(`Missing task IDs: ${o.join(", ")}`),o.forEach((e=>{const t=a.find((t=>t.id===e));console.log(`Missing task: ID=${e}, Title=${t?.title}, Priority=${t?.priority}, Completed=${t?.completed}`);const o=t;t?.id||console.log("- Missing ID"),t?.title||console.log("- Missing title"),o.tags&&0===o.tags.length&&console.log("- Empty tags array")})),console.log("=== END DEBUG ===")};(0,r.useEffect)((()=>{const e=setTimeout(ke,500);return()=>clearTimeout(e)}),[a,ye.length]);return(0,K.jsxs)(E.default,{style:wt.container,children:[(0,K.jsxs)(E.default,{style:wt.content,children:[(0,K.jsx)(E.default,{style:wt.searchContainer,children:(0,K.jsx)(L.default,{placeholder:"Search tasks...",onChangeText:y,value:h,style:wt.searchBar,iconColor:o.primary,inputStyle:{color:o.onSurface}})}),(0,K.jsxs)(E.default,{style:wt.controlsContainer,children:[(0,K.jsx)(ae,{mode:m,onToggle:g}),(0,K.jsxs)(E.default,{style:wt.filterContainer,children:[(0,K.jsx)(O.default,{icon:"asc"===k?"sort-ascending":"sort-descending",size:24,onPress:()=>{T((e=>"asc"===e?"desc":"asc"))}}),(0,K.jsxs)(N.default,{visible:$,onDismiss:()=>G(!1),anchor:(0,K.jsx)(O.default,{icon:"sort",size:24,onPress:()=>G(!0)}),children:[(0,K.jsx)(N.default.Item,{onPress:()=>{j("priority"),G(!1)},title:"Sort by Priority",leadingIcon:"flag"}),(0,K.jsx)(N.default.Item,{onPress:()=>{j("dueDate"),G(!1)},title:"Sort by Due Date",leadingIcon:"calendar"}),(0,K.jsx)(N.default.Item,{onPress:()=>{j("createdAt"),G(!1)},title:"Sort by Created Date",leadingIcon:"clock"})]}),(0,K.jsx)(P.default,{style:wt.filterButton,onPress:()=>{console.log("Filter button pressed"),U(!B)},children:(0,K.jsxs)(E.default,{style:wt.filterButtonContent,children:[(0,K.jsx)(Ee.default,{name:"filter-variant",size:24,color:o.primary}),pe()>0&&(0,K.jsx)(E.default,{style:wt.filterBadge,children:(0,K.jsx)(A.default,{style:wt.filterBadgeText,children:pe()})})]})}),(0,K.jsx)(O.default,{icon:"refresh",size:24,onPress:je}),(0,K.jsx)(O.default,{icon:"bug",size:24,onPress:async()=>{try{console.log("Debug task creation test - Starting");const e={title:"Debug Test Task "+(new Date).toLocaleTimeString(),description:"Created for debugging",priority:"medium",completed:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};console.log("Creating test task:",e),await ue(e),console.log("Debug task creation test - Completed")}catch(Pr){console.error("Error in debug task creation:",Pr)}}}),(0,K.jsx)(E.default,{style:{backgroundColor:a.length!==ye.length?"red":"green",padding:8,borderRadius:4,marginLeft:8},children:(0,K.jsxs)(A.default,{style:{color:"white",fontWeight:"bold"},children:[ye.length,"/",a.length]})}),(0,K.jsxs)(N.default,{visible:B,onDismiss:()=>{console.log("Dismissing filter menu"),U(!1)},anchor:(0,K.jsx)(E.default,{style:{width:1,height:1}}),style:wt.filterMenu,children:[(0,K.jsx)(N.default.Item,{onPress:()=>fe("status","pending"),title:"Pending Tasks",leadingIcon:"clock-outline",trailingIcon:me("status","pending")?"check":void 0}),(0,K.jsx)(N.default.Item,{onPress:()=>fe("status","completed"),title:"Completed Tasks",leadingIcon:"check-circle",trailingIcon:me("status","completed")?"check":void 0}),(0,K.jsx)(F.default,{}),(0,K.jsx)(N.default.Item,{onPress:()=>fe("priority","high"),title:"High Priority",leadingIcon:"arrow-up",trailingIcon:me("priority","high")?"check":void 0}),(0,K.jsx)(N.default.Item,{onPress:()=>fe("priority","medium"),title:"Medium Priority",leadingIcon:"minus",trailingIcon:me("priority","medium")?"check":void 0}),(0,K.jsx)(N.default.Item,{onPress:()=>fe("priority","low"),title:"Low Priority",leadingIcon:"arrow-down",trailingIcon:me("priority","low")?"check":void 0}),(0,K.jsx)(F.default,{}),(0,K.jsx)(N.default.Item,{onPress:()=>{U(!1),q(!0)},title:"Date Range",leadingIcon:"calendar-range",trailingIcon:p.dueDateRange?.start||p.dueDateRange?.end?"check":void 0}),(0,K.jsx)(F.default,{}),(0,K.jsx)(N.default.Item,{onPress:()=>{ge(),U(!1)},title:"Reset All Filters",leadingIcon:"filter-remove"})]})]})]}),0===pe()?null:(0,K.jsx)(E.default,{style:wt.filterChipsContainer,children:(0,K.jsxs)(E.default,{style:wt.chipScrollContainer,children:[p.status?.map((e=>(0,K.jsx)(z.default,{style:wt.filterChip,onClose:()=>fe("status",e),icon:"completed"===e?"check-circle":"clock-outline",children:"completed"===e?"Completed":"Pending"},`status-${e}`))),p.priority?.map((e=>(0,K.jsxs)(z.default,{style:wt.filterChip,onClose:()=>fe("priority",e),icon:"high"===e?"arrow-up":"medium"===e?"minus":"arrow-down",children:[e.charAt(0).toUpperCase()+e.slice(1)," Priority"]},`priority-${e}`))),(p.dueDateRange?.start||p.dueDateRange?.end)&&(0,K.jsx)(z.default,{style:wt.filterChip,onClose:()=>x((e=>Object.assign({},e,{dueDateRange:{}}))),icon:"calendar-range",children:"Date Filter"},"date-range"),p.tags?.map((e=>(0,K.jsx)(z.default,{style:wt.filterChip,onClose:()=>x((t=>Object.assign({},t,{tags:t.tags?.filter((t=>t!==e))}))),icon:"tag",children:e},`tag-${e}`))),(0,K.jsx)(z.default,{style:wt.filterChip,onPress:ge,icon:"filter-remove",children:"Reset All"},"reset")]})}),(()=>{if(0===ye.length)return(0,K.jsx)(E.default,{style:wt.emptyContainer,children:(0,K.jsx)(A.default,{style:[wt.emptyText,{color:t.colors.onSurface}],children:"No tasks found"})});switch(m){case"grid":return(0,K.jsx)(Pe,{tasks:ye,onTaskPress:le,onToggleCompletion:ce,onDelete:xe,onStartPomodoro:de});case"timeline":return(0,K.jsx)(He,{tasks:ye,onTaskPress:le,onToggleCompletion:ce,onStartPomodoro:de});default:return(0,K.jsx)(Se,{tasks:ye,onTaskPress:le,onToggle:ce,onDelete:xe,onStartPomodoro:de})}})()]}),(0,K.jsxs)(M.default,{children:[(0,K.jsx)(W.default,{visible:C,onDismiss:()=>w(!1),contentContainerStyle:wt.modalContent,children:(0,K.jsx)(ht,{isVisible:C,onClose:()=>w(!1),onSave:ue})}),(0,K.jsx)(W.default,{visible:S,onDismiss:()=>D(!1),contentContainerStyle:wt.modalContent,children:(0,K.jsx)(Xe,{initialTaskId:I,onMinimize:()=>D(!1)})}),(0,K.jsxs)(V.default,{visible:X,onDismiss:()=>q(!1),children:[(0,K.jsx)(V.default.Title,{children:"Filter by Date Range"}),(0,K.jsx)(V.default.Content,{children:(0,K.jsxs)(E.default,{style:{gap:16},children:[(0,K.jsxs)(E.default,{style:wt.datePickerRow,children:[(0,K.jsx)(A.default,{children:"Start Date: "}),(0,K.jsx)(H.default,{mode:"outlined",onPress:()=>Y(!0),style:wt.dateButton,children:be(p.dueDateRange?.start)}),_&&(0,K.jsx)(Ze.default,{value:p.dueDateRange?.start||new Date,mode:"date",display:"default",onChange:(e,t)=>{Y(!1),t&&x((e=>Object.assign({},e,{dueDateRange:Object.assign({},e.dueDateRange,{start:t})})))}})]}),(0,K.jsxs)(E.default,{style:wt.datePickerRow,children:[(0,K.jsx)(A.default,{children:"End Date: "}),(0,K.jsx)(H.default,{mode:"outlined",onPress:()=>J(!0),style:wt.dateButton,children:be(p.dueDateRange?.end)}),Q&&(0,K.jsx)(Ze.default,{value:p.dueDateRange?.end||new Date,mode:"date",display:"default",onChange:(e,t)=>{J(!1),t&&x((e=>Object.assign({},e,{dueDateRange:Object.assign({},e.dueDateRange,{end:t})})))}})]})]})}),(0,K.jsxs)(V.default.Actions,{children:[(0,K.jsx)(H.default,{onPress:()=>x((e=>Object.assign({},e,{dueDateRange:{}}))),style:{marginRight:8},children:"Clear"}),(0,K.jsx)(H.default,{onPress:()=>q(!1),children:"Cancel"}),(0,K.jsx)(H.default,{onPress:()=>q(!1),mode:"contained",children:"Apply"})]})]}),(0,K.jsxs)(V.default,{visible:Z,onDismiss:()=>ee(!1),children:[(0,K.jsx)(V.default.Title,{children:"Delete Task"}),(0,K.jsx)(V.default.Content,{children:(0,K.jsx)(A.default,{children:"Are you sure you want to delete this task? This action cannot be undone."})}),(0,K.jsxs)(V.default.Actions,{children:[(0,K.jsx)(H.default,{onPress:()=>ee(!1),children:"Cancel"}),(0,K.jsx)(H.default,{onPress:async()=>{if(te)try{console.log("Deleting task:",te),await c(te),console.log("Task deleted successfully")}catch(Pr){console.error("Error deleting task:",Pr)}finally{ee(!1),oe(null)}},mode:"contained",buttonColor:o.error,children:"Delete"})]})]}),(0,K.jsx)(W.default,{visible:ne&&null!==re,onDismiss:()=>ie(!1),contentContainerStyle:wt.modalContent,children:re&&(0,K.jsx)(Tt,{task:re,onEdit:()=>{ie(!1),e.navigate("EditTask",{taskId:re.id})},onDelete:async e=>{await c(e),ie(!1),se(null)},onToggleCompletion:async e=>{await u(e),re&&se(Object.assign({},re,{completed:!re.completed}))},onToggleSubtask:async(e,t)=>{if(await f(e,t),re&&re.subtasks){const e=re.subtasks.map((e=>e.id===t?Object.assign({},e,{completed:!e.completed}):e));se(Object.assign({},re,{subtasks:e}))}},onUpdate:e=>{l(e),se(e)},onBack:()=>ie(!1)})})]}),S&&(0,K.jsx)(E.default,{style:wt.pomodoroContainer,children:(0,K.jsx)(jt,{initialTaskId:I,onClose:()=>D(!1),showCloseButton:!0})})]})};var Dt=o(56662),It=o(52576),vt=o(95166),Et=o(25060),Bt=o(55724),Pt=o(31859),Rt=o(92667),At=o(72369);function zt({tasks:e,onTaskPress:t,onToggleCompletion:o,onAddTask:a}){const{theme:s,isDark:n}=Z(),{tasks:i}=he(),[l,d]=(0,r.useState)((0,xe.format)(new Date,"yyyy-MM-dd")),[c,u]=(0,r.useState)({}),[f,m]=(0,r.useState)([]),[g,h]=(0,r.useState)((0,xe.format)(new Date,"yyyy-MM")),[y,p]=(0,r.useState)(!1),[x]=(0,r.useState)(new Te.default.Value(350)),[b,j]=(0,r.useState)({}),[k,T]=(0,r.useState)("month"),[C,w]=(0,r.useState)((0,It.startOfWeek)(new Date)),[S]=(0,r.useState)(new Te.default.Value(1)),[D,I]=(0,r.useState)(!1),[v,B]=(0,r.useState)(null),[R,A]=(0,r.useState)(null);(0,r.useEffect)((()=>{"week"===k&&w((0,It.startOfWeek)(new Date(l)))}),[k,l]),(0,r.useEffect)((()=>{const e={},t={};i.forEach((e=>{if(e.dueDate)try{const o=(0,xe.format)(new Date(e.dueDate),"yyyy-MM-dd");t[o]||(t[o]={high:0,medium:0,low:0}),t[o][e.priority]++}catch(Pr){console.error("Error processing task date:",Pr)}})),Object.entries(t).forEach((([t,o])=>{const r=[];o.high>0&&r.push({key:"high",color:s.colors.error}),o.medium>0&&r.push({key:"medium",color:s.colors.warning}),o.low>0&&r.push({key:"low",color:s.colors.success}),e[t]={marked:!0,dots:r}})),e[l]=Object.assign({},e[l],{selected:!0,selectedColor:s.colors.primary+"40"}),u(e)}),[i,l,s]),(0,r.useEffect)((()=>{const e=[...i.filter((e=>{if(!e.dueDate)return!1;try{const t=new Date(e.dueDate);return!isNaN(t.getTime())&&(0,xe.format)(t,"yyyy-MM-dd")===l}catch(Pr){return console.error("Error comparing task date:",Pr),!1}}))].sort(((e,t)=>{if(e.completed&&!t.completed)return 1;if(!e.completed&&t.completed)return-1;const o={high:0,medium:1,low:2},r=o[e.priority]-o[t.priority];return 0!==r?r:e.title.localeCompare(t.title)}));m(e)}),[i,l]),(0,r.useEffect)((()=>{const e=(0,Bt.startOfMonth)(new Date(g+"-01")),t=(0,Pt.endOfMonth)(e),o=(0,Rt.eachDayOfInterval)({start:e,end:t}),r={};o.forEach((e=>{const t=(0,xe.format)(e,"yyyy-MM-dd");r[t]=[]})),i.forEach((e=>{if(e.dueDate)try{const t=(0,xe.format)(new Date(e.dueDate),"yyyy-MM-dd");r[t]&&r[t].push(e)}catch(Pr){console.error("Error processing task date for week view:",Pr)}})),Object.keys(r).forEach((e=>{r[e].sort(((e,t)=>{if(e.completed&&!t.completed)return 1;if(!e.completed&&t.completed)return-1;const o={high:0,medium:1,low:2},r=o[e.priority]-o[t.priority];return 0!==r?r:e.title.localeCompare(t.title)}))})),j(r)}),[i,g]);const L=e=>{d(e.dateString)},W=e=>{const t=new Date(e);return(0,Le.isToday)(t)?"Today, "+(0,xe.format)(t,"MMMM d, yyyy"):(0,xe.format)(t,"EEEE, MMMM d, yyyy")},V=()=>{a&&a(l)},H=({item:e})=>{const r={high:s.colors.error,medium:s.colors.warning,low:s.colors.success};return(0,K.jsx)(P.default,{style:[Lt.taskItem,{backgroundColor:s.colors.surface}],onPress:()=>{console.log("Task item pressed:",e.id),t&&t(e.id)},children:(0,K.jsxs)(E.default,{style:Lt.taskContent,children:[(0,K.jsxs)(E.default,{style:Lt.taskHeader,children:[(0,K.jsx)(ne.default,{style:[Lt.taskTitle,{color:s.colors.text}],numberOfLines:1,children:e.title}),(0,K.jsxs)(E.default,{style:Lt.taskActions,children:[(0,K.jsx)(O.default,{icon:"pencil",size:20,onPress:()=>{console.log("Edit button pressed for task:",e.id),t&&t(e.id)}}),(0,K.jsx)(O.default,{icon:"dots-vertical",size:20,onPress:t=>{console.log("Menu button pressed for task:",e.id),B(e.id),I(!0);const{pageX:o,pageY:r}=t.nativeEvent;A({x:o,y:r})}})]})]}),e.description&&(0,K.jsx)(ne.default,{style:[Lt.taskDescription,{color:s.colors.text+"80"}],numberOfLines:2,children:e.description}),(0,K.jsxs)(E.default,{style:Lt.taskFooter,children:[(0,K.jsx)(z.default,{icon:e.completed?"check":"clock-outline",onPress:()=>{console.log("Toggle completion for task:",e.id),o&&o(e.id)},style:[Lt.statusChip,{backgroundColor:e.completed?s.colors.success:s.colors.surfaceVariant}],textStyle:{color:e.completed?"#fff":s.colors.text},children:e.completed?"Completed":"Pending"}),(0,K.jsx)(E.default,{style:[Lt.priorityIndicator,{backgroundColor:"transparent"}],children:(0,K.jsx)(be.default,{name:"high"===e.priority?"priority-high":"medium"===e.priority?"drag-handle":"arrow-downward",size:20,color:r[e.priority]})})]})]})},e.id)},U=()=>{const e=(0,At.endOfWeek)(C);return(0,Rt.eachDayOfInterval)({start:C,end:e})},$=e=>{e!==k&&Te.default.timing(S,{toValue:0,duration:150,useNativeDriver:!0}).start((()=>{T(e),Te.default.timing(S,{toValue:1,duration:150,useNativeDriver:!0}).start()}))},G=e=>{const r={high:s.colors.error,medium:s.colors.warning,low:s.colors.success};return(0,K.jsxs)(P.default,{style:[Lt.timelineTask,{backgroundColor:s.colors.surface,borderLeftColor:r[e.priority],opacity:e.completed?.7:1}],onPress:()=>t&&t(e.id),children:[(0,K.jsx)(ne.default,{style:[Lt.timelineTaskTitle,{color:s.colors.text,textDecorationLine:e.completed?"line-through":"none"}],numberOfLines:1,children:e.title}),(0,K.jsxs)(E.default,{style:Lt.timelineTaskActions,children:[(0,K.jsx)(be.default,{name:"high"===e.priority?"priority-high":"medium"===e.priority?"drag-handle":"arrow-downward",size:16,color:r[e.priority],style:{marginRight:8}}),(0,K.jsx)(P.default,{style:[Lt.timelineCheckbox,{borderColor:s.colors.outline||s.colors.text+"40"},e.completed&&{backgroundColor:s.colors.success}],onPress:()=>{return t=e.id,void(o&&o(t));var t},children:e.completed&&(0,K.jsx)(be.default,{name:"done",size:12,color:"#fff"})})]})]},e?.id||`task-${Math.random().toString(36)}`)};return(0,K.jsxs)(E.default,{style:Lt.container,children:["today"!==k&&"timeline"!==k&&(0,K.jsxs)(E.default,{style:Lt.calendarHeader,children:[(0,K.jsx)(P.default,{onPress:()=>{if("week"===k){const e=(0,vt.subWeeks)(C,1);w(e),d((0,xe.format)(e,"yyyy-MM-dd")),h((0,xe.format)(e,"yyyy-MM"))}else if("month"===k||"timeline"===k){const e=(0,Et.subMonths)(new Date(g+"-01"),1),t=(0,xe.format)(e,"yyyy-MM");h(t),d(t+"-01")}else if("year"===k){const e=(parseInt(g.split("-")[0])-1).toString(),t=g.split("-")[1];h(`${e}-${t}`)}},children:(0,K.jsx)(be.default,{name:"chevron-left",size:24,color:s.colors.text})}),(0,K.jsx)(P.default,{onPress:()=>{$("year"!==k?"year":"month")},children:(0,K.jsxs)(ne.default,{style:[Lt.currentMonthText,{color:s.colors.text}],children:["week"===k?`${(0,xe.format)(C,"MMM d")} - ${(0,xe.format)((0,At.endOfWeek)(C),"MMM d, yyyy")}`:(0,xe.format)(new Date(g+"-01"),"MMMM yyyy"),"month"===k&&(0,K.jsx)(be.default,{name:y?"expand-less":"expand-more",size:18,color:s.colors.text,style:{marginLeft:4}})]})}),(0,K.jsx)(P.default,{onPress:()=>{if("week"===k){const e=(0,et.addWeeks)(C,1);w(e),d((0,xe.format)(e,"yyyy-MM-dd")),h((0,xe.format)(e,"yyyy-MM"))}else if("month"===k||"timeline"===k){const e=(0,tt.addMonths)(new Date(g+"-01"),1),t=(0,xe.format)(e,"yyyy-MM");h(t),d(t+"-01")}else if("year"===k){const e=(parseInt(g.split("-")[0])+1).toString(),t=g.split("-")[1];h(`${e}-${t}`)}},children:(0,K.jsx)(be.default,{name:"chevron-right",size:24,color:s.colors.text})})]}),(0,K.jsx)(Te.default.View,{style:{flex:1,opacity:S,marginBottom:0},children:(()=>{switch(k){case"year":return(0,K.jsx)(E.default,{style:Lt.yearViewContainer,children:(0,K.jsxs)(Ae.default,{showsVerticalScrollIndicator:!1,children:[(0,K.jsx)(ne.default,{style:[Lt.yearTitle,{color:s.colors.text}],children:(0,xe.format)(new Date(g+"-01"),"yyyy")}),(0,K.jsx)(E.default,{style:Lt.yearMonthsGrid,children:Array.from({length:12},((e,t)=>{const o=new Date(parseInt(g.split("-")[0]),t,1),r=(0,xe.format)(o,"MMM"),a=(0,xe.format)(o,"yyyy-MM"),n=t===(new Date).getMonth()&&parseInt(g.split("-")[0])===(new Date).getFullYear(),i=a===g;return(0,K.jsx)(P.default,{style:[Lt.yearMonth,n&&{backgroundColor:s.colors.primary+"20",borderColor:s.colors.primary},i&&!n&&{backgroundColor:s.colors.secondary+"20",borderColor:s.colors.secondary,borderWidth:2}],onPress:()=>{h((0,xe.format)(o,"yyyy-MM")),$("month")},children:(0,K.jsx)(ne.default,{style:[Lt.yearMonthText,{color:n?s.colors.primary:i?s.colors.secondary:s.colors.text,fontWeight:n||i?"bold":"normal"}],children:r})},t)}))})]})});case"week":return(0,K.jsxs)(E.default,{style:{flex:1},children:[(0,K.jsxs)(E.default,{style:Lt.weekViewContainer,children:[(0,K.jsx)(E.default,{style:Lt.weekHeader,children:(0,K.jsxs)(ne.default,{style:[Lt.weekTitle,{color:s.colors.text}],children:[(0,xe.format)(U()[0],"MMM d")," - ",(0,xe.format)(U()[6],"MMM d, yyyy")]})}),(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Lt.weekDaysContainer,children:U().map((e=>{const t=(0,xe.format)(e,"yyyy-MM-dd"),o=t===l,r=b[t]||[],a=r.some((e=>"high"===e.priority&&!e.completed)),n=r.some((e=>"medium"===e.priority&&!e.completed)),i=r.some((e=>"low"===e.priority&&!e.completed));return(0,K.jsxs)(P.default,{style:[Lt.weekDay,o&&{borderColor:s.colors.primary}],onPress:()=>{d(t)},children:[(0,K.jsx)(ne.default,{style:[Lt.weekDayName,{color:(0,Le.isToday)(e)?s.colors.primary:s.colors.text,fontWeight:(0,Le.isToday)(e)?"bold":"400"}],children:(0,xe.format)(e,"EEE")}),(0,K.jsx)(E.default,{style:[Lt.weekDayNumber,(0,Le.isToday)(e)&&{backgroundColor:s.colors.primary,borderRadius:16,width:32,height:32,justifyContent:"center",alignItems:"center"}],children:(0,K.jsx)(ne.default,{style:[Lt.weekDayNumberText,{color:(0,Le.isToday)(e)?"white":s.colors.text,fontWeight:o?"bold":"normal"}],children:(0,xe.format)(e,"d")})}),(0,K.jsxs)(E.default,{style:Lt.weekDayDotsContainer,children:[a&&(0,K.jsx)(E.default,{style:[Lt.weekDayDot,{backgroundColor:s.colors.error}]}),n&&(0,K.jsx)(E.default,{style:[Lt.weekDayDot,{backgroundColor:s.colors.warning}]}),i&&(0,K.jsx)(E.default,{style:[Lt.weekDayDot,{backgroundColor:s.colors.success}]})]}),(0,K.jsx)(ne.default,{style:[Lt.weekDayTaskCount,{color:s.colors.text}],children:r.length>0?`${r.length} task${r.length>1?"s":""}`:"No tasks"})]},t||`day-${Math.random().toString(36)}`)}))})]}),(0,K.jsxs)(E.default,{style:[Lt.taskListContainer,{marginTop:0,flex:1}],children:[(0,K.jsxs)(E.default,{style:Lt.dateHeaderContainer,children:[(0,K.jsx)(ne.default,{style:[Lt.dateHeader,{color:s.colors.text}],children:W(l)}),(0,K.jsxs)(P.default,{style:[Lt.addButton,{backgroundColor:s.colors.primary}],onPress:V,children:[(0,K.jsx)(be.default,{name:"add",size:18,color:"#fff"}),(0,K.jsx)(ne.default,{style:Lt.addButtonText,children:"Add Task"})]})]}),f.length>0?(0,K.jsx)(ie.default,{data:f,renderItem:H,keyExtractor:e=>e?.id||`cal-task-${Math.random().toString(36)}`,style:Lt.taskList,contentContainerStyle:{paddingBottom:80},showsVerticalScrollIndicator:!1}):(0,K.jsxs)(E.default,{style:Lt.emptyState,children:[(0,K.jsx)(ne.default,{style:[Lt.emptyText,{color:s.colors.secondary||s.colors.text+"80"}],children:"No tasks scheduled for this day"}),(0,K.jsx)(P.default,{style:[Lt.addTaskButton,{backgroundColor:s.colors.primary}],onPress:V,children:(0,K.jsx)(ne.default,{style:Lt.addTaskButtonText,children:"Add Task for This Day"})})]})]})]});case"today":{const e=new Date,t=(0,xe.format)(e,"yyyy-MM-dd"),o=i.filter((e=>{if(!e.dueDate)return!1;try{const o=new Date(e.dueDate);return(0,xe.format)(o,"yyyy-MM-dd")===t}catch(Pr){return console.error("Error comparing task date:",Pr),!1}})).sort(((e,t)=>{if(e.completed&&!t.completed)return 1;if(!e.completed&&t.completed)return-1;const o={high:0,medium:1,low:2},r=o[e.priority]-o[t.priority];return 0!==r?r:e.title.localeCompare(t.title)}));return console.log("Today tasks count:",o.length),o.length>0&&console.log("First task:",o[0].title),(0,K.jsxs)(E.default,{style:[Lt.todayViewContainer,{flex:1}],children:[(0,K.jsxs)(E.default,{style:Lt.todayHeader,children:[(0,K.jsx)(be.default,{name:"today",size:24,color:s.colors.primary}),(0,K.jsx)(ne.default,{style:[Lt.todayHeaderText,{color:s.colors.text}],children:"Today's Schedule"})]}),o.length>0?(0,K.jsx)(ie.default,{data:o,renderItem:H,keyExtractor:e=>e?.id||`cal-task-${Math.random().toString(36)}`,style:[Lt.todayTaskList,{flex:1}],contentContainerStyle:{paddingBottom:100},showsVerticalScrollIndicator:!1,ListHeaderComponent:()=>(0,K.jsxs)(E.default,{style:Lt.todayInfoContainer,children:[(0,K.jsx)(ne.default,{style:[Lt.todayDateText,{color:s.colors.text}],children:(0,xe.format)(e,"EEEE, MMMM d, yyyy")}),(0,K.jsxs)(E.default,{style:Lt.todayTaskStats,children:[(0,K.jsxs)(E.default,{style:Lt.todayStatItem,children:[(0,K.jsx)(ne.default,{style:[Lt.todayStatNumber,{color:s.colors.primary}],children:o.length}),(0,K.jsx)(ne.default,{style:[Lt.todayStatLabel,{color:s.colors.text}],children:"Tasks"})]}),(0,K.jsxs)(E.default,{style:Lt.todayStatItem,children:[(0,K.jsx)(ne.default,{style:[Lt.todayStatNumber,{color:s.colors.success}],children:o.filter((e=>e.completed)).length}),(0,K.jsx)(ne.default,{style:[Lt.todayStatLabel,{color:s.colors.text}],children:"Completed"})]}),(0,K.jsxs)(E.default,{style:Lt.todayStatItem,children:[(0,K.jsx)(ne.default,{style:[Lt.todayStatNumber,{color:s.colors.error}],children:o.filter((e=>!e.completed)).length}),(0,K.jsx)(ne.default,{style:[Lt.todayStatLabel,{color:s.colors.text}],children:"Pending"})]})]})]})}):(0,K.jsxs)(E.default,{style:[Lt.emptyState,{flex:1}],children:[(0,K.jsx)(ne.default,{style:[Lt.emptyText,{color:s.colors.secondary||s.colors.text+"80"}],children:"No tasks scheduled for today"}),(0,K.jsx)(P.default,{style:[Lt.addTaskButton,{backgroundColor:s.colors.primary}],onPress:()=>a&&a(t),children:(0,K.jsx)(ne.default,{style:Lt.addTaskButtonText,children:"Add Task for Today"})})]})]})}case"timeline":const e=(0,Bt.startOfMonth)(new Date(g+"-01")),t=((0,Pt.endOfMonth)(e),Object.keys(b).filter((e=>b[e]&&b[e].length>0)).sort(((e,t)=>new Date(e).getTime()-new Date(t).getTime())));return(0,K.jsxs)(E.default,{style:[Lt.timelineViewContainer,{flex:1}],children:[(0,K.jsxs)(ne.default,{style:[Lt.viewTitle,{color:s.colors.text}],children:[(0,xe.format)(new Date(g+"-01"),"MMMM yyyy")," Timeline"]}),(0,K.jsx)(Ae.default,{style:[Lt.timelineScroll,{flex:1}],showsVerticalScrollIndicator:!1,contentContainerStyle:{paddingBottom:80},children:t.length>0?t.map(((e,t)=>{const o=new Date(e),r=b[e]||[];return r.length?(0,K.jsxs)(E.default,{style:{marginBottom:16},children:[(0,K.jsxs)(P.default,{style:[Lt.timelineDateHeader,{backgroundColor:s.colors.surface,borderLeftColor:(0,Le.isToday)(o)?s.colors.primary:"transparent",borderLeftWidth:(0,Le.isToday)(o)?4:0,paddingLeft:(0,Le.isToday)(o)?12:16}],onPress:()=>{d(e),$("month")},children:[(0,K.jsxs)(ne.default,{style:[Lt.timelineDateText,{color:s.colors.text,fontWeight:(0,Le.isToday)(o)?"bold":"normal"}],children:[(0,xe.format)(o,"EEEE, MMMM d"),(0,Le.isToday)(o)&&" (Today)"]}),(0,K.jsxs)(ne.default,{style:{color:s.colors.text,opacity:.7,fontSize:14},children:[r.length," task",1!==r.length?"s":""]})]}),r.sort(((e,t)=>{if(e.dueTime&&t.dueTime)return e.dueTime.localeCompare(t.dueTime);const o={high:0,medium:1,low:2};return o[e.priority]-o[t.priority]})).map((e=>{const t=e.dueTime?(0,xe.format)(new Date(`2000-01-01T${e.dueTime}`),"h:mm a"):"All day";return(0,K.jsx)(E.default,{style:{marginLeft:70},children:(0,K.jsxs)(E.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:4},children:[(0,K.jsx)(ne.default,{style:{color:s.colors.text,fontSize:12,width:70,opacity:.7,marginLeft:-70},children:t}),G(e)]})},`task-${e.id||Math.random().toString(36)}`)}))]},`day-${e}-${t}`):null})):(0,K.jsxs)(E.default,{style:Lt.emptyState,children:[(0,K.jsxs)(ne.default,{style:[Lt.emptyText,{color:s.colors.secondary||s.colors.text+"80"}],children:["No tasks scheduled for ",(0,xe.format)(new Date(g+"-01"),"MMMM yyyy")]}),(0,K.jsx)(P.default,{style:[Lt.addTaskButton,{backgroundColor:s.colors.primary}],onPress:()=>a&&a((0,xe.format)(new Date,"yyyy-MM-dd")),children:(0,K.jsx)(ne.default,{style:Lt.addTaskButtonText,children:"Add New Task"})})]})})]});default:return(0,K.jsxs)(E.default,{style:Lt.calendarContainer,children:[(0,K.jsx)(E.default,{style:Lt.calendarWrapper,children:(0,K.jsx)(Dt.Calendar,{style:Lt.calendar,theme:{calendarBackground:s.colors.surface,textSectionTitleColor:s.colors.text,selectedDayBackgroundColor:s.colors.primary,selectedDayTextColor:"#fff",todayTextColor:s.colors.primary,dayTextColor:s.colors.text,textDisabledColor:s.colors.text+"40",dotColor:s.colors.primary,selectedDotColor:"#fff",arrowColor:s.colors.primary,monthTextColor:s.colors.text,indicatorColor:s.colors.primary,textDayFontWeight:"300",textMonthFontWeight:"bold",textDayHeaderFontWeight:"300",textDayFontSize:14,textMonthFontSize:16,textDayHeaderFontSize:14,"stylesheet.calendar.header":{header:{height:0,opacity:0,paddingTop:0,paddingBottom:0}},"stylesheet.calendar.main":{week:{marginTop:2,marginBottom:2,flexDirection:"row",justifyContent:"space-around"}}},hideArrows:!0,renderHeader:()=>null,markingType:"multi-dot",markedDates:c,onDayPress:L,enableSwipeMonths:!0,current:g+"-01",onMonthChange:e=>{h(e.dateString.substring(0,7))}},g)}),(0,K.jsxs)(E.default,{style:Lt.legendRow,children:[(0,K.jsxs)(E.default,{style:Lt.legendItem,children:[(0,K.jsx)(E.default,{style:[Lt.legendDot,{backgroundColor:s.colors.error}]}),(0,K.jsx)(ne.default,{style:[Lt.legendText,{color:s.colors.text}],children:"High"})]}),(0,K.jsxs)(E.default,{style:Lt.legendItem,children:[(0,K.jsx)(E.default,{style:[Lt.legendDot,{backgroundColor:s.colors.warning}]}),(0,K.jsx)(ne.default,{style:[Lt.legendText,{color:s.colors.text}],children:"Medium"})]}),(0,K.jsxs)(E.default,{style:Lt.legendItem,children:[(0,K.jsx)(E.default,{style:[Lt.legendDot,{backgroundColor:s.colors.success}]}),(0,K.jsx)(ne.default,{style:[Lt.legendText,{color:s.colors.text}],children:"Low"})]})]})]})}})()}),"today"!==k&&"year"!==k&&"week"!==k&&"timeline"!==k&&(0,K.jsxs)(E.default,{style:Lt.taskListContainer,children:[(0,K.jsxs)(E.default,{style:Lt.dateHeaderContainer,children:[(0,K.jsx)(ne.default,{style:[Lt.dateHeader,{color:s.colors.text}],children:W(l)}),(0,K.jsxs)(P.default,{style:[Lt.addButton,{backgroundColor:s.colors.primary}],onPress:V,children:[(0,K.jsx)(be.default,{name:"add",size:18,color:"#fff"}),(0,K.jsx)(ne.default,{style:Lt.addButtonText,children:"Add Task"})]})]}),f.length>0?(0,K.jsx)(ie.default,{data:f,renderItem:H,keyExtractor:e=>e?.id||`cal-task-${Math.random().toString(36)}`,style:Lt.taskList,contentContainerStyle:{paddingBottom:80},showsVerticalScrollIndicator:!1}):(0,K.jsxs)(E.default,{style:Lt.emptyState,children:[(0,K.jsx)(ne.default,{style:[Lt.emptyText,{color:s.colors.secondary||s.colors.text+"80"}],children:"No tasks scheduled for this day"}),(0,K.jsx)(P.default,{style:[Lt.addTaskButton,{backgroundColor:s.colors.primary}],onPress:V,children:(0,K.jsx)(ne.default,{style:Lt.addTaskButtonText,children:"Add Task for This Day"})})]})]}),(0,K.jsxs)(E.default,{style:Lt.viewSelectorContainer,children:[(0,K.jsxs)(P.default,{style:[Lt.viewButton,"month"===k&&{backgroundColor:s.colors.primary+"30"}],onPress:()=>$("month"),children:[(0,K.jsx)(be.default,{name:"calendar-view-month",size:20,color:"month"===k?s.colors.primary:s.colors.text}),(0,K.jsx)(ne.default,{style:[Lt.viewButtonText,{color:"month"===k?s.colors.primary:s.colors.text}],children:"Month"})]}),(0,K.jsxs)(P.default,{style:[Lt.viewButton,"week"===k&&{backgroundColor:s.colors.primary+"30"}],onPress:()=>$("week"),children:[(0,K.jsx)(be.default,{name:"view-week",size:20,color:"week"===k?s.colors.primary:s.colors.text}),(0,K.jsx)(ne.default,{style:[Lt.viewButtonText,{color:"week"===k?s.colors.primary:s.colors.text}],children:"Week"})]}),(0,K.jsxs)(P.default,{style:[Lt.viewButton,"today"===k&&{backgroundColor:s.colors.primary+"30"}],onPress:()=>$("today"),children:[(0,K.jsx)(be.default,{name:"today",size:20,color:"today"===k?s.colors.primary:s.colors.text}),(0,K.jsx)(ne.default,{style:[Lt.viewButtonText,{color:"today"===k?s.colors.primary:s.colors.text}],children:"Today"})]}),(0,K.jsxs)(P.default,{style:[Lt.viewButton,"timeline"===k&&{backgroundColor:s.colors.primary+"30"}],onPress:()=>$("timeline"),children:[(0,K.jsx)(be.default,{name:"timeline",size:20,color:"timeline"===k?s.colors.primary:s.colors.text}),(0,K.jsx)(ne.default,{style:[Lt.viewButtonText,{color:"timeline"===k?s.colors.primary:s.colors.text}],children:"Timeline"})]}),(0,K.jsxs)(P.default,{style:[Lt.viewButton,"year"===k&&{backgroundColor:s.colors.primary+"30"}],onPress:()=>$("year"),children:[(0,K.jsx)(be.default,{name:"calendar-today",size:20,color:"year"===k?s.colors.primary:s.colors.text}),(0,K.jsx)(ne.default,{style:[Lt.viewButtonText,{color:"year"===k?s.colors.primary:s.colors.text}],children:"Year"})]})]}),(0,K.jsx)(M.default,{children:(0,K.jsx)(N.default,{visible:D,onDismiss:()=>{I(!1),B(null),A(null)},anchor:R?{x:R.x,y:R.y}:{x:0,y:0},children:v&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(N.default.Item,{onPress:()=>{I(!1),t&&t(v)},title:"View Details",leadingIcon:"eye"}),(0,K.jsx)(N.default.Item,{onPress:()=>{I(!1),o&&o(v)},title:e.find((e=>e.id===v))?.completed?"Mark as Pending":"Mark as Completed",leadingIcon:e.find((e=>e.id===v))?.completed?"clock-outline":"check"}),(0,K.jsx)(F.default,{}),(0,K.jsx)(N.default.Item,{onPress:()=>{I(!1),t&&t(v)},title:"Delete Task",leadingIcon:"delete",titleStyle:{color:s.colors.error}})]})})})]})}const Lt=B.default.create({container:{flex:1,paddingBottom:70},calendarHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingVertical:8},currentMonthText:{fontSize:18,fontWeight:"bold",flexDirection:"row",alignItems:"center"},calendarContainer:{overflow:"hidden",marginBottom:10},calendarWrapper:{backgroundColor:"white",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:2,elevation:4},calendar:{borderRadius:10,padding:10},legendRow:{flexDirection:"row",justifyContent:"center",paddingVertical:8,backgroundColor:"white",marginTop:8,borderRadius:10,paddingHorizontal:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1,elevation:2},legendItem:{flexDirection:"row",alignItems:"center",marginHorizontal:10},legendDot:{width:10,height:10,borderRadius:5,marginRight:4},legendText:{fontSize:12,fontWeight:"500"},viewSelectorContainer:{flexDirection:"row",justifyContent:"space-around",position:"absolute",bottom:0,left:0,right:0,backgroundColor:"rgba(255, 255, 255, 0.95)",paddingVertical:12,paddingBottom:20,borderTopWidth:1,borderTopColor:"rgba(0,0,0,0.1)",shadowColor:"#000",shadowOffset:{width:0,height:-2},shadowOpacity:.1,shadowRadius:3,elevation:10,zIndex:999},viewButton:{flexDirection:"row",alignItems:"center",paddingVertical:6,paddingHorizontal:8,borderRadius:20},viewButtonText:{fontSize:14,marginLeft:4,fontWeight:"500"},todayViewContainer:{padding:16},weekViewContainer:{padding:0,marginVertical:0,marginBottom:0},weekHeader:{paddingHorizontal:16,paddingVertical:8,marginBottom:0},weekTitle:{fontSize:16,fontWeight:"bold"},weekDaysContainer:{paddingHorizontal:4,flexDirection:"row",alignItems:"center"},weekDay:{width:70,height:90,alignItems:"center",justifyContent:"space-between",marginHorizontal:1,borderRadius:12,borderWidth:1,borderColor:"rgba(0,0,0,0.1)",padding:5},weekDayName:{fontSize:14,marginBottom:2},weekDayNumber:{marginBottom:0},weekDayNumberText:{fontSize:18,fontWeight:"500"},weekDayDotsContainer:{flexDirection:"row",justifyContent:"center",marginBottom:0,marginTop:2},weekDayDot:{width:6,height:6,borderRadius:3,marginHorizontal:2},weekDayTaskCount:{fontSize:10,textAlign:"center",marginTop:2},timelineViewContainer:{padding:16},viewTitle:{fontSize:18,fontWeight:"bold",marginBottom:10},taskListContainer:{flex:1},dateHeaderContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8,marginTop:0,paddingHorizontal:16},dateHeader:{fontSize:18,fontWeight:"bold",flex:1},addButton:{flexDirection:"row",alignItems:"center",paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginTop:8},addButtonText:{color:"white",marginLeft:4,fontWeight:"500"},taskList:{flex:1,paddingHorizontal:16,paddingBottom:80,marginTop:0},taskItem:{flexDirection:"row",borderRadius:8,marginBottom:8,padding:12,borderLeftWidth:4,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1},taskContent:{flex:1,justifyContent:"center"},taskHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},taskTitle:{fontSize:16,fontWeight:"bold",marginBottom:2},taskActions:{flexDirection:"row",alignItems:"center"},taskDescription:{fontSize:14,marginBottom:4},taskFooter:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},statusChip:{paddingHorizontal:8,paddingVertical:4,borderRadius:16},priorityIndicator:{width:28,height:28,justifyContent:"center",alignItems:"center",alignSelf:"center",marginLeft:8},emptyState:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyText:{fontSize:16,textAlign:"center",marginBottom:20},addTaskButton:{paddingHorizontal:20,paddingVertical:10,borderRadius:20,marginTop:16},addTaskButtonText:{color:"white",fontWeight:"bold"},yearViewContainer:{padding:16,flex:1},yearTitle:{fontSize:24,fontWeight:"bold",marginBottom:16,textAlign:"center"},yearMonthsGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"},yearMonth:{width:"30%",aspectRatio:1.5,margin:"1.5%",borderRadius:12,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.05)",borderWidth:1,borderColor:"rgba(0,0,0,0.1)"},yearMonthText:{fontSize:16,fontWeight:"500"},todayHeader:{flexDirection:"row",alignItems:"center",marginBottom:16},todayHeaderText:{fontSize:20,fontWeight:"bold",marginLeft:8},todayDateText:{fontSize:16,marginBottom:12},todayInfoContainer:{marginBottom:16,padding:16,borderRadius:12,backgroundColor:"rgba(0,0,0,0.03)"},todayTaskStats:{flexDirection:"row",justifyContent:"space-around",marginTop:8},todayStatItem:{alignItems:"center"},todayStatNumber:{fontSize:24,fontWeight:"bold"},todayStatLabel:{fontSize:14,opacity:.7},todayTaskList:{flex:1},timelineScroll:{flex:1},timelineDateHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:8,borderRadius:8,marginBottom:8,borderLeftWidth:4,borderLeftColor:"transparent",paddingLeft:16,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:1},timelineDateText:{fontSize:16,fontWeight:"bold"},timelineTask:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:8,borderRadius:6,marginBottom:4,borderLeftWidth:3,elevation:1,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:1},timelineTaskTitle:{fontSize:14,flex:1},timelineCheckbox:{width:18,height:18,borderRadius:3,borderWidth:1.5,justifyContent:"center",alignItems:"center",marginLeft:8},timelineTaskActions:{flexDirection:"row",alignItems:"center"}});function Ot(){const e=(0,R.useTheme)(),t=(0,d.useNavigation)(),{tasks:o,updateTask:a,deleteTask:s}=he(),[n,i]=(0,r.useState)(null),[l,c]=(0,r.useState)(!1),[u,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)(void 0),h=e=>{a(e),i(e)},y=e=>{const t=o.find((t=>t.id===e));if(t){const o=Object.assign({},t,{completed:!t.completed});a(o),n?.id===e&&i(o)}};return(0,K.jsxs)(E.default,{style:[Nt.container,{backgroundColor:e.colors.surface}],children:[(0,K.jsx)(zt,{tasks:o,onTaskPress:e=>{const t=o.find((t=>t.id===e));t&&(i(t),f(!0))},onToggleCompletion:y,onAddTask:e=>{t.navigate("CreateTask",{date:e})}}),(0,K.jsx)(ve.default,{visible:u,animationType:"slide",presentationStyle:"pageSheet",onRequestClose:()=>f(!1),children:n&&(0,K.jsx)(Tt,{task:n,onBack:()=>f(!1),onEdit:()=>{f(!1),t.navigate("EditTask",{taskId:n.id})},onDelete:()=>{n&&(s(n.id),f(!1),i(null))},onUpdate:h,onToggleCompletion:y,onToggleSubtask:(e,t)=>{const r=o.find((t=>t.id===e));if(r&&r.subtasks){const o=r.subtasks.map((e=>e.id===t?Object.assign({},e,{completed:!e.completed}):e)),s=Object.assign({},r,{subtasks:o});a(s),n?.id===e&&i(s)}},onPomodoro:()=>{n&&(f(!1),t.navigate("Pomodoro",{taskId:n.id}))},onAddComment:()=>{n&&(f(!1),t.navigate("AddComment",{taskId:n.id}))},onShare:()=>{n&&(f(!1),t.navigate("ShareTask",{taskId:n.id}))}})}),(0,K.jsx)(ve.default,{visible:l,animationType:"slide",presentationStyle:"pageSheet",onRequestClose:()=>{c(!1),g(void 0)},children:(0,K.jsx)(E.default,{style:[Nt.modalContainer,{backgroundColor:e.colors.surface}],children:(0,K.jsx)(ht,{task:n||void 0,isVisible:l,onClose:()=>{c(!1),g(void 0)},onSave:async e=>{if(n)await h(Object.assign({},n,e));else if(m){const t={id:Date.now().toString(),title:e.title||"",description:e.description,dueDate:m.toISOString(),completed:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:e.priority,categoryId:e.categoryId,subtasks:e.subtasks||[]};await h(t)}}})})})]})}const Nt=B.default.create({container:{flex:1},modalContainer:{flex:1}});function Ft(){const[e,t]=(0,r.useState)(null),[o,a]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),i=(0,R.useTheme)();(0,r.useEffect)((()=>{l()}),[]);const l=async()=>{try{n(!0);const e=(await fe.executeSql("\n        SELECT \n          COUNT(*) as total,\n          SUM(CASE WHEN completed = 1 THEN 1 ELSE 0 END) as completed,\n          SUM(CASE WHEN completed = 0 THEN 1 ELSE 0 END) as pending,\n          SUM(CASE WHEN completed = 0 AND dueDate < datetime('now') THEN 1 ELSE 0 END) as overdue,\n          SUM(CASE WHEN priority = 'high' THEN 1 ELSE 0 END) as highPriority,\n          SUM(CASE WHEN priority = 'medium' THEN 1 ELSE 0 END) as mediumPriority,\n          SUM(CASE WHEN priority = 'low' THEN 1 ELSE 0 END) as lowPriority,\n          SUM(CASE WHEN isMeeting = 1 THEN 1 ELSE 0 END) as meetings,\n          AVG(CASE \n            WHEN completed = 1 \n            THEN julianday(updatedAt) - julianday(createdAt)\n            ELSE NULL \n          END) as avgCompletionDays\n        FROM tasks\n      ")).rows.item(0),o=e.total>0?e.completed/e.total*100:0;t({total:e.total,completed:e.completed,pending:e.pending,overdue:e.overdue,highPriority:e.highPriority,mediumPriority:e.mediumPriority,lowPriority:e.lowPriority,meetings:e.meetings,completionRate:o,averageCompletionTime:e.avgCompletionDays||0});const r=(0,It.startOfWeek)(new Date),s=(0,At.endOfWeek)(new Date),i=(0,Rt.eachDayOfInterval)({start:r,end:s}),l=await Promise.all(i.map((async e=>{const t=(0,xe.format)(e,"yyyy-MM-dd"),o=await fe.executeSql("\n          SELECT\n            (SELECT COUNT(*) FROM tasks \n             WHERE date(createdAt) = date(?) AND completed = 1) as completed,\n            (SELECT COUNT(*) FROM tasks \n             WHERE date(createdAt) = date(?)) as added\n        ",[t,t]);return{date:t,completed:o.rows.item(0).completed,added:o.rows.item(0).added}})));a(l),n(!1)}catch(Pr){console.error("Error loading stats:",Pr),n(!1)}};if(s||!e)return(0,K.jsx)(E.default,{style:Mt.centered,children:(0,K.jsx)(A.default,{children:"Loading statistics..."})});const d=(e,t,o)=>(0,K.jsxs)(ye.default,{style:Mt.statCard,children:[(0,K.jsx)(A.default,{variant:"titleLarge",style:Mt.statValue,children:"number"!==typeof t||isNaN(t)?t:t.toFixed(t%1===0?0:1)}),(0,K.jsx)(A.default,{variant:"labelMedium",style:Mt.statTitle,children:e}),o&&(0,K.jsx)(A.default,{variant:"labelSmall",style:Mt.statSubtitle,children:o})]});return(0,K.jsxs)(Ae.default,{style:Mt.container,children:[(0,K.jsx)(A.default,{variant:"headlineSmall",style:Mt.sectionTitle,children:"Overview"}),(0,K.jsxs)(E.default,{style:Mt.statsGrid,children:[d("Total Tasks",e.total),d("Completed",e.completed),d("Pending",e.pending),d("Overdue",e.overdue)]}),(0,K.jsx)(A.default,{variant:"headlineSmall",style:Mt.sectionTitle,children:"Task Breakdown"}),(0,K.jsxs)(E.default,{style:Mt.statsGrid,children:[d("High Priority",e.highPriority),d("Medium Priority",e.mediumPriority),d("Low Priority",e.lowPriority),d("Meetings",e.meetings)]}),(0,K.jsx)(A.default,{variant:"headlineSmall",style:Mt.sectionTitle,children:"Performance"}),(0,K.jsxs)(E.default,{style:Mt.statsGrid,children:[d("Completion Rate",`${e.completionRate.toFixed(1)}%`),d("Avg. Completion Time",e.averageCompletionTime.toFixed(1),"days")]}),(0,K.jsx)(A.default,{variant:"headlineSmall",style:Mt.sectionTitle,children:"This Week"}),(0,K.jsx)(ye.default,{style:Mt.weeklyChart,children:o.map(((e,t)=>(0,K.jsxs)(E.default,{style:Mt.weekDay,children:[(0,K.jsxs)(E.default,{style:Mt.barContainer,children:[(0,K.jsx)(E.default,{style:[Mt.bar,{height:e.completed/Math.max(...o.map((e=>e.added)))*100+"%",backgroundColor:i.colors.primary}]}),(0,K.jsx)(E.default,{style:[Mt.bar,{height:e.added/Math.max(...o.map((e=>e.added)))*100+"%",backgroundColor:i.colors.secondary,opacity:.5}]})]}),(0,K.jsx)(A.default,{variant:"labelSmall",children:(0,xe.format)(new Date(e.date),"EEE")})]},e.date)))}),(0,K.jsxs)(E.default,{style:Mt.chartLegend,children:[(0,K.jsxs)(E.default,{style:Mt.legendItem,children:[(0,K.jsx)(E.default,{style:[Mt.legendDot,{backgroundColor:i.colors.primary}]}),(0,K.jsx)(A.default,{variant:"labelSmall",children:"Completed"})]}),(0,K.jsxs)(E.default,{style:Mt.legendItem,children:[(0,K.jsx)(E.default,{style:[Mt.legendDot,{backgroundColor:i.colors.secondary,opacity:.5}]}),(0,K.jsx)(A.default,{variant:"labelSmall",children:"Added"})]})]})]})}const Mt=B.default.create({container:{flex:1,padding:16},centered:{flex:1,justifyContent:"center",alignItems:"center"},sectionTitle:{marginBottom:16},statsGrid:{flexDirection:"row",flexWrap:"wrap",gap:16,marginBottom:24},statCard:{flex:1,minWidth:"45%",padding:16,borderRadius:8,alignItems:"center",elevation:2},statValue:{fontSize:24,fontWeight:"bold",marginBottom:4},statTitle:{textAlign:"center",opacity:.7},statSubtitle:{marginTop:4,opacity:.5},weeklyChart:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",height:200,padding:16,borderRadius:8,marginBottom:8},weekDay:{flex:1,alignItems:"center"},barContainer:{height:150,width:20,justifyContent:"flex-end",marginBottom:8},bar:{width:"100%",borderRadius:4,position:"absolute",bottom:0},chartLegend:{flexDirection:"row",justifyContent:"center",gap:16,marginBottom:16},legendItem:{flexDirection:"row",alignItems:"center",gap:8},legendDot:{width:8,height:8,borderRadius:4}});var Wt=o(47888);function Vt(){(0,d.useNavigation)();const{tasks:e}=he(),{isDark:t,toggleTheme:o,setThemeMode:a,theme:s}=Z(),[n,i]=(0,r.useState)(!0),[l,c]=(0,r.useState)(!0),[u,f]=(0,r.useState)("medium"),[m,g]=(0,r.useState)(!1),[h,y]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!1),b=()=>{i(!n)},j=()=>{c(!l)},k=(e,t)=>(0,K.jsx)(Be.default,{style:[Ht.statCard,{backgroundColor:s.colors.card}],children:(0,K.jsxs)(Be.default.Content,{children:[(0,K.jsx)(A.default,{style:[Ht.statTitle,{color:s.colors.text}],children:e}),(0,K.jsx)(A.default,{style:[Ht.statValue,{color:s.colors.primary}],children:t})]})});return(0,K.jsxs)(Ae.default,{style:[Ht.container,{backgroundColor:s.colors.background}],children:[(0,K.jsxs)(E.default,{style:Ht.section,children:[(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{style:{color:s.colors.text},children:"Appearance"}),(0,K.jsx)(I.default,{title:"Dark Mode",description:t?"On":"Off",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"theme-light-dark"})),right:()=>(0,K.jsx)(Ye.default,{value:t,onValueChange:o,trackColor:{false:"#767577",true:s.colors.primary},thumbColor:t?s.colors.card:"#f4f3f4"}),onPress:()=>x(!0)})]}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{style:{color:s.colors.text},children:"Notifications"}),(0,K.jsx)(I.default,{title:"Enable Notifications",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"bell"})),right:()=>(0,K.jsx)(Ye.default,{value:n,onValueChange:b,trackColor:{false:"#767577",true:s.colors.primary},thumbColor:n?s.colors.card:"#f4f3f4"})})]}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{style:{color:s.colors.text},children:"Task Settings"}),(0,K.jsx)(I.default,{title:"Confirm Before Delete",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"trash-can"})),right:()=>(0,K.jsx)(Ye.default,{value:l,onValueChange:j,trackColor:{false:"#767577",true:s.colors.primary},thumbColor:l?s.colors.card:"#f4f3f4"})}),(0,K.jsx)(I.default,{title:"Default Priority",description:u.charAt(0).toUpperCase()+u.slice(1),left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"flag"})),onPress:()=>g(!0)})]}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{style:{color:s.colors.text},children:"Statistics"}),(0,K.jsxs)(E.default,{style:Ht.statsContainer,children:[k("Total Tasks",e.length.toString()),k("Completed",e.filter((e=>e.completed)).length.toString()),k("Active",e.filter((e=>!e.completed)).length.toString())]})]}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{style:{color:s.colors.text},children:"About"}),(0,K.jsx)(I.default,{title:"Version",description:"1.0.0",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"information"})),onPress:()=>{_e.default.alert("About Task Manager","Version 1.0.0\n\nA simple and efficient task management app built with React Native and Expo.")}})]}),(0,K.jsxs)(E.default,{style:Ht.dangerZone,children:[(0,K.jsx)(A.default,{style:Ht.dangerTitle,children:"Danger Zone"}),(0,K.jsx)(H.default,{mode:"contained",buttonColor:"#dc3545",onPress:()=>y(!0),children:"Reset App Data"})]})]}),(0,K.jsxs)(M.default,{children:[(0,K.jsxs)(V.default,{visible:m,onDismiss:()=>g(!1),children:[(0,K.jsx)(V.default.Title,{children:"Default Priority"}),(0,K.jsx)(V.default.Content,{children:(0,K.jsxs)(Wt.default.Group,{onValueChange:e=>{f(e),g(!1)},value:u,children:[(0,K.jsx)(Wt.default.Item,{label:"High",value:"high"}),(0,K.jsx)(Wt.default.Item,{label:"Medium",value:"medium"}),(0,K.jsx)(Wt.default.Item,{label:"Low",value:"low"})]})})]}),(0,K.jsxs)(V.default,{visible:p,onDismiss:()=>x(!1),children:[(0,K.jsx)(V.default.Title,{children:"Select Theme Mode"}),(0,K.jsx)(V.default.Content,{children:(0,K.jsxs)(Wt.default.Group,{onValueChange:e=>{a(e),x(!1)},value:s.mode,children:[(0,K.jsxs)(E.default,{style:Ht.radioItem,children:[(0,K.jsx)(Wt.default,{value:"light"}),(0,K.jsx)(A.default,{children:"Light"})]}),(0,K.jsxs)(E.default,{style:Ht.radioItem,children:[(0,K.jsx)(Wt.default,{value:"dark"}),(0,K.jsx)(A.default,{children:"Dark"})]}),(0,K.jsxs)(E.default,{style:Ht.radioItem,children:[(0,K.jsx)(Wt.default,{value:"system"}),(0,K.jsx)(A.default,{children:"System"})]})]})})]}),(0,K.jsxs)(V.default,{visible:h,onDismiss:()=>y(!1),children:[(0,K.jsx)(V.default.Title,{children:"Reset App Data"}),(0,K.jsx)(V.default.Content,{children:(0,K.jsx)(A.default,{children:"Are you sure you want to reset all app data? This action cannot be undone."})}),(0,K.jsxs)(V.default.Actions,{children:[(0,K.jsx)(H.default,{onPress:()=>y(!1),children:"Cancel"}),(0,K.jsx)(H.default,{onPress:()=>{_e.default.alert("App Reset","All data has been reset successfully."),y(!1)},children:"Reset"})]})]})]})]})}const Ht=B.default.create({container:{flex:1},section:{marginBottom:16},statsContainer:{flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",padding:16},statCard:{width:"30%",marginBottom:8,elevation:2},statTitle:{fontSize:12,opacity:.7},statValue:{fontSize:20,fontWeight:"bold"},dangerZone:{padding:16,marginTop:16},dangerTitle:{color:"#dc3545",fontSize:16,fontWeight:"bold",marginBottom:8},radioItem:{flexDirection:"row",alignItems:"center",marginVertical:4}});function Ut({route:e}){const t=(0,d.useNavigation)(),{taskId:o}=e.params;return(0,K.jsx)(Tt,{taskId:o,onEdit:()=>{console.log("Edit task:",o)},onDelete:()=>{console.log("Delete task:",o),t.goBack()},onBack:()=>t.goBack()})}var $t=o(82660),Gt=o(29299),Xt=o(31140);const qt=new Map;let _t=null;try{_t=o(68315),_t.getItemAsync("test").catch((()=>{console.log("SecureStore is not fully functional, using memory fallback"),_t=null}))}catch(Pr){console.warn("SecureStore module not available, using memory fallback")}const Yt={async getItem(e){try{return _t?await _t.getItemAsync(e):qt.get(e)||null}catch(Pr){return console.warn("Error accessing storage, using memory fallback",Pr),qt.get(e)||null}},async setItem(e,t){try{_t?await _t.setItemAsync(e,t):qt.set(e,t)}catch(Pr){console.warn("Error storing data, using memory fallback",Pr),qt.set(e,t)}},async removeItem(e){try{_t?await _t.deleteItemAsync(e):qt.delete(e)}catch(Pr){console.warn("Error removing data, using memory fallback",Pr),qt.delete(e)}}};function Kt({icon:e,label:t,onPress:o,color:r}){const{colors:a}=(0,R.useTheme)();return(0,K.jsxs)(P.default,{style:[Jt.quickActionButton,{backgroundColor:a.surface}],onPress:o,children:[(0,K.jsx)(be.default,{name:e,size:24,color:r}),(0,K.jsx)(A.default,{style:[Jt.quickActionLabel,{color:a.onSurface}],children:t})]})}function Qt({title:e,tasks:t,onTaskPress:o,onSeeAll:r,color:a}){const s=t.slice(0,3);return(0,K.jsxs)(E.default,{style:Jt.taskSection,children:[(0,K.jsxs)(E.default,{style:Jt.sectionHeader,children:[(0,K.jsxs)(E.default,{style:Jt.sectionTitleContainer,children:[(0,K.jsx)(E.default,{style:[Jt.sectionTitleIndicator,{backgroundColor:a}]}),(0,K.jsx)(A.default,{style:[Jt.sectionTitle,{color:a}],children:e})]}),t.length>3&&(0,K.jsxs)(H.default,{mode:"text",onPress:r,textColor:a,children:["See All (",t.length,")"]})]}),0===s.length?(0,K.jsx)(Be.default,{style:[Jt.emptyCard,{borderColor:a+"40"}],children:(0,K.jsxs)(Be.default.Content,{style:Jt.emptyCardContent,children:[(0,K.jsx)(be.default,{name:"assignment",size:32,color:a+"80"}),(0,K.jsx)(Gt.default,{style:{color:a+"90"},children:"No tasks in this category"})]})}):(0,K.jsx)(ie.default,{data:s,keyExtractor:e=>e.id.toString(),renderItem:({item:e})=>(0,K.jsx)(je,{task:e,onPress:()=>o(e.id.toString())},e.id),scrollEnabled:!1})]})}const Jt=B.default.create({container:{flex:1},scrollView:{flex:1},header:{padding:16,elevation:4},headerContent:{gap:16},headerTop:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"},greeting:{fontSize:24,fontWeight:"bold"},date:{fontSize:16,opacity:.7},profileButton:{padding:4},statsRow:{flexDirection:"row",gap:12,marginBottom:16},statsCard:{borderRadius:12,padding:16,flex:1,minWidth:100},statsContent:{alignItems:"flex-start"},statsLabel:{fontSize:14,fontWeight:"500",marginBottom:8,width:"100%"},statsValue:{fontSize:24,fontWeight:"bold"},quickActions:{flexDirection:"row",gap:12},quickActionButton:{flex:1,padding:12,borderRadius:12,alignItems:"center",gap:8},quickActionLabel:{fontSize:12,fontWeight:"500"},content:{padding:16,gap:24},taskSection:{gap:12},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},sectionTitleContainer:{flexDirection:"row",alignItems:"center",gap:8},sectionTitleIndicator:{width:4,height:20,borderRadius:2},sectionTitle:{fontSize:18,fontWeight:"600"},emptyCard:{borderWidth:1,borderRadius:12},emptyCardContent:{alignItems:"center",padding:24,gap:8},modalContent:{flex:1,margin:0},pomodoroOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",zIndex:999,justifyContent:"center",alignItems:"center"},emptyState:{flex:1,justifyContent:"center",alignItems:"center",padding:24},emptyStateText:{fontSize:20,fontWeight:"bold",marginTop:16},emptyStateSubtext:{fontSize:16,opacity:.7,marginTop:8}}),Zt=()=>{const e=(0,d.useNavigation)(),{colors:t,dark:o}=(0,R.useTheme)(),{tasks:a,isLoading:s,fetchTasks:n,toggleTaskCompletion:i,deleteTask:l,updateTask:c,toggleSubtask:u}=he(),[f,m]=(0,r.useState)(void 0),[g,h]=(0,r.useState)(!1),[y,p]=(0,r.useState)(!1),[x,b]=(0,r.useState)(!1),[j,k]=(0,r.useState)(null),[T,C]=(0,r.useState)(!0),w=r.useRef(new Te.default.Value(1)).current,S=r.useRef(new Te.default.Value(160)).current,D=(r.useRef(new Te.default.Value(1)).current,r.useRef(new Te.default.Value(0)).current),[I,v]=(0,r.useState)(null),[B,z]=(0,r.useState)(!1);(0,r.useEffect)((()=>{L()}),[]),(0,d.useFocusEffect)((0,r.useCallback)((()=>(console.log("HomeScreen focused - refreshing tasks"),L(),()=>{})),[]));const L=async()=>{try{console.log("Loading tasks in HomeScreen"),await n()}catch(Pr){console.error("Error loading tasks:",Pr)}},O=(0,r.useCallback)((async()=>{b(!0);try{await L()}catch(Pr){console.error("Error refreshing tasks:",Pr)}finally{b(!1)}}),[]);(0,r.useEffect)((()=>{(async()=>{const e=await Yt.getItem("has_logged_in_before"),t=await Yt.getItem("user_name");p(!!e),k(t),e||await Yt.setItem("has_logged_in_before","true")})()}),[]);const N=a.filter((e=>{if(!e.dueDate)return!1;const t=new Date(e.dueDate),o=new Date;return t.toDateString()===o.toDateString()})),F=(a.filter((e=>{if(!e.dueDate||e.completed)return!1;return new Date(e.dueDate)<new Date})),a.filter((e=>{if(!e.dueDate||e.completed)return!1;return new Date(e.dueDate)>new Date})),a.filter((e=>e.completed))),V=N.filter((e=>e.completed)).length,H=N.length>0?V/N.length:0;(0,r.useEffect)((()=>{if(T){const e=setTimeout((()=>{U()}),2e3);return()=>clearTimeout(e)}}),[T]);const U=()=>{Te.default.parallel([Te.default.timing(w,{toValue:0,duration:500,useNativeDriver:!0}),Te.default.timing(S,{toValue:0,duration:500,useNativeDriver:!1})]).start((()=>{C(!1)}))};(0,r.useEffect)((()=>{const e=isNaN(H)?0:H;Te.default.spring(D,{toValue:e,useNativeDriver:!1}).start()}),[H]);const $=e=>{const t=a.find((t=>t.id===e));t&&(v(t),z(!0))},G=a?.filter((e=>!e.completed))||[],X=a?.filter((e=>"high"===e.priority&&!e.completed))||[],q=a?.filter((e=>{if(!e.dueDate||e.completed)return!1;const t=new Date,o=new Date(e.dueDate);return o.getDate()===t.getDate()&&o.getMonth()===t.getMonth()&&o.getFullYear()===t.getFullYear()}))||[],_=()=>{e.navigate("MainTabs",{screen:"Tasks"})};return(0,K.jsxs)(E.default,{style:Jt.container,children:[(0,K.jsxs)(Ae.default,{style:Jt.scrollView,refreshControl:(0,K.jsx)($t.default,{refreshing:x,onRefresh:O}),children:[(0,K.jsx)(ye.default,{style:Jt.header,children:(0,K.jsxs)(E.default,{style:Jt.headerContent,children:[(0,K.jsxs)(E.default,{style:Jt.headerTop,children:[(0,K.jsxs)(E.default,{children:[(0,K.jsx)(A.default,{style:Jt.greeting,children:j?`Hello, ${j}!`:"Welcome back!"}),(0,K.jsx)(A.default,{style:Jt.date,children:(0,xe.format)(new Date,"EEEE, MMMM d")})]}),(0,K.jsx)(P.default,{style:Jt.profileButton,onPress:()=>e.navigate("Settings"),children:(0,K.jsx)(Xt.default,{size:40,label:j?j.substring(0,2).toUpperCase():"U"})})]}),(0,K.jsxs)(E.default,{style:Jt.statsRow,children:[(0,K.jsx)(ye.default,{style:[Jt.statsCard,{backgroundColor:t.primaryContainer}],children:(0,K.jsxs)(E.default,{style:Jt.statsContent,children:[(0,K.jsx)(A.default,{style:[Jt.statsLabel,{color:t.onPrimaryContainer,whiteSpace:"nowrap"}],numberOfLines:1,children:"Total Tasks"}),(0,K.jsx)(A.default,{style:[Jt.statsValue,{color:t.onPrimaryContainer}],children:(a?.length||0).toString()})]})}),(0,K.jsx)(ye.default,{style:[Jt.statsCard,{backgroundColor:t.primaryContainer}],children:(0,K.jsxs)(E.default,{style:Jt.statsContent,children:[(0,K.jsx)(A.default,{style:[Jt.statsLabel,{color:t.onPrimaryContainer,whiteSpace:"nowrap"}],numberOfLines:1,children:"Completed"}),(0,K.jsx)(A.default,{style:[Jt.statsValue,{color:t.onPrimaryContainer}],children:(F.length||0).toString()})]})}),(0,K.jsx)(ye.default,{style:[Jt.statsCard,{backgroundColor:t.primaryContainer}],children:(0,K.jsxs)(E.default,{style:Jt.statsContent,children:[(0,K.jsx)(A.default,{style:[Jt.statsLabel,{color:t.onPrimaryContainer,whiteSpace:"nowrap"}],numberOfLines:1,children:"Due Today"}),(0,K.jsx)(A.default,{style:[Jt.statsValue,{color:t.onPrimaryContainer}],children:(q?.length||0).toString()})]})})]}),(0,K.jsxs)(E.default,{style:Jt.quickActions,children:[(0,K.jsx)(Kt,{icon:"add-task",label:"New Task",color:t.primary,onPress:()=>e.navigate("CreateTask")}),(0,K.jsx)(Kt,{icon:"timer",label:"Pomodoro",color:t.primary,onPress:()=>h(!0)}),(0,K.jsx)(Kt,{icon:"calendar-today",label:"Calendar",color:t.primary,onPress:()=>e.navigate("Calendar")})]})]})}),(0,K.jsxs)(E.default,{style:Jt.content,children:[X.length>0&&(0,K.jsx)(Qt,{title:"High Priority",tasks:X,onTaskPress:$,onSeeAll:_,color:t.error}),q.length>0&&(0,K.jsx)(Qt,{title:"Due Today",tasks:q,onTaskPress:$,onSeeAll:_,color:t.primary}),G.length>0&&(0,K.jsx)(Qt,{title:"Pending Tasks",tasks:G,onTaskPress:$,onSeeAll:_,color:t.primary}),F.length>0&&(0,K.jsx)(Qt,{title:"Completed",tasks:F,onTaskPress:$,onSeeAll:_,color:t.success})]})]}),g&&(0,K.jsx)(E.default,{style:Jt.pomodoroOverlay,children:(0,K.jsx)(jt,{initialTaskId:f,onClose:()=>h(!1),showCloseButton:!0})}),(0,K.jsx)(M.default,{children:(0,K.jsx)(W.default,{visible:B&&null!==I,onDismiss:()=>z(!1),contentContainerStyle:Jt.modalContent,children:I&&(0,K.jsx)(Tt,{task:I,onEdit:()=>{z(!1),e.navigate("EditTask",{taskId:I.id})},onDelete:async e=>{await l(e),z(!1),v(null)},onToggleCompletion:async e=>{await i(e),I&&v(Object.assign({},I,{completed:!I.completed}))},onToggleSubtask:async(e,t)=>{if(await u(e,t),I){const e=I.subtasks.map((e=>e.id===t?Object.assign({},e,{completed:!e.completed}):e));v(Object.assign({},I,{subtasks:e}))}},onUpdate:e=>{c(e),v(e)},onBack:()=>z(!1)})})})]})};var eo=o(40484),to=o(61092),oo=o(54744),ro=o(35708),ao=o(60893);function so({userName:e="there",onFinish:t}){const{theme:o}=Z(),[a,s]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),l=(0,r.useRef)(new Te.default.Value(0)).current,d=(0,r.useRef)(new Te.default.Value(0)).current,c=(0,r.useRef)(new Te.default.Value(0)).current,u=(0,r.useRef)(new Te.default.Value(0)).current,f=(0,r.useRef)(new Te.default.Value(1)).current,m=(0,r.useRef)(new Te.default.Value(1)).current,g=(0,r.useRef)(new Te.default.Value(0)).current,h=(0,r.useRef)(new Te.default.Value(0)).current;(0,r.useEffect)((()=>{h.setValue(0),l.setValue(0),d.setValue(0),c.setValue(0),u.setValue(0),f.setValue(1),m.setValue(1),g.setValue(0),Te.default.sequence([Te.default.spring(h,{toValue:0,friction:8,tension:40,useNativeDriver:!0}),Te.default.timing(l,{toValue:1,duration:800,useNativeDriver:!0}),Te.default.timing(d,{toValue:1,duration:800,useNativeDriver:!0}),Te.default.timing(c,{toValue:1,duration:800,useNativeDriver:!0}),Te.default.timing(g,{toValue:1,duration:500,useNativeDriver:!0})]).start(),Te.default.loop(Te.default.sequence([Te.default.timing(u,{toValue:1,duration:1500,easing:pt.default.out(pt.default.sin),useNativeDriver:!0}),Te.default.timing(u,{toValue:0,duration:1500,easing:pt.default.in(pt.default.sin),useNativeDriver:!0})])).start()}),[]);const y=u.interpolate({inputRange:[0,1],outputRange:[0,-5]}),p=e=>{i(e),setTimeout((()=>i(null)),200)};return(0,K.jsxs)(Te.default.View,{style:[no.container,{opacity:f,transform:[{translateY:h}]}],children:[(0,K.jsx)(ao.LinearGradient,{colors:[o.colors.primary+"20",o.colors.background],style:no.gradient}),(0,K.jsxs)(Te.default.Text,{style:[no.welcomeText,{color:o.colors.text,opacity:l}],children:["Hi ",e,"!"]}),(0,K.jsx)(Te.default.Text,{style:[no.subtitle,{color:o.colors.text,opacity:d}],children:"Welcome to your Task Manager"}),(0,K.jsxs)(E.default,{style:no.iconContainer,children:[(0,K.jsx)(ro.default,{onPress:()=>p("sparkle"),style:({pressed:e})=>[no.iconPressable,e&&no.iconPressed],children:(0,K.jsx)(Te.default.View,{style:[no.iconWrapper,{backgroundColor:o.colors.primary+"20",borderColor:o.colors.primary+"50",opacity:c,transform:[{translateY:y},{scale:"sparkle"===n?1.2:1}]}],children:(0,K.jsx)(ne.default,{style:no.icon,children:"\u2728"})})}),(0,K.jsx)(ro.default,{onPress:()=>p("list"),style:({pressed:e})=>[no.iconPressable,e&&no.iconPressed],children:(0,K.jsx)(Te.default.View,{style:[no.iconWrapper,{backgroundColor:o.colors.success+"20",borderColor:o.colors.success+"50",opacity:c,transform:[{translateY:Te.default.add(y,new Te.default.Value(8))},{scale:"list"===n?1.2:1}]}],children:(0,K.jsx)(ne.default,{style:no.icon,children:"\ud83d\udccb"})})}),(0,K.jsx)(ro.default,{onPress:()=>p("timer"),style:({pressed:e})=>[no.iconPressable,e&&no.iconPressed],children:(0,K.jsx)(Te.default.View,{style:[no.iconWrapper,{backgroundColor:o.colors.warning+"20",borderColor:o.colors.warning+"50",opacity:c,transform:[{translateY:Te.default.multiply(y,new Te.default.Value(-1))},{scale:"timer"===n?1.2:1}]}],children:(0,K.jsx)(ne.default,{style:no.icon,children:"\u23f0"})})})]}),(0,K.jsx)(Te.default.View,{style:{opacity:g},children:(0,K.jsx)(P.default,{onPress:()=>{s(!0),Te.default.sequence([Te.default.timing(f,{toValue:0,duration:500,useNativeDriver:!0})]).start((()=>{t()}))},activeOpacity:.8,style:no.buttonContainer,children:(0,K.jsx)(Te.default.View,{style:[no.button,{backgroundColor:o.colors.primary},{transform:[{scale:m}]}],children:(0,K.jsx)(ne.default,{style:no.buttonText,children:"Get Started"})})})})]})}const no=B.default.create({container:{flex:1,alignItems:"center",justifyContent:"center",position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.1)",width:"100%",height:"100%",zIndex:1e3},gradient:{position:"absolute",left:0,right:0,top:0,bottom:0,zIndex:-1},welcomeText:{fontSize:32,fontWeight:"bold",marginBottom:8,textAlign:"center"},subtitle:{fontSize:20,marginBottom:24,opacity:.8,textAlign:"center"},iconContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center",height:100,marginBottom:32},iconPressable:{marginHorizontal:12},iconPressed:{opacity:.7},iconWrapper:{width:60,height:60,borderRadius:30,justifyContent:"center",alignItems:"center",borderWidth:2},icon:{fontSize:28},buttonContainer:{marginTop:16},button:{paddingHorizontal:40,paddingVertical:16,borderRadius:30,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},buttonText:{color:"#fff",fontSize:18,fontWeight:"bold"}});var io=o(8787),lo=o(31359),co=o(57165);const uo=18e5,fo=e=>new Promise((t=>setTimeout(t,e))),mo=new Map,go=new Map,ho=e=>{const t=go.get(e);return!!t&&Date.now()<t},yo=async()=>{try{(0,p.getFirestore)()||await fo(100)}catch(Pr){console.error("Error checking Firestore initialization:",Pr),await fo(100)}},po={async createUserProfile(e){await yo();const t=(0,p.doc)(T,"users",e.uid),o={uid:e.uid,email:e.isAnonymous?"guest@example.com":e.email||"",displayName:e.isAnonymous?"Guest User":e.displayName,photoURL:e.photoURL,createdAt:new Date,lastLogin:new Date,isAnonymous:e.isAnonymous,settings:{theme:"system",notifications:!0,language:"en"}};try{await(0,p.setDoc)(t,o,{merge:!0}),mo.set(e.uid,o),go.set(e.uid,Date.now()+uo)}catch(Pr){console.error("Error creating user profile:",Pr),"unavailable"!==Pr.code&&"failed-precondition"!==Pr.code||(console.log("Device is offline, data will be synced when online"),mo.set(e.uid,o),go.set(e.uid,Date.now()+uo))}},async getUserProfile(e){if(!e)return console.error("getUserProfile called with invalid uid"),null;const t=mo.get(e);if(t&&ho(e))return console.log("Using cached profile for user:",e),t;try{await yo();const o=(0,p.doc)(T,"users",e),r=await Promise.race([(0,p.getDoc)(o),new Promise((e=>setTimeout((()=>e(null)),5e3)))]);if(r&&"exists"in r&&r.exists()){const t=r.data();return mo.set(e,t),go.set(e,Date.now()+uo),t}return t||null}catch(Pr){return console.error("Error getting user profile:",Pr),t||null}},async updateUserProfile(e,t){await yo();const o=(0,p.doc)(T,"users",e);let r=0;for(;r<1;)try{const r=Object.assign({},t,{lastLogin:(0,p.serverTimestamp)()});await(0,p.updateDoc)(o,r);const a=mo.get(e);return void(a&&mo.set(e,Object.assign({},a,r)))}catch(Pr){if(console.error(`Error updating user profile (attempt ${r+1}):`,Pr),"unavailable"===Pr.code||"failed-precondition"===Pr.code){console.log("Device is offline, changes will be synced when online");const o=mo.get(e);return void(o&&mo.set(e,Object.assign({},o,t)))}r++,r<1&&await fo(500)}},async updateUserSettings(e,t){await yo();const o=(0,p.doc)(T,"users",e);let r=0;for(;r<1;)try{await(0,p.updateDoc)(o,{settings:t});const r=mo.get(e);return void(r&&mo.set(e,Object.assign({},r,{settings:Object.assign({},r.settings,t)})))}catch(Pr){if(console.error(`Error updating user settings (attempt ${r+1}):`,Pr),"unavailable"===Pr.code||"failed-precondition"===Pr.code){console.log("Device is offline, settings will be synced when online");const o=mo.get(e);return void(o&&mo.set(e,Object.assign({},o,{settings:Object.assign({},o.settings,t)})))}r++,r<1&&await fo(500)}},async isAnonymousUser(e){await yo();try{const t=await this.getUserProfile(e);return t?.isAnonymous||!1}catch(Pr){if(console.error("Error checking anonymous status:",Pr),"unavailable"===Pr.code||"failed-precondition"===Pr.code){console.log("Device is offline, using cached data");const t=mo.get(e);return t?.isAnonymous||!1}return!0}}};function xo(){(0,d.useNavigation)(),(0,R.useTheme)();const[e,t]=(0,r.useState)(""),[a,s]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[l,c]=(0,r.useState)(!1),[u,f]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[y,p]=(0,r.useState)(null),[x,b]=(0,r.useState)(!0),[j,T]=(0,r.useState)(!1),[C,w,S]=lo.useAuthRequest({clientId:"865106052518-26mpbiv13vgjn77ck7dtroo8e57b6jql.apps.googleusercontent.com",responseType:co.ResponseType.Token,scopes:["profile","email"],redirectUri:"https://auth.expo.io/@piyushbhatti32/fresh-task-manager"});(0,r.useEffect)((()=>{D();const e=setTimeout((()=>{b(!1)}),6e3);return()=>clearTimeout(e)}),[]),(0,r.useEffect)((()=>{"success"===w?.type&&v(w.authentication?.accessToken)}),[w]),(0,r.useEffect)((()=>{const e=(0,g.onAuthStateChanged)(k,(e=>{}));return()=>e()}),[]);const D=async()=>{try{const e=await Yt.getItem("user_email"),o=await Yt.getItem("user_password");e&&o&&(t(e),s(o),f(!0),I())}catch(y){console.error("Error retrieving stored credentials:",y)}},I=async()=>{h(!0),p(null);try{await(0,g.signInWithEmailAndPassword)(k,e,a)}catch(y){console.error("Login Error:",y);let t="Login failed. Please check your credentials and try again.";switch(y.code){case"auth/invalid-email":t="Please enter a valid email address.";break;case"auth/user-disabled":t="This account has been disabled. Please contact support.";break;case"auth/user-not-found":t="No account found with this email. Please sign up first.";break;case"auth/wrong-password":t="Incorrect password. Please try again.";break;case"auth/too-many-requests":t="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":t="Network error. Please check your internet connection.";break;default:t="Login failed. Please try again."}p(t),_e.default.alert("Login Failed",t,[{text:"Try Again",onPress:()=>s("")},{text:"Forgot Password",onPress:()=>{_e.default.alert("Coming Soon","Password reset functionality will be available soon.")}},{text:"Cancel",style:"cancel"}])}finally{h(!1)}},v=async e=>{if(e)try{h(!0),p(null);const t=g.GoogleAuthProvider.credential(null,e);await(0,g.signInWithCredential)(k,t)}catch(y){console.error("Google Sign In Error:",y),p("Google sign in failed. Please try again.")}finally{h(!1)}else p("Failed to get access token")},B=async()=>{try{h(!0),p(null);const e=await S();"success"!==e?.type&&p("Google sign in was cancelled or failed")}catch(y){console.error("Google Sign In Error:",y),p("Google sign in failed. Please try again.")}finally{h(!1)}};return x?(0,K.jsx)(so,{onFinish:()=>b(!1)}):(0,K.jsx)(Ke.default,{style:bo.container,behavior:"height",children:(0,K.jsxs)(Ae.default,{contentContainerStyle:bo.scrollContent,children:[(0,K.jsxs)(E.default,{style:bo.headerContainer,children:[(0,K.jsxs)(E.default,{style:bo.logoContainer,children:[(0,K.jsx)(ye.default,{style:bo.logoSurface,children:(0,K.jsx)(eo.default,{source:o(19812),style:bo.logoImage})}),(0,K.jsx)(A.default,{style:bo.appName,children:"Task Manager"})]}),(0,K.jsx)(A.default,{style:bo.tagline,children:"Organize your day, boost your productivity"})]}),(0,K.jsxs)(E.default,{style:bo.formContainer,children:[(0,K.jsx)(to.default,{label:"Email",value:e,onChangeText:t,mode:"outlined",autoCapitalize:"none",keyboardType:"email-address",left:(0,K.jsx)(to.default.Icon,{icon:"email"}),style:bo.input}),(0,K.jsx)(to.default,{label:"Password",value:a,onChangeText:s,mode:"outlined",secureTextEntry:!l,right:(0,K.jsx)(to.default.Icon,{icon:l?"eye-off":"eye",onPress:()=>c(!l)}),left:(0,K.jsx)(to.default.Icon,{icon:"lock"}),style:bo.input}),j&&(0,K.jsx)(to.default,{label:"Confirm Password",value:n,onChangeText:i,mode:"outlined",secureTextEntry:!l,right:(0,K.jsx)(to.default.Icon,{icon:l?"eye-off":"eye",onPress:()=>c(!l)}),left:(0,K.jsx)(to.default.Icon,{icon:"lock"}),style:bo.input}),(0,K.jsxs)(E.default,{style:bo.checkboxContainer,children:[(0,K.jsx)(oo.default,{status:u?"checked":"unchecked",onPress:()=>f(!u)}),(0,K.jsx)(A.default,{style:bo.checkboxLabel,children:"Remember me"}),(0,K.jsx)(P.default,{style:bo.forgotPassword,children:(0,K.jsx)(A.default,{style:bo.forgotPasswordText,children:"Forgot Password?"})})]}),y&&(0,K.jsx)(A.default,{style:bo.errorText,children:y}),(0,K.jsx)(H.default,{mode:"contained",onPress:j?async()=>{if(a!==n)return p("Passwords do not match"),void _e.default.alert("Password Mismatch","The passwords you entered do not match. Please try again.",[{text:"OK"}]);h(!0),p(null);try{const t=await(0,g.createUserWithEmailAndPassword)(k,e,a);await po.createUserProfile(t.user),await(0,g.sendEmailVerification)(t.user),_e.default.alert("Account Created","A verification email has been sent to your email address. Please verify your email to continue.",[{text:"OK",onPress:()=>T(!1)}])}catch(y){console.error("Sign Up Error:",y);let t="Sign up failed. Please try again.";switch(y.code){case"auth/email-already-in-use":t="An account with this email already exists. Please log in instead.";break;case"auth/invalid-email":t="Please enter a valid email address.";break;case"auth/operation-not-allowed":t="Email/password accounts are not enabled. Please contact support.";break;case"auth/weak-password":t="Please choose a stronger password (at least 6 characters).";break;case"auth/network-request-failed":t="Network error. Please check your internet connection.";break;default:t="Sign up failed. Please try again."}p(t),_e.default.alert("Sign Up Failed",t,[{text:"Try Again",onPress:()=>{s(""),i("")}},{text:"Cancel",style:"cancel"}])}finally{h(!1)}}:I,disabled:!(e.includes("@")&&a.length>=6)||m,loading:m,style:bo.loginButton,children:j?"Sign Up":"Log In"}),(0,K.jsxs)(E.default,{style:bo.dividerContainer,children:[(0,K.jsx)(F.default,{style:bo.divider}),(0,K.jsx)(A.default,{style:bo.dividerText,children:"OR"}),(0,K.jsx)(F.default,{style:bo.divider})]}),(0,K.jsx)(H.default,{mode:"outlined",onPress:B,disabled:m,icon:"google",style:bo.googleButton,children:"Continue with Google"}),(0,K.jsx)(H.default,{mode:"outlined",onPress:async()=>{h(!0),p(null);try{const e=await(0,g.signInAnonymously)(k);await po.createUserProfile(e.user)}catch(y){console.error("Guest Login Error:",y);let t="Guest login failed. Please try again.";switch(y.code){case"auth/admin-restricted-operation":t="Guest login is currently disabled. Please sign in with email or Google.";break;case"auth/network-request-failed":t="Network error. Please check your internet connection.";break;case"auth/too-many-requests":t="Too many attempts. Please try again later.";break;default:t="Unable to continue as guest. Please try another sign-in method."}p(t),_e.default.alert("Guest Login Failed",t,[{text:"Try Email Login",onPress:()=>T(!1)},{text:"Try Google Login",onPress:B},{text:"Cancel",style:"cancel"}])}finally{h(!1)}},style:bo.guestButton,children:"Continue as Guest"})]}),(0,K.jsxs)(E.default,{style:bo.footer,children:[(0,K.jsx)(A.default,{style:bo.footerText,children:j?"Already have an account?":"Don't have an account?"}),(0,K.jsx)(P.default,{onPress:()=>T(!j),children:(0,K.jsx)(A.default,{style:bo.signupText,children:j?"Log In":"Sign Up"})})]})]})})}io.maybeCompleteAuthSession();const bo=B.default.create({container:{flex:1,backgroundColor:"#fff"},scrollContent:{flexGrow:1,paddingBottom:24,justifyContent:"center"},headerContainer:{alignItems:"center",padding:32,marginTop:30},logoContainer:{alignItems:"center",marginBottom:16},logoSurface:{width:80,height:80,borderRadius:40,justifyContent:"center",alignItems:"center",elevation:4,marginBottom:16,overflow:"hidden"},logoImage:{width:"100%",height:"100%",resizeMode:"cover"},appName:{fontSize:28,fontWeight:"bold"},tagline:{fontSize:16,textAlign:"center",opacity:.7},formContainer:{padding:24},input:{marginBottom:16},checkboxContainer:{flexDirection:"row",alignItems:"center",marginBottom:24},checkboxLabel:{marginLeft:8},forgotPassword:{marginLeft:"auto"},forgotPasswordText:{color:"#007BFF"},errorText:{color:"red",marginBottom:16},loginButton:{marginBottom:16,paddingVertical:8},guestButton:{marginBottom:16},footer:{flexDirection:"row",justifyContent:"center",alignItems:"center",padding:16},footerText:{marginRight:8},signupText:{color:"#007BFF",fontWeight:"bold"},dividerContainer:{flexDirection:"row",alignItems:"center",marginVertical:20},divider:{flex:1,height:1},dividerText:{marginHorizontal:10,color:"#666"},googleButton:{marginBottom:12,borderColor:"#4285F4"}}),jo=Object.assign({},s.MD3LightTheme,{colors:Object.assign({},s.MD3LightTheme.colors,{primary:"#6200EE",primaryContainer:"#E8DEF8",secondary:"#03DAC6",secondaryContainer:"#CEFAF1",tertiary:"#FB8C00",tertiaryContainer:"#FFE0B2",error:"#B00020",errorContainer:"#FFDAD6",background:"#F6F6F6",surface:"#FFFFFF",surfaceVariant:"#E7E0EC",onPrimary:"#FFFFFF",onPrimaryContainer:"#21005E",onSecondary:"#000000",onSecondaryContainer:"#00332D",onTertiary:"#FFFFFF",onTertiaryContainer:"#000000",onError:"#FFFFFF",onErrorContainer:"#410002",onBackground:"#1C1B1F",onSurface:"#1C1B1F",onSurfaceVariant:"#49454F",onSurfaceDisabled:"#1C1B1F61",elevation:{level0:"transparent",level1:"#F5F5F5",level2:"#EEEEEE",level3:"#E0E0E0",level4:"#BDBDBD",level5:"#9E9E9E"}})}),ko=[{id:"1",name:"John Doe",role:"Project Manager",email:"john.doe@example.com",phone:"+1 (555) 123-4567",avatar:"https://ui-avatars.com/api/?name=John+Doe&background=0066FF&color=fff&size=128"},{id:"2",name:"Sarah Johnson",role:"UI/UX Designer",email:"sarah.johnson@example.com",phone:"+1 (555) 987-6543",avatar:"https://ui-avatars.com/api/?name=Sarah+Johnson&background=0066FF&color=fff&size=128"},{id:"3",name:"Mike Chen",role:"Frontend Developer",email:"mike.chen@example.com",phone:"+1 (555) 456-7890",avatar:"https://ui-avatars.com/api/?name=Mike+Chen&background=0066FF&color=fff&size=128"},{id:"4",name:"Emily Rodriguez",role:"Backend Developer",email:"emily.rodriguez@example.com",phone:"+1 (555) 234-5678",avatar:"https://ui-avatars.com/api/?name=Emily+Rodriguez&background=0066FF&color=fff&size=128"},{id:"5",name:"David Kim",role:"QA Engineer",email:"david.kim@example.com",phone:"+1 (555) 876-5432",avatar:"https://ui-avatars.com/api/?name=David+Kim&background=0066FF&color=fff&size=128"}];function To(){(0,d.useNavigation)();const{tasks:e}=he(),[t,o]=r.useState(""),a=ko.filter((e=>e.name.toLowerCase().includes(t.toLowerCase())||e.role.toLowerCase().includes(t.toLowerCase())));return(0,K.jsxs)(E.default,{style:Co.container,children:[(0,K.jsx)(E.default,{style:Co.header,children:(0,K.jsx)(A.default,{style:Co.title,children:"Team"})}),(0,K.jsx)(E.default,{style:Co.searchContainer,children:(0,K.jsx)(L.default,{placeholder:"Search team members...",onChangeText:o,value:t,style:Co.searchBar,inputStyle:Co.searchInput,iconColor:jo.colors.onSurfaceVariant,placeholderTextColor:jo.colors.onSurfaceVariant,theme:{colors:{text:jo.colors.onSurface}}})}),(0,K.jsx)(ie.default,{data:a,renderItem:({item:t})=>{const o=(r=t.name,e.filter((e=>e.assignee===r)));var r;const a=o.filter((e=>!e.completed)).length,s=o.filter((e=>e.completed)).length;return(0,K.jsxs)(P.default,{style:Co.memberCard,onPress:()=>{console.log(`Team member selected: ${t.name}`)},children:[(0,K.jsx)(eo.default,{source:{uri:t.avatar},style:Co.avatar}),(0,K.jsxs)(E.default,{style:Co.memberInfo,children:[(0,K.jsx)(A.default,{style:Co.memberName,children:t.name}),(0,K.jsx)(A.default,{style:Co.memberRole,children:t.role}),(0,K.jsxs)(E.default,{style:Co.taskStats,children:[(0,K.jsxs)(E.default,{style:Co.taskStat,children:[(0,K.jsx)(A.default,{style:Co.taskStatNumber,children:a}),(0,K.jsx)(A.default,{style:Co.taskStatLabel,children:"Pending"})]}),(0,K.jsxs)(E.default,{style:Co.taskStat,children:[(0,K.jsx)(A.default,{style:Co.taskStatNumber,children:s}),(0,K.jsx)(A.default,{style:Co.taskStatLabel,children:"Completed"})]}),(0,K.jsxs)(E.default,{style:Co.taskStat,children:[(0,K.jsx)(A.default,{style:Co.taskStatNumber,children:o.length}),(0,K.jsx)(A.default,{style:Co.taskStatLabel,children:"Total"})]})]})]})]})},keyExtractor:e=>e.id,contentContainerStyle:Co.membersList,showsVerticalScrollIndicator:!1})]})}const Co=B.default.create({container:{flex:1,backgroundColor:jo.colors.background},header:{paddingHorizontal:16,paddingVertical:16},title:{fontSize:28,fontWeight:"bold",color:jo.colors.onBackground},searchContainer:{paddingHorizontal:16,marginBottom:16},searchBar:{backgroundColor:jo.colors.surface,elevation:0,borderRadius:8},searchInput:{color:jo.colors.onSurface},membersList:{padding:16},memberCard:{backgroundColor:jo.colors.surface,borderRadius:12,padding:16,marginBottom:16,flexDirection:"row",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.15,shadowRadius:3,elevation:2},avatar:{width:64,height:64,borderRadius:32,marginRight:16,backgroundColor:jo.colors.primary},memberInfo:{flex:1},memberName:{fontSize:18,fontWeight:"600",color:jo.colors.onSurface,marginBottom:4},memberRole:{fontSize:14,color:jo.colors.onSurfaceVariant,marginBottom:12},taskStats:{flexDirection:"row",justifyContent:"space-between"},taskStat:{alignItems:"center"},taskStatNumber:{fontSize:16,fontWeight:"700",color:jo.colors.onSurface},taskStatLabel:{fontSize:12,color:jo.colors.onSurfaceVariant}});var wo=o(26062),So=o(11377);const Do=(0,de.create)()((0,So.persist)(((e,t)=>({groups:[],invitations:[],createGroup:(t,o,r,a,s)=>{const n={id:Date.now().toString(),name:t,description:o,members:[{id:r,name:a,email:s,role:"admin"}],tasks:[],createdAt:Date.now()};return e((e=>({groups:[...e.groups,n]}))),n},updateGroup:(t,o)=>{e((e=>({groups:e.groups.map((e=>e.id===t?Object.assign({},e,o):e))})))},deleteGroup:t=>{e((e=>({groups:e.groups.filter((e=>e.id!==t))})))},addMember:(t,o)=>{e((e=>({groups:e.groups.map((e=>e.id===t?Object.assign({},e,{members:[...e.members,o]}):e))})))},removeMember:(t,o)=>{e((e=>({groups:e.groups.map((e=>e.id===t?Object.assign({},e,{members:e.members.filter((e=>e.id!==o))}):e))})))},addTask:(t,o)=>{e((e=>({groups:e.groups.map((e=>e.id===t?Object.assign({},e,{tasks:[...e.tasks,o]}):e))})))},updateTask:(t,o,r)=>{e((e=>({groups:e.groups.map((e=>e.id===t?Object.assign({},e,{tasks:e.tasks.map((e=>e.id===o?Object.assign({},e,r):e))}):e))})))},deleteTask:(t,o)=>{e((e=>({groups:e.groups.map((e=>e.id===t?Object.assign({},e,{tasks:e.tasks.filter((e=>e.id!==o))}):e))})))},createInvitation:(t,o,r,a)=>{const s={id:Date.now().toString(),groupId:t,groupName:o,invitedBy:r,invitedEmail:a,status:"pending",createdAt:Date.now()};return e((e=>({invitations:[...e.invitations,s]}))),s},updateInvitationStatus:(o,r)=>{if(e((e=>({invitations:e.invitations.map((e=>e.id===o?Object.assign({},e,{status:r}):e))}))),"accepted"===r){t().invitations.find((e=>e.id===o))}}})),{name:"group-storage"})),Io=(0,r.createContext)(void 0),vo=B.default.create({container:{flex:1,backgroundColor:"#000",padding:16},searchBar:{marginBottom:16,backgroundColor:"#111",borderRadius:8},sectionTitle:{fontSize:20,fontWeight:"bold",color:"#fff",marginBottom:12,marginTop:8},groupsList:{paddingBottom:80},groupCard:{marginBottom:16,backgroundColor:"#111",borderRadius:8},groupHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},groupTitleContainer:{flexDirection:"row",alignItems:"center",flex:1},groupName:{fontSize:18,fontWeight:"bold",color:"#fff",marginRight:8},adminChip:{backgroundColor:"#3498db",height:24},groupDescription:{color:"#ccc",marginBottom:16},statsContainer:{flexDirection:"row",marginBottom:16},stat:{marginRight:24},statNumber:{fontSize:18,fontWeight:"bold",color:"#3498db"},statLabel:{fontSize:14,color:"#999"},memberAvatars:{flexDirection:"row"},memberAvatar:{marginLeft:-8,backgroundColor:"#3498db"},invitationsContainer:{marginBottom:16},invitationsList:{paddingRight:16},invitationCard:{width:280,marginRight:12,backgroundColor:"#111",borderRadius:8,borderLeftWidth:4,borderLeftColor:"#3498db"},invitationTitle:{fontSize:16,color:"#fff",marginBottom:12},invitationActions:{flexDirection:"row"},acceptButton:{marginRight:8,backgroundColor:"#3498db"},declineButton:{borderColor:"#666"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyTitle:{fontSize:20,fontWeight:"bold",color:"#fff",marginBottom:8},emptySubtitle:{fontSize:16,color:"#ccc",textAlign:"center",marginBottom:24},createButton:{backgroundColor:"#3498db"},fab:{position:"absolute",margin:16,right:0,bottom:0,backgroundColor:"#3498db"}}),Eo=()=>{const e=(0,d.useNavigation)(),{groups:t,invitations:o}=Do(),{user:a}=(()=>{const e=(0,r.useContext)(Io);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e})(),[s,n]=(0,r.useState)(""),[i,l]=(0,r.useState)(null),c=t.filter((e=>e.name.toLowerCase().includes(s.toLowerCase())||e.description.toLowerCase().includes(s.toLowerCase()))),u=o.filter((e=>"pending"===e.status&&e.invitedEmail===a?.email)),f=t=>{e.navigate("GroupDetail",{groupId:t})},m=()=>{e.navigate("CreateGroup")},g=(e,t)=>{const{updateInvitationStatus:o}=Do.getState();o(e,t?"accepted":"declined")},h=()=>l(null);return(0,K.jsxs)(E.default,{style:vo.container,children:[(0,K.jsx)(L.default,{placeholder:"Search groups...",onChangeText:n,value:s,style:vo.searchBar,iconColor:"#3498db"}),u.length>0&&(0,K.jsxs)(E.default,{style:vo.invitationsContainer,children:[(0,K.jsx)(A.default,{style:vo.sectionTitle,children:"Invitations"}),(0,K.jsx)(ie.default,{data:u,keyExtractor:e=>e.id,renderItem:({item:e})=>(0,K.jsx)(Be.default,{style:vo.invitationCard,children:(0,K.jsxs)(Be.default.Content,{children:[(0,K.jsxs)(A.default,{style:vo.invitationTitle,children:["You've been invited to join \"",e.groupName,'"']}),(0,K.jsxs)(E.default,{style:vo.invitationActions,children:[(0,K.jsx)(H.default,{mode:"contained",onPress:()=>g(e.id,!0),style:vo.acceptButton,children:"Accept"}),(0,K.jsx)(H.default,{mode:"outlined",onPress:()=>g(e.id,!1),style:vo.declineButton,children:"Decline"})]})]})}),horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:vo.invitationsList})]}),(0,K.jsx)(A.default,{style:vo.sectionTitle,children:"My Groups"}),c.length>0?(0,K.jsx)(ie.default,{data:c,keyExtractor:e=>e.id,renderItem:({item:t})=>{const o=t.members.some((e=>e.id===a?.id&&"admin"===e.role));return(0,K.jsx)(Be.default,{style:vo.groupCard,onPress:()=>f(t.id),children:(0,K.jsxs)(Be.default.Content,{children:[(0,K.jsxs)(E.default,{style:vo.groupHeader,children:[(0,K.jsxs)(E.default,{style:vo.groupTitleContainer,children:[(0,K.jsx)(A.default,{style:vo.groupName,children:t.name}),o&&(0,K.jsx)(z.default,{compact:!0,style:vo.adminChip,children:"Admin"})]}),(0,K.jsxs)(N.default,{visible:i===t.id,onDismiss:h,anchor:(0,K.jsx)(O.default,{icon:"dots-vertical",onPress:()=>{return e=t.id,l(e);var e}}),children:[(0,K.jsx)(N.default.Item,{title:"View Details",onPress:()=>{h(),f(t.id)}}),o&&(0,K.jsx)(N.default.Item,{title:"Invite Members",onPress:()=>{h(),e.navigate("InviteMembers",{groupId:t.id})}}),o&&(0,K.jsx)(N.default.Item,{title:"Delete Group",onPress:()=>{h(),Do.getState().deleteGroup(t.id)}})]})]}),(0,K.jsx)(A.default,{style:vo.groupDescription,children:t.description}),(0,K.jsxs)(E.default,{style:vo.statsContainer,children:[(0,K.jsxs)(E.default,{style:vo.stat,children:[(0,K.jsx)(A.default,{style:vo.statNumber,children:t.members.length}),(0,K.jsx)(A.default,{style:vo.statLabel,children:"Members"})]}),(0,K.jsxs)(E.default,{style:vo.stat,children:[(0,K.jsx)(A.default,{style:vo.statNumber,children:t.tasks.length}),(0,K.jsx)(A.default,{style:vo.statLabel,children:"Tasks"})]})]}),(0,K.jsxs)(E.default,{style:vo.memberAvatars,children:[t.members.slice(0,3).map(((e,t)=>(0,K.jsx)(Xt.default,{size:36,label:e.name.substring(0,2).toUpperCase(),style:[vo.memberAvatar,{zIndex:5-t}]},e.id))),t.members.length>3&&(0,K.jsx)(Xt.default,{size:36,label:"+"+(t.members.length-3),style:[vo.memberAvatar,{zIndex:1}]})]})]})})},showsVerticalScrollIndicator:!1,contentContainerStyle:vo.groupsList}):(0,K.jsxs)(E.default,{style:vo.emptyContainer,children:[(0,K.jsx)(A.default,{style:vo.emptyTitle,children:"No Groups Yet"}),(0,K.jsx)(A.default,{style:vo.emptySubtitle,children:"Create a group to collaborate with your team"}),(0,K.jsx)(H.default,{mode:"contained",onPress:m,style:vo.createButton,icon:"plus",children:"Create a Group"})]}),(0,K.jsx)(wo.default,{icon:"plus",style:vo.fab,onPress:m,color:"#fff"})]})},Bo=[{id:"meeting",name:"Meeting",icon:"calendar-account",color:"#4285F4"},{id:"email",name:"Email",icon:"email-outline",color:"#EA4335"},{id:"call",name:"Call",icon:"phone",color:"#34A853"},{id:"deadline",name:"Deadline",icon:"clock-time-four-outline",color:"#FBBC05"},{id:"reminder",name:"Reminder",icon:"bell-outline",color:"#805AD5"}];function Po(){const e=(0,d.useNavigation)(),t=(0,d.useRoute)().params,{addTask:o,fetchTasks:a,templates:s=[],createTaskFromTemplate:n}=he(),[i,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)(!1),[f,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)([]);(0,r.useEffect)((()=>{if(t?.templateId){const e=s.find((e=>e.id===t.templateId));e&&y(e)}s.length>0&&h(s.slice(0,3))}),[t?.templateId,s]);const y=async t=>{try{m(!0),await n(t),_e.default.alert("Task Created","A new task has been created from the template.",[{text:"OK",onPress:()=>{e.canGoBack()?e.goBack():e.navigate("MainTabs",{screen:"Home"})}}])}catch(Pr){console.error("Error using template:",Pr),_e.default.alert("Error","Failed to create task from template")}finally{m(!1)}},p=(e="medium")=>{switch(e.toLowerCase()){case"high":return"#FF5252";case"medium":return"#FFB300";case"low":return"#69F0AE";default:return"#BDBDBD"}};return(0,K.jsxs)(E.default,{style:[Ro.container,{backgroundColor:jo.colors.background}],children:[f&&(0,K.jsx)(E.default,{style:Ro.loadingOverlay,children:(0,K.jsx)(le.default,{size:"large",color:jo.colors.primary})}),(0,K.jsx)(ht,{isVisible:i,onClose:()=>e.goBack(),onSave:async t=>{try{m(!0);const r=Object.assign({},t,{title:t.title||"",description:t.description||"",priority:t.priority||"low",completed:t.completed||!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});await o(r),await new Promise((e=>setTimeout(e,100))),e.canGoBack()?e.goBack():e.navigate("MainTabs",{screen:"Home"})}catch(Pr){console.error("Error creating task:",Pr),_e.default.alert("Error","Failed to create task. Please try again.")}finally{m(!1)}}}),(0,K.jsx)(E.default,{style:Ro.floatingActions,children:(0,K.jsx)(P.default,{style:[Ro.floatingButton,{backgroundColor:jo.colors.surface}],onPress:()=>u(!0),children:(0,K.jsx)(Ee.default,{name:"lightning-bolt",size:24,color:jo.colors.primary})})}),(0,K.jsx)(ve.default,{visible:c,transparent:!0,animationType:"slide",onRequestClose:()=>u(!1),children:(0,K.jsx)(E.default,{style:Ro.modalOverlay,children:(0,K.jsxs)(E.default,{style:Ro.templateSelector,children:[(0,K.jsxs)(E.default,{style:Ro.modalHeader,children:[(0,K.jsx)(ne.default,{style:Ro.modalTitle,children:"Create Task From Template"}),(0,K.jsx)(P.default,{onPress:()=>u(!1),children:(0,K.jsx)(Ee.default,{name:"close",size:24,color:"#000"})})]}),(0,K.jsx)(ne.default,{style:Ro.sectionTitle,children:"Quick Create"}),(0,K.jsx)(E.default,{style:Ro.quickActions,children:Bo.map((t=>(0,K.jsxs)(P.default,{style:[Ro.quickAction,{backgroundColor:t.color+"20"}],onPress:()=>{(async t=>{try{m(!0);const r=Bo.find((e=>e.id===t));if(!r)return;const a=new Date,s=new Date;s.setHours(a.getHours()+2);const n={title:`New ${r.name}`,description:"",priority:"deadline"===t?"high":"medium",dueDate:s.toISOString(),completed:!1};await o(n),_e.default.alert("Quick Task Created",`A new ${r.name.toLowerCase()} task has been created.`,[{text:"OK",onPress:()=>{e.canGoBack()?e.goBack():e.navigate("MainTabs",{screen:"Home"})}}])}catch(Pr){console.error("Error creating quick task:",Pr),_e.default.alert("Error","Failed to create quick task. Please try again.")}finally{m(!1)}})(t.id),u(!1)},children:[(0,K.jsx)(Ee.default,{name:t.icon,size:24,color:t.color}),(0,K.jsx)(ne.default,{style:[Ro.quickActionText,{color:t.color}],children:t.name})]},t.id)))}),(0,K.jsx)(F.default,{style:Ro.divider}),g.length>0&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ne.default,{style:Ro.sectionTitle,children:"Recent Templates"}),(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:Ro.recentTemplates,children:g.map((e=>(0,K.jsxs)(P.default,{style:[Ro.recentTemplate,{borderLeftColor:p(e.priority)}],onPress:()=>{y(e),u(!1)},children:[(0,K.jsx)(Ee.default,{name:"file-document-outline",size:20,color:p(e.priority)}),(0,K.jsx)(ne.default,{style:Ro.recentTemplateName,numberOfLines:1,children:e.name})]},e.id)))}),(0,K.jsx)(F.default,{style:Ro.divider})]}),(0,K.jsx)(ne.default,{style:Ro.sectionTitle,children:"All Templates"}),(0,K.jsx)(Ae.default,{style:Ro.templateList,children:0===s.length?(0,K.jsxs)(E.default,{style:Ro.emptyState,children:[(0,K.jsx)(Ee.default,{name:"file-document-outline",size:48,color:"#888"}),(0,K.jsx)(ne.default,{style:Ro.emptyText,children:"No templates found"}),(0,K.jsx)(ne.default,{style:Ro.emptySubtext,children:"Create templates in the Templates tab"})]}):s.map((e=>(0,K.jsxs)(P.default,{style:[Ro.templateItem,{borderLeftColor:p(e.priority),borderLeftWidth:4}],onPress:()=>{y(e),u(!1)},children:[(0,K.jsxs)(E.default,{children:[(0,K.jsx)(ne.default,{style:Ro.templateName,children:e.name}),(0,K.jsx)(ne.default,{style:Ro.templateDesc,numberOfLines:2,children:e.description||e.title}),e.subtasks&&e.subtasks.length>0&&(0,K.jsxs)(ne.default,{style:Ro.templateMeta,children:[e.subtasks.length," subtasks"]})]}),(0,K.jsx)(Ee.default,{name:"arrow-right",size:24,color:"#888"})]},e.id)))}),(0,K.jsx)(H.default,{mode:"outlined",onPress:()=>{e.navigate("MainTabs",{screen:"Templates"}),u(!1)},style:Ro.browseButton,children:"Manage Templates"})]})})})]})}const Ro=B.default.create({container:{flex:1},loadingOverlay:Object.assign({},B.default.absoluteFillObject,{backgroundColor:"rgba(0,0,0,0.2)",justifyContent:"center",alignItems:"center",zIndex:1e3}),floatingActions:{position:"absolute",right:16,bottom:80,flexDirection:"row"},floatingButton:{width:56,height:56,borderRadius:28,backgroundColor:"#fff",justifyContent:"center",alignItems:"center",elevation:4,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:3,marginLeft:16},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"flex-end"},templateSelector:{backgroundColor:"#fff",borderTopLeftRadius:16,borderTopRightRadius:16,padding:16,maxHeight:"85%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#eee"},modalTitle:{fontSize:20,fontWeight:"bold"},sectionTitle:{fontSize:16,fontWeight:"bold",marginBottom:12,color:"#333"},quickActions:{flexDirection:"row",flexWrap:"wrap",marginBottom:16},quickAction:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,borderRadius:16,marginRight:8,marginBottom:8},quickActionText:{marginLeft:8,fontWeight:"500"},divider:{marginVertical:16},recentTemplates:{flexDirection:"row",marginBottom:8},recentTemplate:{flexDirection:"row",alignItems:"center",backgroundColor:"#f5f5f5",paddingHorizontal:12,paddingVertical:8,borderRadius:16,marginRight:8,borderLeftWidth:3},recentTemplateName:{marginLeft:8,fontWeight:"500",maxWidth:120},templateList:{marginBottom:16,maxHeight:350},templateItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,backgroundColor:"#f8f8f8",borderRadius:8,marginBottom:12,elevation:1},templateName:{fontSize:16,fontWeight:"bold",marginBottom:4},templateDesc:{fontSize:14,color:"#666",marginBottom:4},templateMeta:{fontSize:12,color:"#888"},emptyState:{alignItems:"center",justifyContent:"center",padding:32},emptyText:{fontSize:18,fontWeight:"bold",marginTop:16,marginBottom:8},emptySubtext:{fontSize:14,color:"#666",textAlign:"center"},browseButton:{marginTop:8,marginBottom:8}});var Ao=o(12686),zo=o(2469);function Lo(){const e=(0,d.useNavigation)(),t=(0,d.useRoute)(),{taskId:o}=t.params,{tasks:a,updateTask:s}=he(),[n,i]=(0,r.useState)(null),[l,c]=(0,r.useState)(!0),[u,f]=(0,r.useState)(null),[m,g]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{if(!o||"string"!==typeof o)return console.error("Invalid task ID:",o),f("Invalid task ID"),void g(!0);const e=a.find((e=>e.id===o));e?(console.log("EditTaskScreen - Loading task:",e),i(e)):(console.error("Task not found with ID:",o),f("Task not found"),g(!0))}catch(e){console.error("Error loading task:",e),f("Failed to load task"),g(!0)}finally{c(!1)}})()}),[o,a]);return l?(0,K.jsx)(E.default,{style:[Oo.container,Oo.centered],children:(0,K.jsx)(Ao.default,{size:"large"})}):n?(0,K.jsxs)(E.default,{style:Oo.container,children:[(0,K.jsx)(M.default,{children:(0,K.jsx)(ht,{task:n,isVisible:!0,onClose:()=>e.goBack(),onSave:async t=>{try{if(!t.id||"string"!==typeof t.id)throw new Error("Invalid task ID");c(!0),console.log("EditTaskScreen - Saving task:",t),await s(Object.assign({},t,{id:o})),e.goBack()}catch(u){console.error("Error updating task:",u),f(u instanceof Error?u.message:"Failed to update task"),g(!0)}finally{c(!1)}}})}),(0,K.jsx)(zo.default,{visible:m,onDismiss:()=>g(!1),duration:3e3,action:{label:"Close",onPress:()=>g(!1)},children:u})]}):null}const Oo=B.default.create({container:{flex:1},centered:{justifyContent:"center",alignItems:"center"}});var No=o(15558),Fo=o(99599),Mo=o(74352),Wo=o(10874),Vo=o(49050);const Ho=o.p+"static/media/default-avatar.33e7df0963941edbeb70.png",Uo=()=>{const[e]=(0,r.useState)(new Te.default.Value(.3));(0,r.useEffect)((()=>{Te.default.loop(Te.default.sequence([Te.default.timing(e,{toValue:.8,duration:800,useNativeDriver:!0}),Te.default.timing(e,{toValue:.3,duration:800,useNativeDriver:!0})])).start()}),[]);const t=({style:t})=>(0,K.jsx)(Te.default.View,{style:[t,{opacity:e}]});return(0,K.jsxs)(E.default,{style:Xo.container,children:[(0,K.jsxs)(E.default,{style:Xo.header,children:[(0,K.jsx)(t,{style:Xo.avatarSkeleton}),(0,K.jsx)(t,{style:Xo.buttonSkeleton})]}),(0,K.jsxs)(E.default,{style:Xo.form,children:[(0,K.jsx)(t,{style:Xo.inputSkeleton}),(0,K.jsx)(t,{style:Xo.textSkeleton}),(0,K.jsx)(F.default,{style:Xo.divider}),(0,K.jsx)(t,{style:Xo.subheaderSkeleton}),(0,K.jsx)(t,{style:Xo.listItemSkeleton}),(0,K.jsx)(t,{style:Xo.listItemSkeleton}),(0,K.jsx)(t,{style:Xo.listItemSkeleton})]})]})},$o=e=>({uid:e.uid,email:e.email||"",displayName:e.displayName||"New User",photoURL:null,createdAt:new Date,lastLogin:new Date,isEmailVerified:!!e.emailVerified,isAnonymous:!!e.isAnonymous,settings:{theme:"system",notifications:!0,language:"en",taskView:"list"}});function Go({navigation:e}){const[t,o]=(0,r.useState)(null),[a,s]=(0,r.useState)(!0),[n,i]=(0,r.useState)(""),[l,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),[f,m]=(0,r.useState)(null),h=(0,r.useCallback)((async()=>{const e=k.currentUser;if(e)try{const t=await po.getUserProfile(e.uid);if(t)o(t),i(t.displayName||"");else{const t=$o(e);o(t),i(t.displayName)}}catch(Pr){if(console.error("Error loading profile:",Pr),e){const t=$o(e);o(t),i(t.displayName)}console.log("Profile loading failed, using default profile")}finally{s(!1)}else s(!1)}),[]);(0,r.useEffect)((()=>{const e=k.currentUser;e&&(async e=>{try{if(mo.has(e)&&ho(e))return;await po.getUserProfile(e),console.log("Profile preloaded successfully for user:",e)}catch(Pr){console.error("Error preloading profile:",Pr)}})(e.uid).catch((e=>console.error("Error preloading profile:",e)))}),[]),(0,r.useEffect)((()=>{const e=setTimeout((()=>{if(a&&(s(!1),!t&&k.currentUser)){const e=k.currentUser,t=$o(e);o(t),i(t.displayName),setTimeout((()=>{h()}),1e3)}}),2e3);return h(),()=>clearTimeout(e)}),[h]);const y=(0,r.useCallback)((async()=>{const e=k.currentUser;if(e&&t){s(!0);try{await po.updateUserProfile(e.uid,{displayName:n}),await h(),_e.default.alert("Success","Profile updated successfully")}catch(Pr){console.error("Error updating profile:",Pr),_e.default.alert("Error","Failed to update profile")}finally{s(!1)}}}),[n,t,h]),p=(0,r.useCallback)((async()=>{const e=k.currentUser;if(e){s(!0);try{await(0,g.sendEmailVerification)(e),_e.default.alert("Verification Email Sent","Please check your email to verify your account")}catch(Pr){console.error("Error sending verification email:",Pr),_e.default.alert("Error","Failed to send verification email")}finally{s(!1)}}}),[]),x=(0,r.useCallback)((async()=>{const{status:e}=await Wo.requestMediaLibraryPermissionsAsync();if("granted"!==e)return void _e.default.alert("Permission needed","Please grant permission to access photos");const t=await Wo.launchImageLibraryAsync({mediaTypes:Vo.MediaTypeOptions.Images,allowsEditing:!0,aspect:[1,1],quality:.8});if(!t.canceled&&t.assets[0].uri){s(!0);try{const e=t.assets[0].uri;await po.updateUserProfile(k.currentUser.uid,{photoURL:e}),await h()}catch(Pr){console.error("Error updating profile picture:",Pr),_e.default.alert("Error","Failed to update profile picture")}finally{s(!1)}}}),[h]),b=(0,r.useCallback)((e=>{u(e),m(Object.assign({},t?.settings)),d(!0)}),[t?.settings]),j=(0,r.useCallback)((async()=>{if(t&&k.currentUser){s(!0);try{await po.updateUserProfile(k.currentUser.uid,{settings:f}),await h(),d(!1)}catch(Pr){console.error("Error updating settings:",Pr),_e.default.alert("Error","Failed to update settings")}finally{s(!1)}}}),[t,f,h]),T=(0,r.useCallback)((async e=>{if(t&&k.currentUser)try{await po.updateUserProfile(k.currentUser.uid,{settings:Object.assign({},t.settings,{notifications:e})}),await h()}catch(Pr){console.error("Error updating notifications:",Pr),_e.default.alert("Error","Failed to update notification settings")}}),[t,h]),C=(0,r.useMemo)((()=>t?.photoURL?{uri:t.photoURL}:Ho),[t?.photoURL]);return a?(0,K.jsx)(Uo,{}):t?(0,K.jsx)(Ke.default,{style:Xo.container,behavior:"height",children:(0,K.jsxs)(Ae.default,{contentContainerStyle:Xo.scrollContent,children:[(0,K.jsxs)(E.default,{style:Xo.header,children:[(0,K.jsx)(No.default,{size:100,source:C}),(0,K.jsx)(H.default,{mode:"outlined",onPress:x,style:Xo.changePhotoButton,children:"Change Photo"})]}),(0,K.jsxs)(E.default,{style:Xo.form,children:[(0,K.jsx)(to.default,{label:"Display Name",value:n,onChangeText:i,mode:"outlined",style:Xo.input}),(0,K.jsx)(A.default,{style:Xo.emailText,children:t.email}),!t.isEmailVerified&&(0,K.jsx)(H.default,{mode:"contained",onPress:p,loading:a,style:Xo.verifyButton,children:"Verify Email"}),(0,K.jsx)(F.default,{style:Xo.divider}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{children:"Settings"}),(0,K.jsx)(I.default,{title:"Theme",description:t.settings.theme,onPress:()=>b("theme"),right:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"chevron-right"}))}),(0,K.jsx)(I.default,{title:"Task View",description:t.settings.taskView,onPress:()=>b("taskView"),right:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"chevron-right"}))}),(0,K.jsx)(I.default,{title:"Notifications",right:()=>(0,K.jsx)(Fo.default,{value:t.settings.notifications,onValueChange:T})}),(0,K.jsx)(I.default,{title:"Accessibility",onPress:()=>b("accessibility"),right:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"chevron-right"}))}),(0,K.jsx)(I.default,{title:"Privacy",onPress:()=>b("privacy"),right:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"chevron-right"}))}),(0,K.jsx)(I.default,{title:"Work Hours",onPress:()=>b("workHours"),right:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"chevron-right"}))})]}),(0,K.jsx)(H.default,{mode:"contained",onPress:y,loading:a,style:Xo.saveButton,children:"Save Changes"})]}),(0,K.jsx)(M.default,{children:(0,K.jsxs)(V.default,{visible:l,onDismiss:()=>d(!1),children:[(0,K.jsx)(V.default.Title,{children:c.charAt(0).toUpperCase()+c.slice(1)}),(0,K.jsx)(V.default.Content,{children:"theme"===c&&(0,K.jsx)(Mo.default,{value:f?.theme||"system",onValueChange:e=>m(Object.assign({},f,{theme:e})),buttons:[{value:"light",label:"Light"},{value:"dark",label:"Dark"},{value:"system",label:"System"}]})}),(0,K.jsxs)(V.default.Actions,{children:[(0,K.jsx)(H.default,{onPress:()=>d(!1),children:"Cancel"}),(0,K.jsx)(H.default,{onPress:j,children:"Save"})]})]})})]})}):(0,K.jsx)(Uo,{})}const Xo=B.default.create({container:{flex:1,backgroundColor:"#fff"},scrollContent:{flexGrow:1,padding:16},header:{alignItems:"center",marginBottom:24},changePhotoButton:{marginTop:8},form:{flex:1},input:{marginBottom:16},emailText:{fontSize:16,marginBottom:8},verifyButton:{marginBottom:16},divider:{marginVertical:16},saveButton:{marginTop:24},centerContent:{justifyContent:"center",alignItems:"center"},loadingText:{marginTop:16,fontSize:16,color:"#666"},errorText:{fontSize:16,color:"#ff0000",marginBottom:16},retryButton:{marginTop:8},avatarSkeleton:{width:100,height:100,borderRadius:50,backgroundColor:"#ddd"},buttonSkeleton:{width:120,height:36,borderRadius:4,backgroundColor:"#ddd",marginTop:10},inputSkeleton:{width:"100%",height:56,borderRadius:4,backgroundColor:"#ddd",marginBottom:20},textSkeleton:{width:"80%",height:20,borderRadius:4,backgroundColor:"#ddd",marginBottom:20},subheaderSkeleton:{width:"50%",height:24,borderRadius:4,backgroundColor:"#ddd",marginBottom:16},listItemSkeleton:{width:"100%",height:56,borderRadius:4,backgroundColor:"#ddd",marginBottom:12}});var qo=o(88819),_o=o(59062);const Yo=e=>{if(!e)return"Unknown";const t="string"===typeof e?new Date(e):e;return(0,Le.isToday)(t)?"Today":(0,Ne.isYesterday)(t)?"Yesterday":(0,qo.isThisWeek)(t)?(0,xe.format)(t,"EEEE"):(0,_o.isThisMonth)(t)?(0,xe.format)(t,"MMMM d"):(0,xe.format)(t,"MMM d, yyyy")},Ko=[{id:"recent",label:"Most Recent",icon:"clock"},{id:"oldest",label:"Oldest First",icon:"clock-outline"},{id:"title",label:"By Title",icon:"sort-alphabetical-ascending"},{id:"priority",label:"By Priority",icon:"alert-circle-outline"},{id:"dueDate",label:"By Due Date",icon:"calendar"},{id:"subtasks",label:"By Subtasks",icon:"format-list-checks"}];function Qo(){const e=(0,d.useNavigation)(),{tasks:t,updateTask:o,fetchTasks:a}=he(),{theme:s}=Z(),n=(0,R.useTheme)(),i=s?.colors||n.colors,[l,c]=(0,r.useState)("recent"),[u,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)("all"),[h,y]=(0,r.useState)(!1),[p,x]=(0,r.useState)([]),[b,j]=(0,r.useState)(!0),[k,T]=(0,r.useState)(!1),[C,w]=(0,r.useState)(null),S=(0,r.useMemo)((()=>{let e=t.filter((e=>e.completed));return"all"!==m&&(e=e.filter((e=>{const t=new Date(String(e.updatedAt));switch(m){case"today":return(0,Le.isToday)(t);case"week":return(0,qo.isThisWeek)(t);case"month":return(0,_o.isThisMonth)(t);default:return!0}}))),[...e].sort(((e,t)=>{let o=0;switch(l){case"recent":o=new Date(String(t.updatedAt)).getTime()-new Date(String(e.updatedAt)).getTime();break;case"oldest":o=new Date(String(e.updatedAt)).getTime()-new Date(String(t.updatedAt)).getTime();break;case"title":o=e.title.localeCompare(t.title);break;case"priority":const r={high:3,medium:2,low:1};o=(r[t.priority||"low"]||0)-(r[e.priority||"low"]||0);break;case"dueDate":o=(e.dueDate?new Date(e.dueDate).getTime():0)-(t.dueDate?new Date(t.dueDate).getTime():0);break;case"subtasks":o=(t.subtasks?.length||0)-(e.subtasks?.length||0);break;default:o=0}return u?o:-o}))}),[t,m,l,u]),D=(0,r.useMemo)((()=>({total:S.length,today:S.filter((e=>(0,Le.isToday)(new Date(String(e.updatedAt))))).length,thisWeek:S.filter((e=>(0,qo.isThisWeek)(new Date(String(e.updatedAt))))).length,thisMonth:S.filter((e=>(0,_o.isThisMonth)(new Date(String(e.updatedAt))))).length})),[S]),I=e=>{x((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},v=()=>(0,K.jsx)(E.default,{style:Jo.sortContainer,children:(0,K.jsxs)(P.default,{style:Jo.sortButton,onPress:e=>{const{pageX:t,pageY:o}=e.nativeEvent;w({x:t,y:o}),y(!0)},children:[(0,K.jsx)(Ee.default,{name:"sort",size:20,color:i.onSurfaceVariant}),(0,K.jsxs)(A.default,{style:[Jo.sortButtonText,{color:i.onSurfaceVariant}],children:["Sort: ",Ko.find((e=>e.id===l))?.label]}),(0,K.jsx)(Ee.default,{name:u?"arrow-up":"arrow-down",size:16,color:i.onSurfaceVariant,style:{marginLeft:4}})]})});return(0,K.jsxs)(E.default,{style:[Jo.container,{backgroundColor:i.background}],children:[(0,K.jsx)(ie.default,{data:S,renderItem:({item:t})=>(0,K.jsx)(ye.default,{style:[Jo.taskItem,{backgroundColor:i.surface}],children:(0,K.jsxs)(P.default,{style:Jo.taskContent,onPress:()=>{return o=t.id,void e.navigate("TaskDetail",{taskId:o});var o},onLongPress:()=>I(t.id),children:[(0,K.jsxs)(E.default,{style:Jo.taskHeader,children:[(0,K.jsxs)(E.default,{style:Jo.titleContainer,children:[(0,K.jsx)(O.default,{icon:p.includes(t.id)?"checkbox-marked":"checkbox-blank-outline",size:20,onPress:()=>I(t.id),style:Jo.checkbox}),(0,K.jsx)(A.default,{style:[Jo.taskTitle,{color:i.onSurface}],numberOfLines:1,children:t.title})]}),(0,K.jsx)(z.default,{icon:"check-circle",compact:!0,style:[Jo.completedChip,{backgroundColor:i.primaryContainer}],children:Yo(t.updatedAt)})]}),t.description&&(0,K.jsx)(A.default,{style:[Jo.description,{color:i.onSurfaceVariant}],numberOfLines:2,children:t.description}),(0,K.jsxs)(E.default,{style:Jo.taskMeta,children:[t.updatedAt&&(0,K.jsxs)(A.default,{style:[Jo.metaText,{color:i.onSurfaceVariant}],children:["Completed: ",(0,xe.format)(new Date(t.updatedAt),"MMM d, yyyy h:mm a")]}),t.dueDate&&(0,K.jsxs)(A.default,{style:[Jo.metaText,{color:i.onSurfaceVariant}],children:["\u2022 Due: ",(0,xe.format)(new Date(t.dueDate),"MMM d, yyyy")]}),t.subtasks&&t.subtasks.length>0&&(0,K.jsxs)(A.default,{style:[Jo.metaText,{color:i.onSurfaceVariant}],children:["\u2022 ",t.subtasks.length," subtasks"]})]})]})}),keyExtractor:e=>e.id,contentContainerStyle:Jo.listContent,ListHeaderComponent:()=>(0,K.jsxs)(E.default,{style:Jo.header,children:[(0,K.jsxs)(E.default,{style:Jo.headerTop,children:[(0,K.jsxs)(E.default,{children:[(0,K.jsx)(A.default,{style:[Jo.title,{color:i.onBackground}],children:"Completed Tasks"}),(0,K.jsxs)(A.default,{style:[Jo.subtitle,{color:i.onSurfaceVariant}],children:[D.total," task",1!==D.total?"s":""," completed"]})]}),(0,K.jsx)(O.default,{icon:b?"chevron-up":"chevron-down",onPress:()=>j(!b)})]}),b&&(0,K.jsxs)(E.default,{style:Jo.statsContainer,children:[(0,K.jsxs)(ye.default,{style:[Jo.statCard,{backgroundColor:i.primaryContainer}],children:[(0,K.jsx)(A.default,{style:[Jo.statValue,{color:i.onPrimaryContainer}],children:D.today}),(0,K.jsx)(A.default,{style:[Jo.statLabel,{color:i.onPrimaryContainer}],children:"Today"})]}),(0,K.jsxs)(ye.default,{style:[Jo.statCard,{backgroundColor:i.primaryContainer}],children:[(0,K.jsx)(A.default,{style:[Jo.statValue,{color:i.onPrimaryContainer}],children:D.thisWeek}),(0,K.jsx)(A.default,{style:[Jo.statLabel,{color:i.onPrimaryContainer}],children:"This Week"})]}),(0,K.jsxs)(ye.default,{style:[Jo.statCard,{backgroundColor:i.primaryContainer}],children:[(0,K.jsx)(A.default,{style:[Jo.statValue,{color:i.onPrimaryContainer}],children:D.thisMonth}),(0,K.jsx)(A.default,{style:[Jo.statLabel,{color:i.onPrimaryContainer}],children:"This Month"})]})]}),(0,K.jsxs)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:Jo.filtersContainer,children:[(0,K.jsx)(z.default,{selected:"all"===m,onPress:()=>g("all"),style:Jo.filterChip,children:"All Time"}),(0,K.jsx)(z.default,{selected:"today"===m,onPress:()=>g("today"),style:Jo.filterChip,children:"Today"}),(0,K.jsx)(z.default,{selected:"week"===m,onPress:()=>g("week"),style:Jo.filterChip,children:"This Week"}),(0,K.jsx)(z.default,{selected:"month"===m,onPress:()=>g("month"),style:Jo.filterChip,children:"This Month"})]}),v()]}),ListEmptyComponent:(0,K.jsxs)(E.default,{style:Jo.emptyState,children:[(0,K.jsx)(Ee.default,{name:"check-circle-outline",size:48,color:i.onSurfaceVariant}),(0,K.jsx)(A.default,{style:[Jo.emptyText,{color:i.onSurfaceVariant}],children:"No completed tasks found"})]})}),p.length>0&&(0,K.jsxs)(ye.default,{style:[Jo.bottomBar,{backgroundColor:i.surface}],children:[(0,K.jsxs)(A.default,{style:{color:i.onSurface},children:[p.length," selected"]}),(0,K.jsx)(H.default,{mode:"contained",onPress:()=>T(!0),style:Jo.restoreButton,children:"Restore Tasks"})]}),(0,K.jsxs)(N.default,{visible:h,onDismiss:()=>{y(!1),w(null)},anchor:C?{x:C.x,y:C.y}:void 0,contentStyle:Jo.menuContent,children:[Ko.map((e=>(0,K.jsx)(N.default.Item,{onPress:()=>{l===e.id?f(!u):(c(e.id),f(!1)),y(!1),w(null)},title:e.label,leadingIcon:e.icon,trailingIcon:l===e.id?u?"arrow-up":"arrow-down":void 0},e.id))),(0,K.jsx)(F.default,{}),(0,K.jsx)(N.default.Item,{onPress:()=>{f(!u),y(!1),w(null)},title:"Order: "+(u?"Ascending":"Descending"),leadingIcon:u?"sort-ascending":"sort-descending"})]}),(0,K.jsx)(M.default,{children:(0,K.jsxs)(W.default,{visible:k,onDismiss:()=>T(!1),contentContainerStyle:[Jo.modal,{backgroundColor:i.surface}],children:[(0,K.jsx)(A.default,{style:[Jo.modalTitle,{color:i.onSurface}],children:"Restore Tasks"}),(0,K.jsxs)(A.default,{style:[Jo.modalText,{color:i.onSurfaceVariant}],children:["Are you sure you want to restore ",p.length," task",1!==p.length?"s":"","?"]}),(0,K.jsxs)(E.default,{style:Jo.modalActions,children:[(0,K.jsx)(H.default,{onPress:()=>T(!1),children:"Cancel"}),(0,K.jsx)(H.default,{mode:"contained",onPress:async()=>{try{const e=p.map((e=>{const r=t.find((t=>t.id===e));return r?o(Object.assign({},r,{completed:!1,updatedAt:(new Date).toISOString()})):Promise.resolve()}));await Promise.all(e),x([]),T(!1),await a()}catch(Pr){console.error("Error restoring tasks:",Pr)}},children:"Restore"})]})]})})]})}const Jo=B.default.create({container:{flex:1},listContent:{padding:16},header:{marginBottom:16},headerTop:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},title:{fontSize:24,fontWeight:"bold",marginBottom:4},subtitle:{fontSize:16,opacity:.7},statsContainer:{flexDirection:"row",justifyContent:"space-between",marginVertical:16},statCard:{flex:1,margin:4,padding:12,borderRadius:12,alignItems:"center"},statValue:{fontSize:24,fontWeight:"bold"},statLabel:{fontSize:12,marginTop:4},filtersContainer:{marginBottom:16},filterChip:{marginRight:8},sortContainer:{flexDirection:"row",justifyContent:"flex-end",marginBottom:8},sortButton:{flexDirection:"row",alignItems:"center",padding:8},sortButtonText:{marginLeft:4},taskItem:{marginBottom:12,borderRadius:12,elevation:2},taskContent:{padding:16},taskHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},titleContainer:{flexDirection:"row",alignItems:"center",flex:1},checkbox:{margin:0,padding:0},taskTitle:{fontSize:16,fontWeight:"600",flex:1},completedChip:{height:28},description:{fontSize:14,marginBottom:8,marginLeft:28},taskMeta:{flexDirection:"row",alignItems:"center",marginLeft:28},metaText:{fontSize:12,marginRight:8},emptyState:{alignItems:"center",justifyContent:"center",padding:32},emptyText:{fontSize:16,marginTop:16},bottomBar:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,elevation:4},restoreButton:{marginLeft:16},modal:{margin:20,padding:20,borderRadius:8},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:12},modalText:{fontSize:16,marginBottom:20},modalActions:{flexDirection:"row",justifyContent:"flex-end",gap:8},menuContent:{marginTop:8,borderRadius:8,elevation:4},sortDirectionButton:{marginLeft:8}});var Zo=o(25520);const er=(0,r.createContext)(null),tr=B.default.create({container:{flex:1,backgroundColor:"#000"},keyboardAvoidingView:{flex:1},scrollContent:{flexGrow:1,padding:16},formContainer:{marginBottom:24},formLabel:{fontSize:18,fontWeight:"bold",color:"#fff",marginBottom:16},input:{marginBottom:16,backgroundColor:"#111"},errorText:{color:"#f44336",marginTop:-12,marginBottom:16,fontSize:12},helperText:{color:"#999",fontSize:14,marginTop:8},buttonContainer:{marginTop:"auto",marginBottom:16},createButton:{marginBottom:12,backgroundColor:"#3498db"},cancelButton:{borderColor:"#555"},buttonContent:{paddingVertical:8}}),or=()=>{const e=(0,d.useNavigation)(),t=(0,R.useTheme)(),{user:o}=(()=>{const e=(0,r.useContext)(er);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e})(),[a,s]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[l,c]=(0,r.useState)(!1),[u,f]=(0,r.useState)("");return(0,K.jsxs)(E.default,{style:tr.container,children:[(0,K.jsxs)(Zo.default.Header,{style:{backgroundColor:t.colors.surface},children:[(0,K.jsx)(Zo.default.BackAction,{onPress:()=>e.goBack()}),(0,K.jsx)(Zo.default.Content,{title:"Create New Group"})]}),(0,K.jsx)(Ke.default,{behavior:"height",style:tr.keyboardAvoidingView,children:(0,K.jsx)(Qe.default,{onPress:Je.default.dismiss,children:(0,K.jsxs)(Ae.default,{contentContainerStyle:tr.scrollContent,children:[(0,K.jsxs)(E.default,{style:tr.formContainer,children:[(0,K.jsx)(A.default,{style:tr.formLabel,children:"Group Information"}),(0,K.jsx)(to.default,{label:"Group Name",value:a,onChangeText:s,style:tr.input,mode:"outlined",error:!!u,outlineColor:"#333",activeOutlineColor:"#3498db",disabled:l}),u?(0,K.jsx)(A.default,{style:tr.errorText,children:u}):null,(0,K.jsx)(to.default,{label:"Description",value:n,onChangeText:i,style:tr.input,mode:"outlined",multiline:!0,numberOfLines:4,outlineColor:"#333",activeOutlineColor:"#3498db",disabled:l}),(0,K.jsx)(A.default,{style:tr.helperText,children:"You'll be able to invite team members after creating the group."})]}),(0,K.jsxs)(E.default,{style:tr.buttonContainer,children:[(0,K.jsx)(H.default,{mode:"contained",onPress:async()=>{f("");let t=!0;if(a.trim()||(f("Group name is required"),t=!1),t){c(!0);try{if(!o?.id)throw new Error("User not authenticated");const{createGroup:t}=Do.getState(),r=t(a,n,o.id,(new Date).toISOString(),"public");e.replace("GroupDetail",{groupId:r.id})}catch(Pr){console.error("Error creating group:",Pr)}finally{c(!1)}}},loading:l,disabled:l,style:tr.createButton,contentStyle:tr.buttonContent,children:"Create Group"}),(0,K.jsx)(H.default,{mode:"outlined",onPress:()=>e.goBack(),disabled:l,style:tr.cancelButton,contentStyle:tr.buttonContent,children:"Cancel"})]})]})})})]})},rr=B.default.create({skeleton:{overflow:"hidden"}}),ar=({width:e,height:t,style:o,borderRadius:a=4})=>{const{isDark:s}=Z(),n=(0,r.useRef)(new Te.default.Value(.3)).current;return(0,r.useEffect)((()=>{const e=Te.default.sequence([Te.default.timing(n,{toValue:.6,duration:800,useNativeDriver:!0}),Te.default.timing(n,{toValue:.3,duration:800,useNativeDriver:!0})]);return Te.default.loop(e).start(),()=>{n.stopAnimation()}}),[n]),(0,K.jsx)(Te.default.View,{style:[rr.skeleton,{width:e,height:t,borderRadius:a,backgroundColor:s?"#444":"#E1E9EE",opacity:n},o]})};function sr(){const e=(0,d.useNavigation)(),{colors:t}=(0,R.useTheme)(),[o,a]=(0,r.useState)(""),[s,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)("recent"),[f,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)("grid"),[y,p]=(0,r.useState)(!1),[x,b]=(0,r.useState)(null),[j,k]=(0,r.useState)([]),T=(0,r.useRef)(new Te.default.Value(0)).current,{templates:C}=he();(0,r.useEffect)((()=>{(async()=>{l(!0);try{await he.getState().fetchTemplates();const e=(he.getState().templates||[]).map((e=>({id:e.id,name:e.name||e.title,description:e.description||"",tasks:e.subtasks||[],priority:e.priority,tags:Array.isArray(e.subtasks)?e.subtasks.map((e=>e.title)):[],createdAt:e.createdAt?new Date(e.createdAt).toISOString():(new Date).toISOString()})));n(e),Te.default.timing(T,{toValue:1,duration:500,useNativeDriver:!0}).start(),l(!1)}catch(Pr){console.error("Error loading templates:",Pr),l(!1)}})()}),[]),(0,r.useEffect)((()=>{if(C&&Array.isArray(C)&&C.length>0){const e=C.map((e=>({id:e.id,name:e.name||e.title,description:e.description||"",tasks:e.subtasks||[],priority:e.priority,tags:Array.isArray(e.subtasks)?e.subtasks.map((e=>e.title)):[],createdAt:e.createdAt?new Date(e.createdAt).toISOString():(new Date).toISOString()})));n(e),Te.default.timing(T,{toValue:1,duration:500,useNativeDriver:!0}).start()}}),[C]);const w=s.filter((e=>e.name.toLowerCase().includes(o.toLowerCase())||e.description&&e.description.toLowerCase().includes(o.toLowerCase()))).filter((e=>!x||e.priority===x)).filter((e=>0===j.length||e.tags&&e.tags.some((e=>j.includes(e))))).sort(((e,t)=>{switch(c){case"recent":return new Date(t.createdAt||"").getTime()-new Date(e.createdAt||"").getTime();case"name":return e.name.localeCompare(t.name);case"tasks":return(t.tasks?.length||0)-(e.tasks?.length||0);default:return 0}})),S=Array.from(new Set(s.flatMap((e=>e.tags||[])))),D=e=>{console.log("Duplicate template:",e.id)},I=e=>e.toLocaleDateString(void 0,{month:"short",day:"numeric"}),v=e=>{switch(e.toLowerCase()){case"high":return"#FF5252";case"medium":return"#FFB300";case"low":return"#69F0AE";default:return"#BDBDBD"}};(new Date).toISOString(),(new Date).toISOString(),new Date(Date.now()-864e5).toISOString(),new Date(Date.now()-1728e5).toISOString(),new Date(Date.now()-1728e5).toISOString(),new Date(Date.now()-2592e5).toISOString();return(0,K.jsxs)(E.default,{style:[nr.container,{backgroundColor:t.background}],children:[(0,K.jsxs)(E.default,{style:nr.header,children:[(0,K.jsx)(A.default,{style:nr.screenTitle,children:"Templates"}),(0,K.jsxs)(E.default,{style:nr.headerActions,children:[(0,K.jsx)(O.default,{icon:"grid"===g?"view-list":"view-grid",size:24,onPress:()=>h("grid"===g?"list":"grid")}),(0,K.jsx)(O.default,{icon:"filter-variant",size:24,onPress:()=>m(!f),style:{backgroundColor:x||j.length>0?t.primary+"20":void 0}}),(0,K.jsxs)(N.default,{visible:y,onDismiss:()=>p(!1),anchor:(0,K.jsx)(O.default,{icon:"dots-vertical",size:24,onPress:()=>p(!0)}),children:[(0,K.jsx)(N.default.Item,{onPress:()=>{u("recent"),p(!1)},title:"Sort by recent",leadingIcon:"recent"===c?"check":void 0}),(0,K.jsx)(N.default.Item,{onPress:()=>{u("name"),p(!1)},title:"Sort by name",leadingIcon:"name"===c?"check":void 0}),(0,K.jsx)(N.default.Item,{onPress:()=>{u("tasks"),p(!1)},title:"Sort by tasks count",leadingIcon:"tasks"===c?"check":void 0}),(0,K.jsx)(F.default,{}),(0,K.jsx)(N.default.Item,{onPress:()=>{e.navigate("CreateTemplate"),p(!1)},title:"Create template",leadingIcon:"plus"})]})]})]}),(0,K.jsx)(L.default,{placeholder:"Search templates...",onChangeText:a,value:o,style:nr.searchBar}),f&&(0,K.jsxs)(E.default,{style:nr.filterContainer,children:[(0,K.jsx)(A.default,{style:nr.filterTitle,children:"Filter by:"}),(0,K.jsx)(A.default,{style:nr.filterLabel,children:"Priority"}),(0,K.jsx)(Mo.default,{value:x||"",onValueChange:e=>b(""===e?null:e),buttons:[{value:"",label:"All",style:{backgroundColor:"transparent"}},{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}],style:nr.segmentedButtons}),(0,K.jsx)(A.default,{style:nr.filterLabel,children:"Tags"}),(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:nr.tagFilters,children:S.map(((e,o)=>(0,K.jsx)(z.default,{style:[nr.tagChip,{backgroundColor:j.includes(e)?t.primary:t.surfaceVariant}],textStyle:{color:j.includes(e)?"white":"#1C1B1F"},onPress:()=>{j.includes(e)?k(j.filter((t=>t!==e))):k([...j,e])},children:e},o)))}),(0,K.jsx)(H.default,{mode:"text",onPress:()=>{b(null),k([])},style:nr.clearButton,children:"Clear Filters"})]}),i?(0,K.jsx)(E.default,{style:nr.loadingContainer,children:[1,2,3].map(((e,t)=>(0,K.jsxs)(E.default,{style:[nr.templateCard,{marginBottom:16}],children:[(0,K.jsx)(ar,{width:"70%",height:24,style:{marginBottom:8}}),(0,K.jsx)(ar,{width:"100%",height:16,style:{marginBottom:4}}),(0,K.jsx)(ar,{width:"90%",height:16,style:{marginBottom:12}}),(0,K.jsxs)(E.default,{style:{flexDirection:"row",marginBottom:12},children:[(0,K.jsx)(ar,{width:80,height:20,style:{marginRight:8}}),(0,K.jsx)(ar,{width:80,height:20})]})]},t)))}):0===w.length?(0,K.jsxs)(E.default,{style:nr.emptyContainer,children:[(0,K.jsx)(A.default,{style:[nr.emptyText,{color:"#1C1B1F"}],children:"No templates yet"}),(0,K.jsx)(A.default,{style:[nr.emptySubtext,{color:"#49454F"}],children:"Create templates to speed up your task creation process"}),(0,K.jsx)(H.default,{mode:"contained",onPress:()=>e.navigate("CreateTemplate"),style:{marginTop:16},children:"Create Your First Template"})]}):(0,K.jsx)(ie.default,{data:w,renderItem:"grid"===g?({item:o})=>(0,K.jsx)(Te.default.View,{style:{opacity:T,width:"48%"},children:(0,K.jsx)(P.default,{onPress:()=>e.navigate("TemplateDetail",{templateId:o.id}),style:nr.gridItem,children:(0,K.jsxs)(Be.default,{style:[nr.templateCard,{backgroundColor:t.surface}],children:[(0,K.jsxs)(Be.default.Content,{children:[o.priority&&(0,K.jsx)(E.default,{style:[nr.priorityIndicator,{backgroundColor:v(o.priority)}]}),(0,K.jsx)(A.default,{style:nr.templateName,numberOfLines:1,children:o.name}),(0,K.jsx)(A.default,{style:nr.templateDescription,numberOfLines:2,children:o.description||"No description"}),o.tags&&o.tags.length>0&&(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:nr.tagsContainer,children:o.tags.map(((e,t)=>(0,K.jsx)(z.default,{style:nr.tag,textStyle:{fontSize:10},compact:!0,children:e},t)))}),(0,K.jsxs)(E.default,{style:nr.templateStats,children:[(0,K.jsxs)(A.default,{style:nr.templateStat,children:[(0,K.jsx)(Ee.default,{name:"checkbox-marked-outline",size:12,color:t.primary})," ",o.tasks?.length||0," tasks"]}),(0,K.jsx)(A.default,{style:nr.templateStat,children:o.lastUsed?`Last used: ${I(new Date(o.lastUsed))}`:"Never used"})]})]}),(0,K.jsxs)(Be.default.Actions,{style:nr.cardActions,children:[(0,K.jsx)(O.default,{icon:"content-copy",size:20,onPress:()=>D(o)}),(0,K.jsx)(O.default,{icon:"arrow-right",size:20,onPress:()=>e.navigate("TemplateDetail",{templateId:o.id})})]})]})})}):({item:o})=>(0,K.jsx)(Te.default.View,{style:{opacity:T,width:"100%"},children:(0,K.jsxs)(Be.default,{style:[nr.listCard,{backgroundColor:t.surface}],children:[(0,K.jsxs)(Be.default.Content,{children:[(0,K.jsxs)(E.default,{style:nr.listItemHeader,children:[(0,K.jsxs)(E.default,{style:{flex:1,marginRight:8},children:[(0,K.jsx)(A.default,{style:nr.templateName,numberOfLines:1,children:o.name}),(0,K.jsx)(A.default,{style:nr.templateDescription,numberOfLines:2,children:o.description||"No description"})]}),o.priority&&(0,K.jsx)(z.default,{style:{backgroundColor:v(o.priority)},children:o.priority})]}),o.tags&&o.tags.length>0&&(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:nr.tagsContainer,children:o.tags.map(((e,t)=>(0,K.jsx)(z.default,{style:nr.tag,textStyle:{fontSize:10},compact:!0,children:e},t)))}),(0,K.jsxs)(E.default,{style:nr.templateStats,children:[(0,K.jsxs)(A.default,{style:nr.templateStat,children:[(0,K.jsx)(Ee.default,{name:"checkbox-marked-outline",size:12,color:t.primary})," ",o.tasks?.length||0," tasks"]}),(0,K.jsx)(A.default,{style:nr.templateStat,children:o.lastUsed?`Last used: ${I(new Date(o.lastUsed))}`:"Never used"})]})]}),(0,K.jsxs)(Be.default.Actions,{style:nr.cardActions,children:[(0,K.jsx)(H.default,{mode:"text",onPress:()=>D(o),children:"Duplicate"}),(0,K.jsx)(H.default,{mode:"contained",onPress:()=>e.navigate("TemplateDetail",{templateId:o.id}),children:"View"})]})]})}),keyExtractor:e=>e.id,contentContainerStyle:nr.listContent,numColumns:"grid"===g?2:1,columnWrapperStyle:"grid"===g?nr.gridColumnWrapper:void 0},g),(0,K.jsx)(wo.default,{style:[nr.fab,{backgroundColor:t.primary}],icon:"plus",onPress:()=>e.navigate("CreateTemplate")})]})}const nr=B.default.create({container:{flex:1},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:16,paddingTop:12},screenTitle:{fontSize:28,fontWeight:"bold"},headerActions:{flexDirection:"row"},searchBar:{margin:16,marginTop:8,elevation:0},listContent:{padding:16,width:"100%"},gridItem:{flex:1,margin:4,maxWidth:"100%"},gridColumnWrapper:{justifyContent:"space-between",width:"100%"},templateCard:{elevation:2,borderRadius:12,overflow:"hidden",marginBottom:12},listCard:{marginBottom:12,borderRadius:12,elevation:2,width:"100%"},priorityIndicator:{position:"absolute",top:0,right:0,width:16,height:16,borderRadius:8},templateName:{fontSize:18,fontWeight:"600",marginBottom:6},templateDescription:{fontSize:14,color:"#666",marginBottom:8},templateStats:{flexDirection:"row",justifyContent:"space-between",marginTop:8},templateStat:{fontSize:12,color:"#666"},tagsContainer:{flexDirection:"row",marginVertical:8,maxWidth:"100%"},tag:{marginRight:4,marginBottom:4},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:16},emptyText:{fontSize:20,fontWeight:"600",marginTop:16,marginBottom:8},emptySubtext:{fontSize:14,color:"#666",textAlign:"center"},fab:{position:"absolute",margin:16,right:0,bottom:0},loadingContainer:{padding:16},listItemHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12,width:"100%"},cardActions:{justifyContent:"flex-end",flexWrap:"wrap"},filterContainer:{padding:16,paddingTop:0},filterTitle:{fontSize:16,fontWeight:"600",marginBottom:12},filterLabel:{fontSize:14,marginBottom:8},segmentedButtons:{marginBottom:16},tagFilters:{marginBottom:16},tagChip:{marginRight:8},clearButton:{alignSelf:"flex-end"}}),ir=B.default.create({modalContainer:{flex:1,justifyContent:"center",alignItems:"center"},modalContent:{width:"90%",maxHeight:"80%",borderRadius:12,overflow:"hidden",elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:"#eee"},heading:{fontSize:20,fontWeight:"bold"},closeButton:{padding:4},formContainer:{padding:16},formGroup:{marginBottom:16},label:{fontSize:16,fontWeight:"bold",marginBottom:8},input:{height:48,borderWidth:1,borderRadius:8,paddingHorizontal:12,fontSize:16},textArea:{minHeight:80,borderWidth:1,borderRadius:8,paddingHorizontal:12,paddingTop:8,fontSize:16},pickerContainer:{borderWidth:1,borderRadius:8,overflow:"hidden"},picker:{height:48},subtaskInputContainer:{flexDirection:"row",alignItems:"center"},subtaskInput:{flex:1,height:48,borderWidth:1,borderRadius:8,paddingHorizontal:12,fontSize:16,marginRight:8},addButton:{height:48,paddingHorizontal:16,borderRadius:8,justifyContent:"center",alignItems:"center"},addButtonText:{color:"#fff",fontWeight:"bold",fontSize:16},subtaskList:{marginTop:12},subtaskItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,paddingHorizontal:12,backgroundColor:"rgba(0,0,0,0.05)",borderRadius:6,marginVertical:4},subtaskTitle:{flex:1,fontSize:16},removeButton:{padding:4},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:24,marginBottom:16},button:{flex:1,height:48,borderRadius:8,justifyContent:"center",alignItems:"center"},cancelButton:{backgroundColor:"transparent",borderWidth:1,marginRight:8},saveButton:{marginLeft:8},buttonText:{fontSize:16,fontWeight:"bold"},saveButtonText:{color:"#fff"}}),lr=({template:e,isVisible:t,onClose:o,sourceTaskId:a})=>{const s=!!e,{theme:n,isDark:i}=Z(),{addTemplate:l,updateTemplate:d,categories:c,saveTaskAsTemplate:u}=he(),[f,m]=(0,r.useState)(""),[g,h]=(0,r.useState)(""),[y,p]=(0,r.useState)(""),[x,b]=(0,r.useState)(""),[j,k]=(0,r.useState)("medium"),[T,C]=(0,r.useState)(void 0),[w,S]=(0,r.useState)(""),[D,I]=(0,r.useState)([]),[v,B]=(0,r.useState)("");(0,r.useEffect)((()=>{e?(m(e.name),h(e.description||""),p(e.title),b(e.taskDescription||""),k(e.priority),C(e.categoryId),e.dueTimeOffset&&S(e.dueTimeOffset.toString()),e.subtasks&&I([...e.subtasks])):R()}),[e,t]);const R=()=>{m(""),h(""),p(""),b(""),k("medium"),C(void 0),S(""),I([]),B("")},A=()=>{v.trim()&&(I([...D,{title:v.trim()}]),B(""))};return(0,K.jsx)(ve.default,{visible:t,animationType:"slide",transparent:!0,onRequestClose:o,children:(0,K.jsx)(E.default,{style:[ir.modalContainer,{backgroundColor:i?"rgba(0,0,0,0.7)":"rgba(0,0,0,0.5)"}],children:(0,K.jsxs)(E.default,{style:[ir.modalContent,{backgroundColor:i?"#222":"#fff"}],children:[(0,K.jsxs)(E.default,{style:ir.header,children:[(0,K.jsx)(ne.default,{style:[ir.heading,{color:n.colors.text}],children:s?"Edit Template":a?"Save as Template":"Create Template"}),(0,K.jsx)(P.default,{onPress:o,style:ir.closeButton,children:(0,K.jsx)($e.default,{name:"close",size:24,color:n.colors.text})})]}),(0,K.jsxs)(Ae.default,{style:ir.formContainer,children:[(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Template Name*"}),(0,K.jsx)(qe.default,{style:[ir.input,{color:n.colors.text,backgroundColor:i?"#333":"#f5f5f5",borderColor:i?"#444":"#ddd"}],value:f,onChangeText:m,placeholder:"Enter template name",placeholderTextColor:i?"#999":"#aaa"})]}),(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Description"}),(0,K.jsx)(qe.default,{style:[ir.textArea,{color:n.colors.text,backgroundColor:i?"#333":"#f5f5f5",borderColor:i?"#444":"#ddd"}],value:g,onChangeText:h,placeholder:"Enter template description",placeholderTextColor:i?"#999":"#aaa",multiline:!0,numberOfLines:3,textAlignVertical:"top"})]}),!a&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Task Title*"}),(0,K.jsx)(qe.default,{style:[ir.input,{color:n.colors.text,backgroundColor:i?"#333":"#f5f5f5",borderColor:i?"#444":"#ddd"}],value:y,onChangeText:p,placeholder:"Enter task title",placeholderTextColor:i?"#999":"#aaa"})]}),(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Task Description"}),(0,K.jsx)(qe.default,{style:[ir.textArea,{color:n.colors.text,backgroundColor:i?"#333":"#f5f5f5",borderColor:i?"#444":"#ddd"}],value:x,onChangeText:b,placeholder:"Enter task description",placeholderTextColor:i?"#999":"#aaa",multiline:!0,numberOfLines:3,textAlignVertical:"top"})]}),(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Priority"}),(0,K.jsx)(E.default,{style:[ir.pickerContainer,{borderColor:i?"#444":"#ddd"}],children:(0,K.jsxs)(ot.Picker,{selectedValue:j,onValueChange:e=>k(e),style:[ir.picker,{color:n.colors.text}],dropdownIconColor:n.colors.text,children:[(0,K.jsx)(ot.Picker.Item,{label:"Low",value:"low"}),(0,K.jsx)(ot.Picker.Item,{label:"Medium",value:"medium"}),(0,K.jsx)(ot.Picker.Item,{label:"High",value:"high"})]})})]}),(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Category"}),(0,K.jsx)(E.default,{style:[ir.pickerContainer,{borderColor:i?"#444":"#ddd"}],children:(0,K.jsxs)(ot.Picker,{selectedValue:T,onValueChange:e=>C(e),style:[ir.picker,{color:n.colors.text}],dropdownIconColor:n.colors.text,children:[(0,K.jsx)(ot.Picker.Item,{label:"Select a category",value:void 0}),c&&c.length>0?c.map((e=>(0,K.jsx)(ot.Picker.Item,{label:e.name,value:e.id},e.id))):null]})})]}),(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Due in Days"}),(0,K.jsx)(qe.default,{style:[ir.input,{color:n.colors.text,backgroundColor:i?"#333":"#f5f5f5",borderColor:i?"#444":"#ddd"}],value:w,onChangeText:e=>S(e.replace(/[^0-9]/g,"")),placeholder:"How many days from creation (e.g., 7)",placeholderTextColor:i?"#999":"#aaa",keyboardType:"numeric"})]}),(0,K.jsxs)(E.default,{style:ir.formGroup,children:[(0,K.jsx)(ne.default,{style:[ir.label,{color:n.colors.text}],children:"Subtasks"}),(0,K.jsxs)(E.default,{style:ir.subtaskInputContainer,children:[(0,K.jsx)(qe.default,{style:[ir.subtaskInput,{color:n.colors.text,backgroundColor:i?"#333":"#f5f5f5",borderColor:i?"#444":"#ddd"}],value:v,onChangeText:B,placeholder:"Enter subtask",placeholderTextColor:i?"#999":"#aaa",onSubmitEditing:A}),(0,K.jsx)(P.default,{style:[ir.addButton,{backgroundColor:n.colors.primary}],onPress:A,children:(0,K.jsx)(ne.default,{style:ir.addButtonText,children:"Add"})})]}),D.length>0&&(0,K.jsx)(E.default,{style:ir.subtaskList,children:D.map(((e,t)=>(0,K.jsxs)(E.default,{style:ir.subtaskItem,children:[(0,K.jsx)(ne.default,{style:[ir.subtaskTitle,{color:n.colors.text}],numberOfLines:1,children:e.title}),(0,K.jsx)(P.default,{style:ir.removeButton,onPress:()=>(e=>{I(D.filter(((t,o)=>o!==e)))})(t),children:(0,K.jsx)($e.default,{name:"close",size:16,color:n.colors.text})})]},t)))})]})]}),(0,K.jsxs)(E.default,{style:ir.buttonContainer,children:[(0,K.jsx)(P.default,{style:[ir.button,ir.cancelButton,{borderColor:n.colors.primary}],onPress:o,children:(0,K.jsx)(ne.default,{style:[ir.buttonText,{color:n.colors.primary}],children:"Cancel"})}),(0,K.jsx)(P.default,{style:[ir.button,ir.saveButton,{backgroundColor:n.colors.primary}],onPress:async()=>{if(f.trim())if(y.trim())try{a?(await u(a,f,g),_e.default.alert("Success","Task saved as template")):s&&e?(await d(e.id,{name:f,description:g,title:y,taskDescription:x,priority:j,categoryId:T,dueTimeOffset:w?parseInt(w):void 0,subtasks:D}),_e.default.alert("Success","Template updated")):(await l({name:f,description:g,title:y,taskDescription:x,priority:j,categoryId:T,dueTimeOffset:w?parseInt(w):void 0,subtasks:D}),_e.default.alert("Success","Template created")),R(),o()}catch(Pr){console.error("Failed to save template:",Pr),_e.default.alert("Error","Failed to save template")}else _e.default.alert("Error","Please enter a task title");else _e.default.alert("Error","Please enter a template name")},children:(0,K.jsx)(ne.default,{style:[ir.buttonText,ir.saveButtonText],children:s?"Update":"Save"})})]})]})]})})})};function dr(){const e=(0,d.useNavigation)(),{theme:t}=Z();return(0,K.jsx)(E.default,{style:[cr.container,{backgroundColor:t.colors.background}],children:(0,K.jsx)(lr,{isVisible:!0,onClose:()=>{e.goBack()}})})}const cr=B.default.create({container:{flex:1}});function ur(){const e=(0,d.useNavigation)(),t=(0,d.useRoute)(),{templateId:o}=t.params,{theme:a,isDark:s}=Z(),[n,i]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),[u,f]=(0,r.useState)(null),{templates:m=[],deleteTemplate:g,createTaskFromTemplate:h}=he();(0,r.useEffect)((()=>{y()}),[o,m]);const y=()=>{i(!0),f(null);try{if(!m||!Array.isArray(m))throw new Error("Templates data is not available");const e=m.find((e=>e.id===o));e?c(e):f("Template not found")}catch(e){console.error("Error loading template:",e),f("Failed to load template details")}finally{i(!1)}},p=()=>{y()};if(n)return(0,K.jsx)(E.default,{style:[fr.container,{backgroundColor:a.colors.background}],children:(0,K.jsx)(Ao.default,{size:"large",color:a.colors.primary})});if(u||!l)return(0,K.jsxs)(E.default,{style:[fr.container,fr.centeredContent,{backgroundColor:a.colors.background}],children:[(0,K.jsx)(Ee.default,{name:"alert-circle-outline",size:64,color:a.colors.error}),(0,K.jsx)(A.default,{style:[fr.errorText,{color:a.colors.error}],children:u||"Template not found"}),(0,K.jsx)(H.default,{mode:"contained",onPress:p,style:{marginTop:16},children:"Retry"}),(0,K.jsx)(H.default,{mode:"outlined",onPress:()=>e.goBack(),style:{marginTop:12},children:"Go Back"})]});return(0,K.jsxs)(E.default,{style:[fr.container,{backgroundColor:a.colors.background}],children:[(0,K.jsxs)(Ae.default,{style:fr.scrollView,children:[(0,K.jsx)(Be.default,{style:[fr.card,{backgroundColor:a.colors.surface}],children:(0,K.jsxs)(Be.default.Content,{children:[(0,K.jsxs)(E.default,{style:fr.headerRow,children:[(0,K.jsx)(A.default,{style:[fr.title,{color:a.colors.text}],children:l.name||l.title||"Untitled Template"}),l.priority&&(0,K.jsx)(z.default,{style:{backgroundColor:(e=>{if(!e)return"#BDBDBD";switch(e.toLowerCase()){case"high":return"#FF5252";case"medium":return"#FFB300";case"low":return"#69F0AE";default:return"#BDBDBD"}})(l.priority)},textStyle:{color:"#fff"},children:l.priority})]}),(0,K.jsx)(A.default,{style:[fr.description,{color:a.colors.text}],children:l.description||"No description provided"}),l.tags&&l.tags.length>0&&(0,K.jsx)(Ae.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:fr.tagsContainer,contentContainerStyle:fr.tagsContent,children:l.tags.map(((e,t)=>(0,K.jsx)(z.default,{style:fr.tag,textStyle:{color:s?"#fff":a.colors.text},children:"string"===typeof e?e:e.name},t)))}),(0,K.jsxs)(E.default,{style:fr.metaRow,children:[(0,K.jsxs)(A.default,{style:[fr.metaText,{color:a.colors.text}],children:[(0,K.jsx)(Ee.default,{name:"clock-outline",size:16,color:a.colors.primary})," ","Estimated time: ",l.estimatedTime||0," minutes"]}),(0,K.jsxs)(A.default,{style:[fr.metaText,{color:a.colors.text}],children:[(0,K.jsx)(Ee.default,{name:"calendar-outline",size:16,color:a.colors.primary})," ","Created: ",l.createdAt?new Date(l.createdAt).toLocaleDateString():"Unknown"]})]})]})}),(0,K.jsx)(Be.default,{style:[fr.card,{backgroundColor:a.colors.surface}],children:(0,K.jsxs)(Be.default.Content,{children:[(0,K.jsxs)(A.default,{style:[fr.sectionTitle,{color:a.colors.text}],children:["Tasks (",l.subtasks?.length||l.tasks?.length||0,")"]}),(l.subtasks||l.tasks||[]).length>0?(0,K.jsx)(Ae.default,{style:fr.taskListContainer,children:(l.subtasks||l.tasks||[]).map(((e,t)=>(0,K.jsxs)(E.default,{style:fr.taskItem,children:[(0,K.jsx)(Ee.default,{name:"circle-small",size:24,color:a.colors.primary,style:fr.taskBullet}),(0,K.jsx)(A.default,{style:[fr.taskText,{color:a.colors.text}],children:e.title||e.name||`Task ${t+1}`})]},t)))}):(0,K.jsx)(A.default,{style:[fr.emptyText,{color:a.colors.placeholder}],children:"No tasks defined in this template"})]})})]}),(0,K.jsx)(E.default,{style:fr.buttonContainer,children:(0,K.jsx)(H.default,{mode:"contained",onPress:()=>{if(l)try{h(l),_e.default.alert("Success","Task created from template!"),e.navigate("Home")}catch(u){console.error("Error using template:",u),_e.default.alert("Error","Failed to use template")}},style:[fr.button,{backgroundColor:a.colors.primary}],icon:"arrow-right",children:"Use Template"})}),(0,K.jsx)(wo.default,{icon:"pencil",style:[fr.editFab,{backgroundColor:a.colors.primary}],onPress:()=>{e.navigate("CreateTemplate",{templateId:o})}}),(0,K.jsx)(wo.default,{icon:"delete",style:[fr.deleteFab,{backgroundColor:a.colors.error}],onPress:()=>{_e.default.alert("Delete Template","Are you sure you want to delete this template?",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:()=>{try{g(o),_e.default.alert("Success","Template deleted successfully"),e.goBack()}catch(u){console.error("Error deleting template:",u),_e.default.alert("Error","Failed to delete template")}}}])}})]})}const fr=B.default.create({container:{flex:1},centeredContent:{justifyContent:"center",alignItems:"center",padding:20},errorText:{fontSize:16,marginTop:12,textAlign:"center"},scrollView:{flex:1,padding:16},card:{marginBottom:16,borderRadius:12,elevation:4},headerRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},title:{fontSize:24,fontWeight:"bold",flex:1},description:{fontSize:16,marginBottom:16},tagsContainer:{marginBottom:16},tagsContent:{paddingRight:16},tag:{marginRight:8,marginBottom:8},metaRow:{marginBottom:8},metaText:{fontSize:14,marginBottom:4},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:16},taskListContainer:{maxHeight:250},taskItem:{flexDirection:"row",alignItems:"center",marginBottom:8},taskBullet:{marginRight:8},taskText:{fontSize:16},emptyText:{fontStyle:"italic",textAlign:"center",padding:16},buttonContainer:{padding:16,borderTopWidth:1,borderTopColor:"#E0E0E0"},button:{padding:8},editFab:{position:"absolute",margin:16,right:0,bottom:80},deleteFab:{position:"absolute",margin:16,right:0,bottom:140}});function mr(){const{theme:e}=Z(),t=((0,d.useNavigation)(),(0,d.useRoute)()),{taskId:o}=t.params;return(0,K.jsx)(E.default,{style:[gr.container,{backgroundColor:e.colors.background}],children:(0,K.jsx)(jt,{initialTaskId:o})})}const gr=B.default.create({container:{flex:1}});function hr(){const e=(0,R.useTheme)(),t=(0,d.useNavigation)(),o=(0,d.useRoute)(),{taskId:a}=o.params,[s,n]=(0,r.useState)("");return(0,K.jsxs)(E.default,{style:[yr.container,{backgroundColor:e.colors.background}],children:[(0,K.jsx)(to.default,{label:"Add a comment",value:s,onChangeText:n,multiline:!0,style:yr.input}),(0,K.jsx)(H.default,{mode:"contained",onPress:()=>{t.goBack()},style:yr.button,children:"Add Comment"})]})}const yr=B.default.create({container:{flex:1,padding:16},input:{marginBottom:16},button:{marginTop:8}});function pr(){const e=(0,R.useTheme)(),t=(0,d.useNavigation)(),o=(0,d.useRoute)(),{taskId:a}=o.params,[s,n]=(0,r.useState)("");return(0,K.jsxs)(E.default,{style:[xr.container,{backgroundColor:e.colors.background}],children:[(0,K.jsx)(to.default,{label:"Enter email address",value:s,onChangeText:n,keyboardType:"email-address",autoCapitalize:"none",style:xr.input}),(0,K.jsx)(H.default,{mode:"contained",onPress:()=>{t.goBack()},style:xr.button,children:"Share Task"}),(0,K.jsx)(S.default,{children:(0,K.jsx)(D.default,{children:"Recently Shared With"})})]})}const xr=B.default.create({container:{flex:1,padding:16},input:{marginBottom:16},button:{marginTop:8}});function br(){return(0,K.jsx)(E.default,{style:{flex:1},children:(0,K.jsx)(jt,{showCloseButton:!1,onClose:()=>{},initialTaskId:void 0})})}const jr=(0,c.createNativeStackNavigator)(),kr=(0,u.createBottomTabNavigator)();function Tr(){return(0,K.jsxs)(kr.Navigator,{screenOptions:({route:e})=>({tabBarIcon:({focused:t,color:o,size:r})=>{let a="list";return"Home"===e.name?a=t?"home":"home-outline":"Tasks"===e.name?a=t?"list":"list-outline":"Calendar"===e.name?a=t?"calendar":"calendar-outline":"Focus"===e.name?a=t?"timer":"timer-outline":"More"===e.name&&(a=t?"ellipsis-horizontal":"ellipsis-horizontal-outline"),(0,K.jsx)(f.default,{name:a,size:r,color:o})},tabBarActiveTintColor:"#007AFF",tabBarInactiveTintColor:"gray"}),children:[(0,K.jsx)(kr.Screen,{name:"Home",component:Zt,options:{title:"Home"}}),(0,K.jsx)(kr.Screen,{name:"Tasks",component:St,options:{title:"Tasks"}}),(0,K.jsx)(kr.Screen,{name:"Calendar",component:Ot,options:{title:"Calendar"}}),(0,K.jsx)(kr.Screen,{name:"Focus",component:br,options:{title:"Focus"}}),(0,K.jsx)(kr.Screen,{name:"More",component:Cr,options:{title:"More"}})]})}function Cr({navigation:e}){return(0,K.jsxs)(E.default,{style:{flex:1,backgroundColor:"#fff"},children:[(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{children:"Task Management"}),(0,K.jsx)(I.default,{title:"Templates",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"file-document-outline"})),onPress:()=>e.navigate("Templates")}),(0,K.jsx)(I.default,{title:"Completed Tasks",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"check-circle-outline"})),onPress:()=>e.navigate("Completed")})]}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{children:"Team & Groups"}),(0,K.jsx)(I.default,{title:"Team",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"account-group-outline"})),onPress:()=>e.navigate("Team")}),(0,K.jsx)(I.default,{title:"Groups",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"folder-outline"})),onPress:()=>e.navigate("Groups")})]}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{children:"Analytics"}),(0,K.jsx)(I.default,{title:"Statistics",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"chart-bar"})),onPress:()=>e.navigate("Stats")})]}),(0,K.jsxs)(S.default,{children:[(0,K.jsx)(D.default,{children:"Settings"}),(0,K.jsx)(I.default,{title:"Profile",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"account-outline"})),onPress:()=>e.navigate("Profile")}),(0,K.jsx)(I.default,{title:"Settings",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"cog-outline"})),onPress:()=>e.navigate("Settings")})]}),(0,K.jsx)(S.default,{children:(0,K.jsx)(I.default,{title:"Logout",left:e=>(0,K.jsx)(v.default,Object.assign({},e,{icon:"logout"})),onPress:async()=>{try{await(0,g.signOut)(k)}catch(Pr){console.error("Logout error:",Pr)}},titleStyle:{color:"#FF3B30"}})})]})}const wr=function(){const[e,t]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const e=(0,g.onAuthStateChanged)(k,(e=>{t(!!e)}));return()=>e()}),[]),(0,K.jsxs)(jr.Navigator,{initialRouteName:"Login",screenOptions:{headerShown:!0,headerStyle:{backgroundColor:"#fff"},headerTintColor:"#000",headerTitleStyle:{fontWeight:"bold"}},children:[e?(0,K.jsx)(jr.Screen,{name:"MainTabs",component:Tr,options:{headerShown:!1}}):(0,K.jsx)(jr.Screen,{name:"Login",component:xo,options:{headerShown:!1}}),(0,K.jsx)(jr.Screen,{name:"TaskDetail",component:Ut,options:{title:"Task Details"}}),(0,K.jsx)(jr.Screen,{name:"CreateTask",component:Po,options:{title:"Create Task"}}),(0,K.jsx)(jr.Screen,{name:"EditTask",component:Lo,options:{title:"Edit Task"}}),(0,K.jsx)(jr.Screen,{name:"Groups",component:Eo,options:{title:"Groups"}}),(0,K.jsx)(jr.Screen,{name:"CreateGroup",component:or,options:{title:"Create Group"}}),(0,K.jsx)(jr.Screen,{name:"Completed",component:Qo,options:{title:"Completed Tasks"}}),(0,K.jsx)(jr.Screen,{name:"Templates",component:sr,options:{title:"Templates"}}),(0,K.jsx)(jr.Screen,{name:"Pomodoro",component:mr,options:{title:"Pomodoro Timer"}}),(0,K.jsx)(jr.Screen,{name:"AddComment",component:hr,options:{title:"Add Comment"}}),(0,K.jsx)(jr.Screen,{name:"ShareTask",component:pr,options:{title:"Share Task"}}),(0,K.jsx)(jr.Screen,{name:"Team",component:To,options:{title:"Team"}}),(0,K.jsx)(jr.Screen,{name:"Stats",component:Ft,options:{title:"Statistics"}}),(0,K.jsx)(jr.Screen,{name:"Settings",component:Vt,options:{title:"Settings"}}),(0,K.jsx)(jr.Screen,{name:"Profile",component:Go,options:{title:"Profile"}}),(0,K.jsx)(jr.Screen,{name:"CreateTemplate",component:dr,options:{title:"Create Template",headerShown:!0}}),(0,K.jsx)(jr.Screen,{name:"TemplateDetail",component:ur,options:{title:"Template Details",headerShown:!0}})]})},Sr=(0,r.createContext)({isDbReady:!1}),Dr=({children:e})=>{const[t,o]=(0,r.useState)(!1),[a,s]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{try{console.log("Initializing database from DatabaseProvider..."),await fe.initDatabase(),o(!0)}catch(e){console.error("Failed to initialize database:",e),s("Failed to initialize database. Please restart the app.")}})()}),[]),a?(0,K.jsx)(E.default,{style:{flex:1,justifyContent:"center",alignItems:"center",padding:20},children:(0,K.jsx)(ne.default,{style:{fontSize:16,color:"red",textAlign:"center",marginBottom:20},children:a})}):t?(0,K.jsx)(Sr.Provider,{value:{isDbReady:t},children:e}):(0,K.jsxs)(E.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[(0,K.jsx)(le.default,{size:"large",color:"#0000ff"}),(0,K.jsx)(ne.default,{style:{marginTop:20,fontSize:16},children:"Initializing database..."})]})},Ir=Object.assign({},d.DefaultTheme,{colors:Object.assign({},d.DefaultTheme.colors,{primary:G.primary,background:G.background,card:G.card,text:G.text,border:G.border,notification:G.notification})}),vr=Object.assign({},d.DarkTheme,{colors:Object.assign({},d.DarkTheme.colors,{primary:X.primary,background:X.background,card:X.card,text:X.text,border:X.border,notification:X.notification})});function Er(){const{isDark:e,theme:t}=Z(),{initialize:o}=he(),l=e?Object.assign({},a.MD3DarkTheme,{colors:Object.assign({},a.MD3DarkTheme.colors,t.colors)}):Object.assign({},s.MD3LightTheme,{colors:Object.assign({},s.MD3LightTheme.colors,t.colors)});return(0,r.useEffect)((()=>{o()}),[]),(0,K.jsx)(n.default,{theme:l,children:(0,K.jsxs)(d.NavigationContainer,{theme:e?vr:Ir,children:[(0,K.jsx)(i.StatusBar,{style:e?"light":"dark"}),(0,K.jsx)(Dr,{children:(0,K.jsx)(wr,{})})]})})}function Br(){return(0,K.jsx)(l.SafeAreaProvider,{children:(0,K.jsx)(re,{children:(0,K.jsx)(Er,{})})})}}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=e,(()=>{var e=[];o.O=(t,r,a,s)=>{if(!r){var n=1/0;for(c=0;c<e.length;c++){for(var[r,a,s]=e[c],i=!0,l=0;l<r.length;l++)(!1&s||n>=s)&&Object.keys(o.O).every((e=>o.O[e](r[l])))?r.splice(l--,1):(i=!1,s<n&&(n=s));if(i){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[r,a,s]}})(),o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.p="/",(()=>{var e={792:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var a,s,[n,i,l]=r,d=0;if(n.some((t=>0!==e[t]))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(l)var c=l(o)}for(t&&t(r);d<n.length;d++)s=n[d],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(c)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=o.O(void 0,[534],(()=>o(5700)));r=o.O(r)})();
//# sourceMappingURL=main.f33361c1.js.map